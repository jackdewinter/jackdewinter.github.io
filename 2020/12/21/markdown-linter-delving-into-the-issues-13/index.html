<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I worked diligently to resolve all the tests that I had marked as disabled in the previous week. After cleaning up those issues, I finished cleaning up the remaining List Block issues before getting back up to speed on Block Quote issues. Introduction¶ After a …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Delving Into the Issues - 13 "/>
<meta property="og:url" content="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" />
<meta property="og:description" content="Summary¶ In my last article, I worked diligently to resolve all the tests that I had marked as disabled in the previous week. After cleaning up those issues, I finished cleaning up the remaining List Block issues before getting back up to speed on Block Quote issues. Introduction¶ After a …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2020-12-21T00:00:00-08:00" />
<meta name="twitter:title" content="Markdown Linter - Delving Into the Issues - 13 ">
<meta name="twitter:description" content="Summary¶ In my last article, I worked diligently to resolve all the tests that I had marked as disabled in the previous week. After cleaning up those issues, I finished cleaning up the remaining List Block issues before getting back up to speed on Block Quote issues. Introduction¶ After a …">

        <title>Markdown Linter - Delving Into the Issues - 13  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/">
                Markdown Linter - Delving Into the Issues - 13
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#closing-out-list-blocks">Closing Out List Blocks</a><ul>
<li><a href="#adding-variations-of-existing-patterns">Adding Variations of Existing Patterns</a></li>
<li><a href="#lazy-continuations-and-nested-list-blocks">Lazy Continuations and Nested List Blocks</a></li>
<li><a href="#simple-cleanup">Simple Cleanup</a></li>
<li><a href="#getting-clarity">Getting Clarity</a><ul>
<li><a href="#doing-the-dirty-work">Doing the Dirty Work</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#starting-with-block-quotes">Starting with Block Quotes</a><ul>
<li><a href="#starting-out-easy">Starting Out Easy</a></li>
<li><a href="#three-quick-reviews">Three Quick Reviews</a></li>
<li><a href="#mixed-levels-of-block-quotes-and-serendipity">Mixed Levels of Block Quotes and Serendipity</a><ul>
<li><a href="#serendipity">Serendipity</a></li>
</ul>
</li>
<li><a href="#building-up-test-coverage">Building Up Test Coverage</a></li>
<li><a href="#sunday-morning-relaxing">Sunday Morning Relaxing</a></li>
</ul>
</li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/">last article</a>,
I worked diligently to resolve all the tests that I had marked as disabled in the
previous week.  After cleaning up those issues, I finished cleaning up the remaining
List Block issues before getting back up to speed on Block Quote issues.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>After a week of digging deep to resolve the disabled tests, I checked the issues
list.  With only a handful of items left in the List Blocks section, I figured it was a
good time to make a push to finish with the List Blocks and start with the Block Quotes.</p>
<p>Knowing that I was about to do that transition made me happy and filled me with dread
at the same
time.  It made me happy as I was more aware of how close I was getting to the end of the
first phase of the project.  It also filled me with a sense of dread because I had not
done any serious work with Block Quotes in a while.  As such, I am not sure if the
effort to get the Block Quotes to the same level as List Blocks will be the same.  I
hope it is significantly less, but we will see.</p>
<p>If I think about it, I believe that
sense of dread is from not knowing how long it will take to address any issues that
arise.
I do know, that unless I finish up the List Blocks and start the Block Quotes, that
feeling will be stuck at dread.  So, time to buckle down and get stuff done!</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/09682fe55c9e7962f18341be3212d3712b6888e8">10 Dec 2020</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/6db64e26af671e757156652ddcc457595542bc84">13 Dec 2020</a>.</p>
<h2 id="closing-out-list-blocks">Closing Out List Blocks<a class="headerlink" href="#closing-out-list-blocks" title="Permanent link">¶</a></h2>
<p>Having finished cleaning up the disabled scenario tests, there were a few items on the
issues list that I needed to get out of the way.  While not high-profile items,
those items were standing between myself and a list with no list block related items
on it.  That was motivation enough to put these items at the top of my list.</p>
<h3 id="adding-variations-of-existing-patterns">Adding Variations of Existing Patterns<a class="headerlink" href="#adding-variations-of-existing-patterns" title="Permanent link">¶</a></h3>
<p>During the previous three weeks, I had taken the Series M scenario tests and
filled them out a lot.  As I filled them out, I did find parsing and transformation
issues, all which got fixed.  But in creating that series, I needed to take some
alternate path to properly exercise the specific patterns that I was trying to make sure
were covered by the tests.  In doing so, I often veered away from the correct variation
to faithfully create the right pattern in the group of scenario tests that I was
working on.</p>
<p>Confused?  Hopefully, a concrete example will explain.  I started going through the
tests in each group, starting with Fenced Code Blocks and the scenario test function
<code>test_paragraph_series_m_ol_nl_fb</code>:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span>
<span class="o">```</span>
<span class="n">foo</span>
<span class="o">```</span>
</pre></div>
<p>The purpose of that specific test was to make sure that a Fenced Code Block following an
empty Order List start element was parsed properly.  However, from my point of view,
there was another variation of that test that was possible.  Creating the new scenario
test function <code>test_paragraph_series_m_ol_nl_all_i3_fb</code>, I altered the Markdown
slightly:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span>
   <span class="o">```</span>
   <span class="n">foo</span>
   <span class="o">```</span>
</pre></div>
<p>Technically that was not a big change, but it was a significant one to me.  Instead of
testing
a variation where the Fenced Code Block terminates the List Block, it instead tests
the inclusion of that Fenced Code Block into the List Block. I consider that
the most correct form of that test.  At its base, that reason
for that classification is that if I said I wanted “an empty list with a fenced code
block”, that is what I would expect.  Nothing more, nothing less, just a simple example
that had that Markdown in its simplest form.</p>
<p>I could have repeated that exercise with a lot of the scenario tests, but I
stayed with four tests from each group: two tests with a single list and two tests with
a sublist.  Starting with Fenced Control Blocks, I then proceded to HTML Blocks,
Indented Code Blocks, and SetExt Headings.  I hoped that the new scenario tests were
covering old scenarios, but I was not 100% confident that they were.  But as I executed
those tests, one by one I was convinced they were old scenarios, just being covered by
the Series M tests as a group.  Not one of the scenario tests failed!  After my
usual process of adopting the scenario tests, each test passed on its first try,
requiring no changes to the parser, the transformers, or the consistency checks.</p>
<p>In the end, I was able to mark all these items from the issues list as resolved:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="nv">variations</span> <span class="nv">of</span> <span class="nv">list</span><span class="o">+</span><span class="nv">fenced</span> <span class="nv">block</span> <span class="nv">with</span> <span class="nv">proper</span> <span class="nv">indent</span> <span class="k">for</span> <span class="nv">actual</span> <span class="nv">block</span>
<span class="o">-</span> <span class="nv">variations</span> <span class="nv">of</span> <span class="nv">list</span><span class="o">+</span><span class="nv">html</span> <span class="nv">block</span> <span class="nv">with</span> <span class="nv">proper</span> <span class="nv">indent</span> <span class="k">for</span> <span class="nv">actual</span> <span class="nv">block</span>
<span class="o">-</span> <span class="nv">variations</span> <span class="nv">of</span> <span class="nv">list</span><span class="o">+</span><span class="nv">indent</span> <span class="nv">block</span> <span class="nv">with</span> <span class="nv">proper</span> <span class="nv">indent</span> <span class="k">for</span> <span class="nv">actual</span> <span class="nv">block</span>
<span class="o">-</span> <span class="nv">variations</span> <span class="nv">of</span> <span class="nv">list</span><span class="o">+</span><span class="nv">set</span> <span class="nv">ext</span> <span class="nv">with</span> <span class="nv">proper</span> <span class="nv">indent</span> <span class="k">for</span> <span class="nv">actual</span> <span class="nv">block</span>
</pre></div>
<h3 id="lazy-continuations-and-nested-list-blocks">Lazy Continuations and Nested List Blocks<a class="headerlink" href="#lazy-continuations-and-nested-list-blocks" title="Permanent link">¶</a></h3>
<p>Another easy issue to get off the list was this one:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">2</span><span class="o">-</span><span class="mi">3</span> <span class="n">levels</span> <span class="k">of</span> <span class="n">lists</span> <span class="k">with</span> <span class="n">lazy</span> <span class="n">continuation</span> <span class="n">lines</span>
</pre></div>
<p>Based on the work I had just completed to round out the Series M tests, I had confidence
that these would also not require any changes.  It was a bit of an educated guess, but
I believe that
all I wanted to do here is to provide different levels of List Blocks, ensuring that
the principle of
<a href="https://github.github.com/gfm/#lazy-continuation-line">lazy continuation lines in lists</a>
was being adhered to.</p>
<p>Starting with test function <code>test_list_blocks_extra_5a</code>, I added the following Markdown:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
<span class="n">def</span>
</pre></div>
<p>ensuring that text <code>def</code> continued the paragraph started in the level 1 List Block.
Three tests later, the test function <code>test_list_blocks_extra_5d</code> was testing the level 4
List Block with the Markdown:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
   <span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
      <span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
         <span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
<span class="n">def</span>
</pre></div>
<p>This was a simple set of scenarioes that passed right away, but I had expected them to.
However, with some of the issues that I have had with List Blocks and lazy continuation
lines, it was good to have some tests explicitly covering these cases.</p>
<h3 id="simple-cleanup">Simple Cleanup<a class="headerlink" href="#simple-cleanup" title="Permanent link">¶</a></h3>
<p>Having done some rewriting of code lately, I was debugging and found a couple of lines
in the <code>__handle_blank_line</code> function that were not being used anymore.  With the
breadth of scenario tests and summaries of the code coverage of those tests also in
place, it was easy to determine and test to make sure this code was no longer being
used.  With that observation verified, that code was removed.</p>
<h3 id="getting-clarity">Getting Clarity<a class="headerlink" href="#getting-clarity" title="Permanent link">¶</a></h3>
<p>For a while, I have been convinced that I coded something wrong, but have not been able
to prove whether it was correct or not correct.  The only thing that I was convinced
of was that I needed to deal with this at some point.  With this being the last
issue in the List Block section, it was time to deal with it.</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="nv">blank</span> <span class="nv">line</span> <span class="nv">ending</span> <span class="nv">a</span> <span class="nv">list</span> <span class="nv">is</span> <span class="nv">parsed</span> <span class="nv">wrong</span> <span class="nv">into</span> <span class="nv">tokens</span>
  <span class="o">-</span> <span class="o">&gt;&gt;</span><span class="nv">stack_count</span><span class="o">&gt;&gt;</span><span class="mi">0</span><span class="o">&gt;&gt;</span><span class="sc">#9</span>:[<span class="k">end</span><span class="o">-</span><span class="nv">ulist</span>]
  <span class="o">-</span> <span class="nv">should</span> <span class="nv">be</span> <span class="k">end</span> <span class="nv">and</span> <span class="k">then</span> <span class="nv">blank</span>, <span class="nv">as</span> <span class="nv">the</span> <span class="nv">blank</span> <span class="nv">is</span> <span class="nv">outside</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">list</span>
  <span class="o">-</span> <span class="mi">233</span> <span class="nv">and</span> <span class="mi">235</span>, <span class="nv">should</span> <span class="nv">blank</span> <span class="nv">and</span> <span class="k">end</span><span class="o">-</span><span class="nv">list</span> <span class="nv">tokens</span> <span class="nv">be</span> <span class="nv">reversed</span>?
</pre></div>
<p>The prototypical example of this was test function <code>test_list_blocks_233</code>:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">one</span>

 <span class="n">two</span>
</pre></div>
<p>While the HTML output for that Markdown was correct, I had questions about whether I
was emitting the following tokens in the correct order:</p>
<div class="highlight"><pre><span></span>    <span class="n">expected_tokens</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"[ulist(1,1):-::2:]"</span><span class="p">,</span>
        <span class="s2">"[para(1,3):]"</span><span class="p">,</span>
        <span class="s2">"[text(1,3):one:]"</span><span class="p">,</span>
        <span class="s2">"[end-para:::True]"</span><span class="p">,</span>
        <span class="s2">"[BLANK(2,1):]"</span><span class="p">,</span>
        <span class="s2">"[end-ulist:::True]"</span><span class="p">,</span>
        <span class="s2">"[para(3,2): ]"</span><span class="p">,</span>
        <span class="s2">"[text(3,2):two:]"</span><span class="p">,</span>
        <span class="s2">"[end-para:::True]"</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
<p>Specifically, my question was around the Blank token and the end Unordered List token.
Should the tokens be in Blank/Unordered order, or Unordered/Blank order?  Over the weeks
that I have looked at this case, I had never taken the time to sit down and work through
it.  As it was the last item for List Blocks in the Issue List, it was time.</p>
<h4 id="doing-the-dirty-work">Doing the Dirty Work<a class="headerlink" href="#doing-the-dirty-work" title="Permanent link">¶</a></h4>
<p>This may appear to be an easy case to some people, but I had issues with it.  Thinking
about it at length, it felt that my understanding of this problem was influenced by
which part of the GFM
Specification I had last dealt with.  So, to deal with that influence head-on, I re-read
the parts of the specification dealing with List Blocks, Paragraph Blocks, Blank
Lines, and lazy continuation lines.  With that information in my head, I started to work
through the problem logically.</p>
<p>Starting at the beginning, line 1 starts the tokens off with the first three tokens of
the document, leaving an
Unordered List item active and a Paragraph element open.  When the Blank Line element
in line 2 is encountered, it closes the Paragraph element but leaves the Unordered List
and Unordered List item open.  Therefore, the fourth and fifth tokens are generated and
added to the document.</p>
<p>It was at this point in working the problem that the clarity surrounded this problem
crystalized and became clear in my mind.  I am not sure why, but I had wrongly believed
that the Blank Line
element on line 2 not only closed the Paragraph Block but closed the List Block and
List Block item as well.  The Markdown for
<a href="https://github.github.com/gfm/#example-240">example 240</a>
clearly shows this:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">foo</span>


  <span class="n">bar</span>
</pre></div>
<p>as the Markdown is trnslated into a single Unordered List Block with a single item
that contains two paragraphs:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>foo<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>bar<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre></div>
<p>This meant that when line 3 is interpreted, the List Block and List Block item are
still open, but the previous Paragraph element was closed by the Blank Line.  As
such, line 3 is not eligible for consideration as a lazy continuation line.  With
that option removed, the single leading space character is not enough leading space
to keep line 3 in the List Block, so that block is closed, and a new Paragraph element
is opened with the contents of line 3.</p>
<p>It took a bit of work and a straight head to work through, but I had my answer!  To
make sure I did not forget about it, I added a comment to function
<code>test_list_blocks_232</code>
to make sure I can look back at it when I need to.  While this was not something that
required a code solution, knowing that this issue was finally (and definitively)
resolved brought a smile to my face!</p>
<h2 id="starting-with-block-quotes">Starting with Block Quotes<a class="headerlink" href="#starting-with-block-quotes" title="Permanent link">¶</a></h2>
<p>With that last issue, all the specifically List Block related items were crossed off
the issues list.  It was now time to ease myself into work on Block Quotes and getting
them up to a comparable level as I had reached with List Blocks.</p>
<h3 id="starting-out-easy">Starting Out Easy<a class="headerlink" href="#starting-out-easy" title="Permanent link">¶</a></h3>
<p>I decided to start with an easy item:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="s2">"</span><span class="s"># TODO add case with &gt;</span><span class="s2">"</span> <span class="k">for</span> <span class="nv">tests</span>
</pre></div>
<p>In the beginning, each of the scenario functions in the range <code>test_block_quotes_212</code>
to <code>test_block_quotes_216</code> were simple tests that showed how lazy continuation lines
work with Block Quote elements.  One of the observations that I made when adding those
tests was that, to properly test lazy continuation lines, the removed <code>&gt;</code>
character that makes the line “lazy” should be able to be inserted without changing
the HTML output.  Basically, according to the GFM Specification:</p>
<blockquote>
<p>If a string of lines Ls constitute a block quote with contents Bs, then the result of deleting the initial block quote marker from one or more lines in which the next non-whitespace character after the block quote marker is paragraph continuation text is a block quote with Bs as its content.</p>
</blockquote>
<p>To properly test this, I created <code>a</code> variant functions of each of those five scenario
tests, and in
each case I added a variation with the <code>&gt;</code> character at the start of the line.  As
I worked through the scenarios, all the variant tests were working fine except for
function <code>test_block_quotes_213a</code>.  Looking at what made that test different, the
answer was obvious: it involved List Blocks.  Even after adding other variants of this
test, I was unable to get any of them working.</p>
<p>I was not 100% sure it was the right thing to do, but in the name of progress, I
marked the test functions <code>test_block_quotes_213a</code> to <code>test_block_quotes_213d</code> as
disabled, knowing I would get back to them when testing Block Quotes and List Blocks
and how they interacted.</p>
<h3 id="three-quick-reviews">Three Quick Reviews<a class="headerlink" href="#three-quick-reviews" title="Permanent link">¶</a></h3>
<p>The next three items that I resolved were all easy issues to resolve.</p>
<p>The first item was the removal of a piece of code that was no longer being used:</p>
<div class="highlight"><pre><span></span>            <span class="k">if</span> <span class="n">is_in_paragraph</span> <span class="ow">and</span> <span class="n">at_end_of_line</span> <span class="ow">and</span> <span class="n">is_first_item_in_list</span><span class="p">:</span>
                <span class="n">is_start</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
<p>The next item was to remove the poorly worded item from the list and replace it with
one that specified the problem more clearly:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">unify</span> <span class="mi">2</span> <span class="n">separate</span> <span class="n">calculations</span> <span class="k">in</span> <span class="ss">`__pre_list`</span> <span class="n">function</span>
</pre></div>
<p>And finally, the last item was just to review the existing tests and make sure that
agreed with their current state:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">228</span> <span class="nv">and</span> <span class="mi">229</span> <span class="o">-</span> <span class="nv">what</span> <span class="nv">is</span> <span class="nv">the</span> <span class="nv">proper</span> <span class="nv">line</span><span class="o">/</span><span class="nv">col</span> <span class="k">for</span> <span class="s2">"</span><span class="s">&gt;&gt;&gt;</span><span class="s2">"</span>?
</pre></div>
<p>None of these were tough tasks to undertake, but they were all helping me to get back
up to speed on parsing Block Quotes.</p>
<h3 id="mixed-levels-of-block-quotes-and-serendipity">Mixed Levels of Block Quotes and Serendipity<a class="headerlink" href="#mixed-levels-of-block-quotes-and-serendipity" title="Permanent link">¶</a></h3>
<p>Going through the list looking for other easy items to resolve, this one caught my
attention:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="nv">block</span> <span class="nv">quotes</span> <span class="nv">that</span> <span class="nv">start</span> <span class="nv">and</span> <span class="nv">stop</span> <span class="nv">i</span>.<span class="nv">e</span>. <span class="o">&gt;</span> <span class="k">then</span> <span class="o">&gt;&gt;</span> <span class="k">then</span> <span class="o">&gt;</span> <span class="k">then</span> <span class="o">&gt;&gt;&gt;</span>, <span class="nv">etc</span>.
</pre></div>
<p>To me, this looked like an easy issue to tackle.  The test function
<code>test_block_quotes_229</code> was a good base to start with.  However, I felt there needed
to be a bit more data, so instead of three lines with varying numbers of Block Quote
start characters, I created test function <code>test_block_quotes_229a</code> as follows:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="mi">1</span>
<span class="o">&gt;&gt;</span> <span class="mi">2</span>
<span class="o">&gt;</span> <span class="mi">1</span>
<span class="o">&gt;&gt;</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="o">&gt;</span> <span class="o">&gt;</span> <span class="mi">2</span>
</pre></div>
<p>and test function <code>test_block_quotes_229b</code> with the same content, just blank lines
between each of the original lines.  Basically, the first test would verify how the
different lines worked together, and the blank lines in the second test would verify
how each line worked isolated from any other lines.</p>
<h4 id="serendipity">Serendipity<a class="headerlink" href="#serendipity" title="Permanent link">¶</a></h4>
<p>Except for some moving code around to make sure it looked correct, only one real change
needed to be done to get the tests working.  It was an interesting thing to run into,
but it was also a lucky break for me.  If I had selected any other text for each line,
things would have worked fine, and I would be none the wiser.  However, with the given
content for each line, the parser thought that the number for each line was a possible
start for an Ordered List Block.  As such, it consumed the digit and then looked for
the <code>.</code> or <code>)</code> character to follow it.  When the end of the line was encountered instead
of one of those characters, an <code>IndexError: string index out of range</code> error was thrown.
While this was quickly fixed by only setting that variable if the start of the List
Block had been confirmed, it was a good issue to find!</p>
<h3 id="building-up-test-coverage">Building Up Test Coverage<a class="headerlink" href="#building-up-test-coverage" title="Permanent link">¶</a></h3>
<p>These issues were ones that I used to start the process of building up to the same
level of coverage for various Block Quote scenario groups as I had done with List
Blocks.  This effort was in response to the following issue list items:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="nv">tests</span> <span class="nv">like</span> <span class="nv">cov2</span> <span class="nv">with</span> <span class="nv">blank</span> <span class="nv">before</span>, <span class="nv">after</span>, <span class="nv">and</span> <span class="nv">both</span> <span class="k">for</span> <span class="nv">html</span> <span class="nv">blocks</span> <span class="nv">and</span> <span class="nv">other</span> <span class="nv">blocks</span>
<span class="o">-</span> <span class="nv">tests</span> <span class="nv">like</span> <span class="nv">cov2</span> <span class="nv">with</span> <span class="nv">multiple</span> <span class="nv">lines</span> <span class="k">for</span> <span class="nv">block</span> <span class="nv">items</span>, <span class="nv">like</span> <span class="nv">html</span>
<span class="o">-</span> <span class="nv">all</span> <span class="nv">leaf</span> <span class="nv">in</span> <span class="nv">all</span> <span class="nv">container</span>
</pre></div>
<p>To accomplish this, variations of Paragraph Blocks were added to function
<code>test_block_quotes_211</code>, Thematic Breaks to function <code>test_block_quotes_212</code>,
Indented Code Blocks to function <code>test_block_quotes_214</code>, and Fenced Code Blocks to
function <code>test_block_quotes_215</code>.  After adding 10 new scenario tests to address
these issues, I felt that this was a good start to addressing the issue of coverage
for Block Quotes.</p>
<p>With all those changes completed, I followed my usual process of verifying each
scenario test.  Except for one issue with the Markdown transformer, the tests all
passed without incident.  That one issue was that the Markdown rehydration for
test function <code>test_block_quotes_214d</code> included an extra <code>\x03</code> character in the
output.  As I have mentioned in
<a href="https://jackdewinter.github.io/2020/08/10/markdown-linter-adding-links-to-the-markdown-transformer/#moving-special-character-support">previous articles</a>,
that character is a NOOP character, and is used to essentially place a “Blank” in
the tokens that can be removed if not needed.  In this case, that NOOP character was
added to the content of the Text token to indicate that a Blank Line was part of that
content.</p>
<p>As that information was not needed for the translation back to Markdown, I eventually
added a call to the function <code>ParserHelper.resolve_noops_from_text</code> at the end of the
<code>__perform_container_post_processing_lists</code> function to remove that extra character.
While I knew that I needed to add a call to that function at some point in the
processing chain, it took an hour or so of experimentation to find the right place
to insert that call at.  Until I found and tested that location, I found lots of
locations where test function <code>test_block_quotes_214d</code> was passing, but other test
functions started failing.  It was frustrating, but I was able to work through all
that noise and find the right place, which was satisfying!</p>
<h3 id="sunday-morning-relaxing">Sunday Morning Relaxing<a class="headerlink" href="#sunday-morning-relaxing" title="Permanent link">¶</a></h3>
<p>With a solid amount of work completed during the week, I found myself sitting in
front of my computer on another Sunday morning, wanting to get another issue resolved.
I do not want anyone thinking that I am workaholic, as I am not.  Sunday mornings in
our household are mostly for whatever personal projects we are working on.  As such,
I choose to get up early on Sundays and try and get a couple more issues resolved from
one of the projects that I am working on, before the family projects start taking
control of my day.</p>
<p>Knowing that it was going to take a couple of hours, and having a couple of hours of
peace and quiet available, I started looking at the following item:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">blank</span> <span class="n">lines</span> <span class="k">as</span> <span class="n">part</span> <span class="k">of</span> <span class="n">bquote</span>
  <span class="o">-</span> <span class="n">compare</span> <span class="n">test_block_quotes_218</span> <span class="n">vs</span> <span class="n">test_blank_lines_197a</span>
  <span class="o">-</span> <span class="n">already</span> <span class="n">fixed</span> <span class="n">test_list_blocks_260</span><span class="p">,</span> <span class="mi">257</span>
</pre></div>
<p>While it may not seem like much, the positioning and whitespace of those blank lines
are just slightly off.  Looking at this back at the end of June 2020, I noticed that
within containers, the column number for blank lines was off.  Specifically, given this
Markdown:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">foo</span>
<span class="o">-</span><span class="err">\</span><span class="n">a</span><span class="err">\</span><span class="n">a</span><span class="err">\</span><span class="n">a</span>
<span class="o">-</span> <span class="n">bar</span>
</pre></div>
<p>(where the <code>\a</code> character is a visual indicator for a space character), the token for
the blank line was being calculated as <code>[BLANK(2,5):]</code>.  While that is one possible
answer to Blank Line token for that line, it has issues.  Specifically, because it is
within a List Block, the consistency checking had issues with that line because it
did not appear to have the correct indentation.</p>
<p>After thinking about it, I eventually settled on the correct form of that token being
<code>[BLANK(2,2):   ]</code>.  As the spaces were all that was on the line, I figured that it was
more correct to say that the column number was 2 followed by three space characters
than a column number of 3 followed by two space characters.  Influenced by
<a href="https://github.github.com/gfm/#example-257">example 257</a>,
I have confidence that I made the correct choice, backed up by the commit I made
on
<a href="https://github.com/jackdewinter/pymarkdown/commit/4b681751cae38ce2007f3b0ada6158ed9a15f353">28 Jun 2020</a>
with that choice and the fallout from that choice.</p>
<p>At that time, I was focusing on List Blocks, and I added the item into the issues
list to fix this for Block Quotes, and it was now time to fix that.  Unlike the
fixes required to resolve this for List Blocks, the fixes required to resolve this
for Block Quotes were relatively small.  The first part of that change was to
set the column number to the length of the text removed by the owning container
blocks.  This firmly set that column number to the first character after the
container processing, removing the determination of the column number from the
leaf block processing.  To balance that out, the calculation for
initial whitespace to allow for a Blank Line token within a Block Quote was set
to the amount of whitespace that was extracted.  Other than that, no other
changes were made.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>As I mentioned earlier, it was a relief to wrap up the verification of the List Blocks
and moving on to Block Quotes.  But with that transition, there was also a sense of
dread that I felt as I started on Block Quotes.  Would getting a solid amount of
coverage for Block Quotes take a couple of months as it had for List Blocks?  Would
it be more? Would it be less?  I just did not know.  I was hoping it would be less,
but that not knowing was just driving me nuts.</p>
<p>But I also realized that the sense of dread would not disappear until I started doing
something about it.  Even by working on easy Block Quote items, I was getting a
clearer picture of the effort it will take to cover Block Quotes properly.  Instead of
a sense of dread, I believe I am at a place where I am confident that it will be less
than four months, and probably more than two weeks.  Not sure where in that range it
will land, but pretty confident it will be in there.</p>
<p>And that is okay for now.  The important thing is that I did not let that dread knock
me down.  I took it, channeled it, and got some more information that helped me deal
with it.  Cool!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>Still feeling a small amount of
dread, but mostly I am feeling optimism about the progress I am making!
As such, I expect to be working with Block Quotes for a while, possibly dipping into
dealing with Block Quotes and List Blocks every so often.  </p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%2013&url=https%3A//jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%2013&amp;body=https%3A//jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-delving-into-the-issues-13"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2020/12/20/autism-and-how-it-affects-my-view-of-christmas/" title="Previous: Autism And How It Affects My View of Christmas">Autism And How It Affects My View of Christmas</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2020/12/28/markdown-linter-delving-into-the-issues-14/" title="Next: Markdown Linter - Delving Into the Issues - 14">Markdown Linter - Delving Into the Issues - 14</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~15 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2020-12-21T00:00:00-08:00">Dec 21, 2020</time>
        <h4>Markdown Linter Issues</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2020/09/28/markdown-linter-delving-into-the-issues-1/" title="Markdown Linter - Delving Into the Issues - 1">Part 1: Markdown Linter - Delving Into the Issues - 1</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/05/markdown-linter-delving-into-the-issues-2/" title="Markdown Linter - Delving Into the Issues - 2">Part 2: Markdown Linter - Delving Into the Issues - 2</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/" title="Markdown Linter - Delving Into the Issues - 3">Part 3: Markdown Linter - Delving Into the Issues - 3</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" title="Markdown Linter - Delving Into the Issues - 4">Part 4: Markdown Linter - Delving Into the Issues - 4</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/26/markdown-linter-delving-into-the-issues-5/" title="Markdown Linter - Delving Into the Issues - 5">Part 5: Markdown Linter - Delving Into the Issues - 5</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/" title="Markdown Linter - Delving Into the Issues - 6">Part 6: Markdown Linter - Delving Into the Issues - 6</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" title="Markdown Linter - Delving Into the Issues - 7">Part 7: Markdown Linter - Delving Into the Issues - 7</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/" title="Markdown Linter - Delving Into the Issues - 8">Part 8: Markdown Linter - Delving Into the Issues - 8</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" title="Markdown Linter - Delving Into the Issues - 9">Part 9: Markdown Linter - Delving Into the Issues - 9</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/30/markdown-linter-delving-into-the-issues-10/" title="Markdown Linter - Delving Into the Issues - 10">Part 10: Markdown Linter - Delving Into the Issues - 10</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/" title="Markdown Linter - Delving Into the Issues - 11">Part 11: Markdown Linter - Delving Into the Issues - 11</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" title="Markdown Linter - Delving Into the Issues - 12">Part 12: Markdown Linter - Delving Into the Issues - 12</a>
            </li>
            <li  class="active-part">
            Part 13: Markdown Linter - Delving Into the Issues - 13
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/28/markdown-linter-delving-into-the-issues-14/" title="Markdown Linter - Delving Into the Issues - 14">Part 14: Markdown Linter - Delving Into the Issues - 14</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/04/markdown-linter-delving-into-the-issues-15/" title="Markdown Linter - Delving Into the Issues - 15">Part 15: Markdown Linter - Delving Into the Issues - 15</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/11/markdown-linter-delving-into-the-issues-16/" title="Markdown Linter - Delving Into the Issues - 16">Part 16: Markdown Linter - Delving Into the Issues - 16</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/" title="Markdown Linter - Delving Into the Issues - 17">Part 17: Markdown Linter - Delving Into the Issues - 17</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" title="Markdown Linter - Delving Into the Issues - 18">Part 18: Markdown Linter - Delving Into the Issues - 18</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/01/markdown-linter-delving-into-the-issues-19/" title="Markdown Linter - Delving Into the Issues - 19">Part 19: Markdown Linter - Delving Into the Issues - 19</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>65</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>83</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>