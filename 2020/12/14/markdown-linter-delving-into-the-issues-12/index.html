<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I worked hard to deal with the 33 scenario tests that I skipped in the last set of commits due to time constraints. Introduction¶ Pure and simple, this week …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Delving Into the Issues - 12 "/>
<meta property="og:url" content="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" />
<meta property="og:description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I worked hard to deal with the 33 scenario tests that I skipped in the last set of commits due to time constraints. Introduction¶ Pure and simple, this week …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2020-12-14T00:00:00-08:00" />
<meta name="twitter:title" content="Markdown Linter - Delving Into the Issues - 12 ">
<meta name="twitter:description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I worked hard to deal with the 33 scenario tests that I skipped in the last set of commits due to time constraints. Introduction¶ Pure and simple, this week …">

        <title>Markdown Linter - Delving Into the Issues - 12  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/">
                Markdown Linter - Delving Into the Issues - 12
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#cleaning-up-from-last-week">Cleaning Up from Last Week</a><ul>
<li><a href="#starting-with-html-blocks">Starting with Html Blocks</a></li>
<li><a href="#maintaining-the-momentum-with-fenced-code-blocks">Maintaining the Momentum with Fenced Code Blocks</a></li>
<li><a href="#atx-headings-for-the-three-peat">Atx Headings for The Three-peat?</a></li>
<li><a href="#cleaning-up-the-html-indented-code-blocks">Cleaning Up The HTML: Indented Code Blocks</a></li>
<li><a href="#the-long-slog-setext-headings">The Long Slog: SetExt Headings</a></li>
</ul>
</li>
<li><a href="#the-last-18">The Last 18</a><ul>
<li><a href="#understanding-the-scope-of-the-problem">Understanding the Scope Of The Problem</a></li>
<li><a href="#everything-is-not-perfect">Everything Is Not Perfect</a></li>
<li><a href="#attacking-the-problem">Attacking the Problem</a></li>
<li><a href="#how-well-did-this-work">How Well Did This Work?</a></li>
</ul>
</li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/">last article</a>,
I continued in my quest to reduce the size of the issues list.  In this article, I
worked hard to deal with the 33 scenario tests that I skipped in the last set of commits
due to time constraints.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Pure and simple, this week was all about resolving the 33 scenario tests that I marked
as disabled from last week.  I was mostly confident at the time that the right decision
was to mark these tests as disabled and commit the changes I had already made.  The
question was whether I could fix this issues in five minutes, five hours, or five days.
If the answer was anything except five minutes, then disabling the tests was the right
thing to do.  Otherwise, it would not be the wrong thing to do, I would just feel
foolish that it could have been dealt with quickly instead of disabling the tests.</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/b9b0e9707355c5e174e89588b4085eac912ada5f">03 Dec 2020</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/7137522b730ee7875020e495a39b45f9de2b2866">06 Dec 2020</a>.</p>
<h2 id="cleaning-up-from-last-week">Cleaning Up from Last Week<a class="headerlink" href="#cleaning-up-from-last-week" title="Permanent link">¶</a></h2>
<p>At the end of the work that I covered in the last article, I marked 33 scenario test
functions as disabled.  While I felt comfortable in disabling them for a bit, I did
not feel comfortable leaving them disabled for too long.  It was time to tackle them and
get them resolved!</p>
<h3 id="starting-with-html-blocks">Starting with Html Blocks<a class="headerlink" href="#starting-with-html-blocks" title="Permanent link">¶</a></h3>
<p>I needed to start somewhere, and HTML Block elements just seemed like the best place
to start.  There was no real good reason to choose them other than, in my mind, they
were a simple block type.  The text in HTML Block is translated
to HTML with no changes or interpretation, and the start and the stop sequences for
HTML Block are very constrained, but also very simple.  It just seemed like the
simplest place to start for something that I was concerned about.  My concerns?
That solving the problems with all 33 failures were going to be a very difficult task
to accomplish.</p>
<p>It was during my usual task of research though debugging that I was able to make a
quick breakthrough in diagnosing the problem.  As a lucky observation, I noticed that
when one of the Series M test functions was executed, the test’s Markdown:</p>
<div class="highlight"><pre><span></span>1. 1.
<span class="nt">&lt;script&gt;</span>
foo
<span class="nt">&lt;/script&gt;</span>
</pre></div>
<p>resulted in an HTML Block element that started between the end of the sublist and
the end of the list.  When the end of that list occurred, it caused the HTML Block
element to be closed, leaving the last two lines to be interpreted as a Paragraph
containing the text <code>foo</code> and a Raw HTML element of <code>&lt;/script&gt;</code>.  By looking at the
Markdown text above, I believed that both lists should have been closed.  The
HTML Block start element should have closed both Ordered List blocks as the HTML
Block was not indented enough to keep either List block open.  But how was the code
interpreting that Markdown, that was the real question.</p>
<p>Digging into the code a bit, adding extra debug as I went, I was able to soon figure
out that the parser was trying to close the list, but the right type of close was not
occurring.
As I dug into that code, I noticed that I had found a similar problem with the
Thematic Break element and list closures at some point in the past.  To solve the
problem with Thematic Breaks, I added Thematic Break specific code in the
<code>__check_for_list_closures</code> function that properly closes the right amount of List
elements if a Thematic Break element occurred within a List element.  After going
through this code and the data from the scenario test’s log, I had a theory that
I had another instance where I needed to follow this pattern.</p>
<p>To test that theory, I quickly changed the code in the <code>HtmlHelper</code> class that
checks for the type of HTML block to break out the “is it a HTML start” code from the
“what kind of HTML start is it”.  By creating this new <code>is_html_block</code> function,
it allowed me to change the <code>__check_for_list_closures</code> function in the
<code>ListBlockProcessor</code> class to calculate whether the current line was indeed the
start of a HTML Block, storing that value in the <code>is_html_block</code> variable.
With that completed, I changed code that specified <code>is_theme_break</code> as part
of two <code>if</code> conditions to <code>is_theme_break or is_html_block</code> and I was ready to go.</p>
<p>Following my usual pattern of validation scenario tests, I was able to get the
new and changed tokens validated quickly, producing the HTML output that I
expected.  With no other changes, I was able to get all four disabled scenario
tests that dealt with HTML Blocks working again.</p>
<p>With those four tests no longer being disabled, the total count of scenario tests
to fix was down 4 scenario tests from 33 to 29.  It was a good start, but I still
had a long way to go.  But with momentum on my side, I carried on!</p>
<h3 id="maintaining-the-momentum-with-fenced-code-blocks">Maintaining the Momentum with Fenced Code Blocks<a class="headerlink" href="#maintaining-the-momentum-with-fenced-code-blocks" title="Permanent link">¶</a></h3>
<p>As I had a pattern that worked for one type of block, I decided to try that same pattern
out on the next type of blocks: Fenced Code Blocks. When I did that, I was
pleasantly surprised that following the same pattern led to the same results, with
one exception.  In this case, the “is this a Fenced Code Block start” function
already existed as <code>LeafBlockProcessor.is_fenced_code_block</code>, so it was easy to
wire it into the <code>__check_for_list_closures</code> function after assigning it to the
<code>is_fenced_block</code> variable.</p>
<p>The one exception was that there was a small failure in the rendering of the Fenced
Code Block tokens to HTML.
In cases where an empty Fenced Code Block element was present, any extra whitespace
in the Blank Line was being added to the HTML output after the newline character,
instead of just adding the newline character.  As this was the only failure, and
(at least to me) it was obvious that this was the issue, I was able to fix it
by adding the <code>exclusion_condition</code> variable and keying off of that variable.  The
testing for that change happened almost as quickly as the coding did, and I was
able to resolve that group of four failing scenario tests.</p>
<p>With another 4 tests that were no longer disabled, the disabled test count was now
down to 25.</p>
<h3 id="atx-headings-for-the-three-peat">Atx Headings for The Three-peat?<a class="headerlink" href="#atx-headings-for-the-three-peat" title="Permanent link">¶</a></h3>
<p>Deciding to work on Atx Headings next, I applied the same pattern and got a very good
result.  Other than that changes required to isolate the “is this an Atx Heading start”
code into its own function (and its inclusion into the <code>__check_for_list_closures</code>
function), no other Atx Heading code required changes.  After validating and modifying
the tokens for the scenarios, all the tests just passed.  It was so weird to have
that happen, that I ran the scenario tests again just to be sure, and they were
indeed passing.</p>
<p>To be clear, it was not that I was doubting myself, I just expected a lot more
difficulty in resolving these issues.  But, with a little bit of work, another 3 tests
were removed from the disabled list, bringing the disabled test count down to 22 tests.</p>
<h3 id="cleaning-up-the-html-indented-code-blocks">Cleaning Up The HTML: Indented Code Blocks<a class="headerlink" href="#cleaning-up-the-html-indented-code-blocks" title="Permanent link">¶</a></h3>
<p>After looking at the disabled tests dealing with Indented Code Block elements,
it was almost immediately obvious the same pattern would not work with these tests.
As far as I
could tell from my initial look, the problem was not with the tokens, but in
the determination of the looseness of the Lists.  In each of the failures, the
only difference was whether the items in the List blocks were surrounded
by HTML’s Paragraph tags or not.  The problem definitely had something to do with
looseness.</p>
<p>The GFM Specification’s
<a href="https://github.github.com/gfm/#loose">definition of looseness</a> states:</p>
<blockquote>
<p>A list is loose if any of its constituent list items are separated by blank lines, or if any of its constituent list items directly contain two block-level elements with a blank line between them. Otherwise a list is tight. (The difference in HTML output is that paragraphs in a loose list are wrapped in <code>&lt;p&gt;</code> tags, while paragraphs in a tight list are not.)</p>
</blockquote>
<p>And whether I liked it or not, the HTML output was just a <em>little</em> bit off.  Not much,
but enough.  Specifically, it was cases in which the Blank Line token was appearing
right after an end List Block token, a case that I felt should not be marked as loose.</p>
<p>Adding a lot of debug and scanning through the log files, I decided to take an approach
of removing the one set of cases that were producing bad results, rather than redesign
the <code>__calculate_list_looseness</code> function from the ground up.  As far as I could tell,
everything else was working, just this one case was failing.  Therefore, I created the
new <code>__correct_for_me</code> function where I looked for Blank Line tokens, looked for the
end List Block tokens directly before it.  At that point, being within the proper list,
the code was then able to make the right determination on the looseness of the list.</p>
<p>Testing that theory took a while to code up, but the testing went by quickly.  It
was during that testing when I noticed that the whitespace in the Paragraph Block
tokens was off by one.  As the HTML output is checked before the Markdown rehydration
is checked, the issues with the HTML output prevented this issue from being seen.
However, due to the extensive logging I have in place, I was able to quickly deduce
that I had mixed up the passing of the <code>leading_space_length</code> variable to the
<code>__adjust_line_for_list_in_process</code> function with the <code>before_ws_length</code> variable.</p>
<p>After a quick fix and some retesting, everything was now working, and the count of
failing tests had fallen by another 2 tests down to 20 failing tests.</p>
<h3 id="the-long-slog-setext-headings">The Long Slog: SetExt Headings<a class="headerlink" href="#the-long-slog-setext-headings" title="Permanent link">¶</a></h3>
<p>Working through the previous scenario tests, I was confident looking at the two
tests that deal with SetExt Heading elements that I would be able to deal with
them quickly.  If someone is right with their confidence on something like this, they
are told they are right.  If they are not right, they are usually told that they had
too much hubris.  That day, hubris was having a fun time laughing at me.</p>
<p>As it was a Saturday, I was doing things around the house and getting them off our
house’s to-do list.  In between each of these tasks, I would sit down and work on trying
to figure out what the issue was with these tests and how to properly identify them.
I was fairly convinced that I needed to be able to detect the start of a SetExt Heading
element.  I was failing miserably on trying to figure out how to perform that
detection. I tried to be smart about the detection, and it failed.  I tried to be
simple about the detection, and that too failed.  And with each attempt, I was just
getting more frustrated.</p>
<p>It was mainly as a joke that I decided to add <code>or True</code> to the end of one of the
<code>if</code> statements.  At the very most, I thought I might possibly find some information
related to the “detecting the start of a SetExt Heading” issue that I was working on.
I was flabbergasted when the scenario tests I was debugging just started working.</p>
<p>In retrospect, it somewhat makes sense, though I want to dig into that function some
more in the future to verify it.  I believe that it worked because SetExt Heading
elements and Paragraph elements are related.  To get a SetExt Heading, you start with
a Paragraph element, and you transform it into the SetExt Heading element once the
SetExt Heading sequence is seen after that paragraph on its own line.  As such, I
didn’t need to add any extra processing above that of the Paragraph processing to
the first <code>if</code> statement in the <code>__check_for_list_closures</code> function, as the Paragraph
element processing was already sufficient.  </p>
<p>In the case of the second <code>if</code> statement, all the other types of Leaf Block element had
already been added, so adding <code>or True</code> just included the one or two remaining types
of leaf blocks that had been missed.  As far as I can tell, it was nothing more than
a shortcut.</p>
<p>Regardless of whether my guess is correct or not, the count was now down from 20
disabled scenario tests to 18 scenario tests… and these ones were going to take
some time to figure out.</p>
<h2 id="the-last-18">The Last 18<a class="headerlink" href="#the-last-18" title="Permanent link">¶</a></h2>
<p>I was then down to the last eighteen scenario tests that I needed to get working, and
I knew some serious work was going to be involved.  I had already been thinking about
this for a while, even going as far to contact the
<a href="https://talk.commonmark.org/">CommonMark Discussion List</a>
to help understand some of the thorny issues.</p>
<h3 id="understanding-the-scope-of-the-problem">Understanding the Scope Of The Problem<a class="headerlink" href="#understanding-the-scope-of-the-problem" title="Permanent link">¶</a></h3>
<p>When all was said and done, these last
scenario tests were failing due to my lack of understanding and implementation of the
following section of the GFM specification:</p>
<blockquote>
<p>Exceptions:
1. When the first list item in a list interrupts a paragraph—that is, when it starts on a line that would otherwise count as paragraph continuation text—then
(a) the lines Ls must not begin with a blank line, and
(b) if the list item is ordered, the start number must be 1.</p>
</blockquote>
<p>It took me a bit to work through it, but here is how I think about it.  Take the
Markdown:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
   <span class="mi">1</span><span class="p">.</span>
</pre></div>
<p>The first line clearly starts a list, but it also opens a paragraph block with the text
<code>abc</code> in it.  Because of that open paragraph, the text in line 2 needs to be handled
carefully, as the previously noted exceptions come into play.  In this case, because of
section (a) of the exceptions, this Markdown will be interpreted as:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>abc
1.<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
</pre></div>
<p>If there is even 1 non-whitespace character on that second line after the list start
identifier, say the Markdown:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
   <span class="mi">1</span><span class="p">.</span> <span class="n">a</span>
</pre></div>
<p>then that section of the exceptions is no longer in play, allowing the second line to
be a valid list start:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>abc
<span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>a<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
</pre></div>
<p>However, the harder one for me to understand was section (b) of the exceptions.  The
impact of that exception is that while the above example works as I would expect, the
following Markdown did not:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>
   <span class="mi">2</span><span class="p">.</span> <span class="n">a</span>
</pre></div>
<p>producing the following HTML</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>abc
2. a<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
</pre></div>
<p>But why?</p>
<h3 id="everything-is-not-perfect">Everything Is Not Perfect<a class="headerlink" href="#everything-is-not-perfect" title="Permanent link">¶</a></h3>
<p>I could give many different examples of what is and is not a proper
translation, but the example from the discussion forum that sticks in my head a lot is:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span> <span class="n">The</span> <span class="n">project</span> <span class="n">risked</span> <span class="n">missing</span>
   <span class="n">its</span> <span class="n">deadline</span> <span class="k">of</span> <span class="n">March</span>
   <span class="mi">13</span><span class="p">.</span> <span class="n">A</span> <span class="n">meeting</span> <span class="n">was</span> <span class="k">called</span><span class="p">.</span>
<span class="mi">2</span><span class="p">.</span> <span class="n">The</span> <span class="n">architect</span> <span class="n">would</span> <span class="n">take</span> <span class="n">flight</span>
   <span class="mi">457</span><span class="p">.</span> <span class="n">It</span> <span class="n">was</span> <span class="n">the</span> <span class="n">red</span> <span class="n">eye</span><span class="p">.</span> 
<span class="mi">3</span><span class="p">.</span> <span class="n">She</span> <span class="n">would</span> <span class="n">stay</span> <span class="k">at</span> <span class="n">the</span> <span class="n">Hilton</span><span class="p">,</span> <span class="n">room</span>
   <span class="mi">22</span><span class="p">.</span> <span class="n">It</span> <span class="n">had</span> <span class="n">an</span> <span class="n">ocean</span> <span class="k">view</span><span class="p">.</span> 
</pre></div>
<p>First off, this example is plainly an example based in the English language, and I
assumed that equally valid examples could be constructed for any language.  Given that
assumption, when I read that Markdown for the first item in the list, it is obvious to
me that the end of the first item in the list refers to <code>March 13.</code>, not a sublist
starting at <code>13</code> with the contents of <code>A meeting was called.</code>.  The context of the rest
of the sentence leaves me with little doubt that the sentence was written that way.
And each of the other two list items left me with the same confidence.  Those numbers
were part of the sentences, and thus the paragraphs that the sentences were in, not
the starts of new lists.</p>
<p>But how should the specification handle the codification of this?  The concepts of
“sentence context” and “looks right” do not apply to the specification.  For something
to apply to the specification, there needs to be a solid rule that can be followed
without fail.  In this case, the second exception comes into play:</p>
<blockquote>
<p>(b) if the list item is ordered, the start number must be 1.</p>
</blockquote>
<p>While it is not perfect, this exception allows the specification to handle the above
cases in a way that it has a solid rule to follow, and hence predictable results. No
guesswork or “sentence context” involved.  I believe that <code>@jgm</code> from the discussion
board put it best:</p>
<blockquote>
<p>If we were inventing a light markup language from scratch, I’d want to require a blank line before a list or sublist (see Beyond Markdown), for this and many other reasons.</p>
<p>But we’re not, so we need to find a compromise that works.</p>
</blockquote>
<p>And that indeed is a viable solution for starting sublists with any number as the
list’s start number.  Therefore, if you the previous example with a non-one sublist
start of <code>2.</code> to be rendered properly, you need to add a newline:</p>
<div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">.</span> <span class="n">abc</span>

   <span class="mi">2</span><span class="p">.</span> <span class="n">a</span>
</pre></div>
<p>producing the following HTML:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>abc<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ol</span> <span class="na">start</span><span class="o">=</span><span class="s">"2"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>a<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
</pre></div>
<p>As <code>@jgm</code> said, and as I agree with, it is a solid compromise.</p>
<h3 id="attacking-the-problem">Attacking the Problem<a class="headerlink" href="#attacking-the-problem" title="Permanent link">¶</a></h3>
<p>The first thing that I did was to validate that this issue applied to both Ordered Lists
and Unordered Lists, which was quickly accomplished.  To me, this indicated that I was
going to be making near identical changes to the <code>is_olist_start</code> function and the
<code>is_ulist_start</code> function.  As the Order List changes were the most complicated, I
decided to start with those.</p>
<p>The first part of detecting the condition described above was deciding that the current
line being parsed was already marked for a list start.  This was already being
performed in the function, so it was an easy change to do some extra processing if the
<code>is_start</code> variable was set.  In that case, to narrow down the things that need to be
checked, the first two changes were to set the <code>is_in_paragraph</code> variable to indicate
whether a paragraph block was open, and the <code>at_end_of_line</code> variable to indicate
that there was no more data to process on the line (hence, a blank line).</p>
<p>With those easy changes out of the way, the variable <code>is_first_item_in_list</code> needed to
be set to indicate whether or not the proposed Ordered List start sequence actually
indicated a new List item or a brand-new List block.  While lengthy in its description,
the next part of
the algorithm checked, in order, to see if a parent List block contained the Paragraph
element, if it was the same type of List element, if it had the same List character,
and if the start index for the proposed List element was greater than that of a matching
List element already in progress.  If any one of those checks failed, the proposed List
start was stored as <code>True</code> in the <code>is_first_item_in_list</code> variable.</p>
<p>From there, the check was relatively easy.  After an additional change to set the
<code>is_not_one</code> variable to indicate whether the <code>olist_index_number</code> variable was not
the string <code>1</code>, the calculation was easy:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span>
        <span class="n">is_in_paragraph</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">at_end_of_line</span> <span class="ow">or</span> <span class="n">is_not_one</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">is_first_item_in_list</span>
    <span class="p">):</span>
        <span class="n">is_start</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
<p>Following the exceptions detailed earlier, when a new list start occurs within an
ongoing paragraph (<code>is_first_item_in_list</code> and <code>is_in_paragraph</code>), a further check
is done to to see if the List element would begin with a blank line (<code>at_end_of_line</code>)
or is an Order List start sequence where the start number is not <code>1</code> (<code>is_not_one</code>).</p>
<h3 id="how-well-did-this-work">How Well Did This Work?<a class="headerlink" href="#how-well-did-this-work" title="Permanent link">¶</a></h3>
<p>The changes documented in the last section were the bulk of the work, and after that
the remaining changes were easy to figure out and work on.  With the line:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">is_theme_break</span> <span class="ow">or</span> <span class="n">is_html_block</span> <span class="ow">or</span> <span class="n">is_fenced_block</span> <span class="ow">or</span> <span class="n">is_atx_heading</span> <span class="ow">or</span> <span class="bp">True</span><span class="p">:</span>
</pre></div>
<p>resolving to True in all cases, I removed that line to make things clearer.  While
it makes a mess of any displayed differences, it really is only removing that line and
shifting all text text that was under that <code>if</code> statement to the left by four spaces.
After running through some tests, there were some failures with the translation to
HTML.  Those failures were all fixed with two lines of code:</p>
<div class="highlight"><pre><span></span>    <span class="k">elif</span> <span class="n">output_html</span> <span class="ow">and</span> <span class="n">output_html</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">newline_character</span><span class="p">:</span>
        <span class="n">output_html</span> <span class="o">+=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">newline_character</span>
</pre></div>
<p>With that completed, all the scenarios were running except scenario test function
<code>test_list_items_282</code>.  After working on that for a while, I marked that scenario test
as disabled, to research it and work on it later.  Along the way, I also added two
variations of test function <code>test_list_blocks_263</code> to test specific cases that I thought
would be a problem, both working without any problems.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>The first thing that came to mind is that I did have an answer to my question from
the Introduction section.  It took me five days to resolve those disabled tests.  More
than anything else, that really cemented my feeling that I made the right decision in
committing that block of work I had from the previous week, with tests disabled.</p>
<p>While I was still a bit tired after my sinus cold from the previous two weeks,
it felt good to get some real solid debugging work done and out of the way.  The
contrast between this one week’s work and the previous two week’s work was just
staggering.  It was a real good feeling to get back up to a speed that I know I
can easily achieve.</p>
<p>And given that non-cold increase in momentum, along with the recent reduction of
items in the issues list, it was nice to see that the finish line is getting visibly
closer.  While I don’t want to jinx myself by setting a date, and then missing it,
I am guessing that I am going to be ready sometime in early 2021, and that is good with
me. Believe it or not, I am very much looking forward to it!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>With some of the hard issues out of the way, I wanted to finish up all the List Block
issues and get started on the Block Quotes issues.  Here is hoping that I would be able
to do that!</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%2012&url=https%3A//jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%2012&amp;body=https%3A//jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-delving-into-the-issues-12"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/" title="Previous: Markdown Linter - Delving Into the Issues - 11">Markdown Linter - Delving Into the Issues - 11</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2020/12/20/autism-and-how-it-affects-my-view-of-christmas/" title="Next: Autism And How It Affects My View of Christmas">Autism And How It Affects My View of Christmas</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~15 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2020-12-14T00:00:00-08:00">Dec 14, 2020</time>
        <h4>Markdown Linter Issues</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2020/09/28/markdown-linter-delving-into-the-issues-1/" title="Markdown Linter - Delving Into the Issues - 1">Part 1: Markdown Linter - Delving Into the Issues - 1</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/05/markdown-linter-delving-into-the-issues-2/" title="Markdown Linter - Delving Into the Issues - 2">Part 2: Markdown Linter - Delving Into the Issues - 2</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/" title="Markdown Linter - Delving Into the Issues - 3">Part 3: Markdown Linter - Delving Into the Issues - 3</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" title="Markdown Linter - Delving Into the Issues - 4">Part 4: Markdown Linter - Delving Into the Issues - 4</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/26/markdown-linter-delving-into-the-issues-5/" title="Markdown Linter - Delving Into the Issues - 5">Part 5: Markdown Linter - Delving Into the Issues - 5</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/" title="Markdown Linter - Delving Into the Issues - 6">Part 6: Markdown Linter - Delving Into the Issues - 6</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" title="Markdown Linter - Delving Into the Issues - 7">Part 7: Markdown Linter - Delving Into the Issues - 7</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/" title="Markdown Linter - Delving Into the Issues - 8">Part 8: Markdown Linter - Delving Into the Issues - 8</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" title="Markdown Linter - Delving Into the Issues - 9">Part 9: Markdown Linter - Delving Into the Issues - 9</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/30/markdown-linter-delving-into-the-issues-10/" title="Markdown Linter - Delving Into the Issues - 10">Part 10: Markdown Linter - Delving Into the Issues - 10</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/" title="Markdown Linter - Delving Into the Issues - 11">Part 11: Markdown Linter - Delving Into the Issues - 11</a>
            </li>
            <li  class="active-part">
            Part 12: Markdown Linter - Delving Into the Issues - 12
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" title="Markdown Linter - Delving Into the Issues - 13">Part 13: Markdown Linter - Delving Into the Issues - 13</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/28/markdown-linter-delving-into-the-issues-14/" title="Markdown Linter - Delving Into the Issues - 14">Part 14: Markdown Linter - Delving Into the Issues - 14</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/04/markdown-linter-delving-into-the-issues-15/" title="Markdown Linter - Delving Into the Issues - 15">Part 15: Markdown Linter - Delving Into the Issues - 15</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/11/markdown-linter-delving-into-the-issues-16/" title="Markdown Linter - Delving Into the Issues - 16">Part 16: Markdown Linter - Delving Into the Issues - 16</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/" title="Markdown Linter - Delving Into the Issues - 17">Part 17: Markdown Linter - Delving Into the Issues - 17</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" title="Markdown Linter - Delving Into the Issues - 18">Part 18: Markdown Linter - Delving Into the Issues - 18</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/01/markdown-linter-delving-into-the-issues-19/" title="Markdown Linter - Delving Into the Issues - 19">Part 19: Markdown Linter - Delving Into the Issues - 19</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>62</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>80</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>