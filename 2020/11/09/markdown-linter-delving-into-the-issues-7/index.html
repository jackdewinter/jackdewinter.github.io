<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I make good progress in removing items from the issues list. Introduction¶ This article is probably going to be a lot shorter than the others in this series. It …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Delving Into the Issues - 7 "/>
<meta property="og:url" content="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" />
<meta property="og:description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I make good progress in removing items from the issues list. Introduction¶ This article is probably going to be a lot shorter than the others in this series. It …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2020-11-09T00:00:00-08:00" />
<meta name="twitter:title" content="Markdown Linter - Delving Into the Issues - 7 ">
<meta name="twitter:description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I make good progress in removing items from the issues list. Introduction¶ This article is probably going to be a lot shorter than the others in this series. It …">

        <title>Markdown Linter - Delving Into the Issues - 7  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/">
                Markdown Linter - Delving Into the Issues - 7
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#keeping-things-organized">Keeping Things Organized</a><ul>
<li><a href="#finding-a-solution">Finding A Solution</a></li>
<li><a href="#i-really-needed-this">I Really Needed This</a></li>
<li><a href="#the-proof-is-in-the-pudding">The Proof Is In The Pudding</a></li>
</ul>
</li>
<li><a href="#is-a-character-entity-the-same-as-a-character">Is A Character Entity the Same As A Character?</a></li>
<li><a href="#finishing-up-the-series-k-tests">Finishing Up the Series K Tests</a><ul>
<li><a href="#attacking-the-parse-failure-cases">Attacking the Parse Failure Cases</a></li>
<li><a href="#properly-handling-split-lines">Properly Handling Split Lines</a></li>
<li><a href="#fixing-the-issue-with-split-lines">Fixing the Issue With Split Lines</a></li>
<li><a href="#cleaning-up">Cleaning Up</a></li>
</ul>
</li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/">last article</a>,
I continued in my quest to reduce the size of the issues list.  In this article, I
make good progress in removing items from the issues list.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>This article is probably going to be a lot shorter than the others in this series.  It
is not the case that I did a lot less work, just that there is just a lot less of that
work to talk about.  The bulk of that work was an effort by me to get the extra
groups of scenario tests more organized.  Sometimes the work I do on the project is
easy to describe and takes a lot of words to explain, as usual.  But in this case,
it is just a lot of work that has a short description.</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/ef7e569ca0710982fe5c4639c055251875bed5b3">23 Oct 2020</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/fa955668b6e2e91a0c9a40efab35bf71769223dc">25 Oct 2020</a>.</p>
<h2 id="keeping-things-organized">Keeping Things Organized<a class="headerlink" href="#keeping-things-organized" title="Permanent link">¶</a></h2>
<p>For most of the time that I have spent on this project, I have maintained a very good
grasp of where things are and what needs
to be done.  Sure, I use the issues list to keep track of all the little things that
I need to fix or check, but I rarely forget about items on the list.  Usually, within
seconds of reading one of the items on the issues list, I remember a good amount of
information about what the problem is and why I added it.  But since the project has
been going on for a while now, I sometimes forget when I added the item to the list.</p>
<p>When it comes to the scenario tests, it used to be the case that I had an equally solid
hold on the tests and what they covered.  At first it was easy, one example from the
<a href="https://github.github.com/gfm">GFM specification</a>
equals one scenario test.  Then, as I was working through the validation of the parser,
I added some extra scenarios by adding a letter to the end of the parent scenario and
documenting the change.  At that point, there was still a good link between the example
that spawned the new scenario test and the parent of that test.</p>
<p>And then came the “extras” scenario tests.  Most of them were added to provide
additional testing for the line/column numbers needed for the linter than for the
parser itself.  As the example provided for in the GFM specification are targeted for
parsers, I felt it was totally reasonable to add extra scenario tests to ensure that
the different in testing between the needs of a parser and the needs of a linter were
covered.</p>
<p>But what started out as a few scenario tests, rapidly grew to a set of tests that
numbered over 140.  The tests are their contents started to get jumbled up in my head
on a frequent basis.  What group of tests was the
test I was just looking at a part of?  Did I cover all the cases within in the group?
Did I miss one?  If I missed one, how could I tell?  It just got more difficult to
keep things clear with each case I added.</p>
<h3 id="finding-a-solution">Finding A Solution<a class="headerlink" href="#finding-a-solution" title="Permanent link">¶</a></h3>
<p>Recently, I had added an item to the issues list to start looking at this:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="nv">need</span> <span class="nv">comprehensive</span> <span class="nv">table</span> <span class="nv">with</span> <span class="nv">tests</span> <span class="nv">that</span> <span class="nv">qualify</span> <span class="k">for</span> <span class="nv">each</span> <span class="nv">test</span> <span class="nv">case</span> <span class="nv">i</span>.<span class="nv">e</span>. <span class="nv">para_extra</span>
  <span class="nv">with</span> <span class="nv">different</span> <span class="nv">groups</span>, <span class="nv">links</span> <span class="nv">and</span> <span class="nv">images</span>
</pre></div>
<p>Now that I had a few weeks to think about it, I believed a solution was in order.  The
first big decision I need to make was to figure out the medium for this table, with
Markdown being the natural selection.</p>
<p>Creating the Markdown document <code>scenario-case.md</code> in the root folder, I tried four
or five formats before settling down on the final format. The first column contains a
unique identifier for that test.  Starting with the letter id for the group of tests,
I made sure that the rest of the identifier clearly described what the scenario test
contained using a common id schema.  Following that identifier column are the columns
that contain a short description of the scenario test, the relevant Markdown from the
test, and the actual function name of the scenario test.  Starting by enumerating the
scenario tests for the
<code>test_markdown_paragraph_extra.py</code> module, I left space for a trailing column that
would also include the function name of the scenario test for the
<code>test_markdown_setext_headings_extra.py</code> module.</p>
<h3 id="i-really-needed-this">I Really Needed This<a class="headerlink" href="#i-really-needed-this" title="Permanent link">¶</a></h3>
<p>When I finished creating this document as the result of this multi-day task, it
was extremely obvious why I needed it:  there was a lot of information to process.
There were a solid core of groups in the initial document, and by documenting each
group, I easily
found things that I had missed or not completed.  By clearly delineating each group of
tests, it also became a lot easier to see the patterns in the groups and why they were
important.</p>
<p>First, there were the basic groups, Series A to Series E.  These were simple
foundational tests for the complete set of inline elements.
Series A tested the inline element at the start of a line, followed by text.
Series B and Series C followed those tests by testing the same inline elements with
text around the inline element and text followed by the inline element.  While they
would not be seen that way naturally, Series D provided tests for each inline element
alone in a document by itself.  Finally, Series E extended the Series D tests by
testing those inline elements that can contain a newline character, rounding out the
foundational tests.</p>
<p>From there there were 4 groups of tests that I had added that all dealt with link
elements and image elements.  The Series F tests provided for a newline character
in each part of all 4 link types.  The Series G tests provided for the same type of
tests but tested for the inclusion of a backslash escape sequence and character
reference sequences.  Due to some issues I encountered with Code Span elements and
Raw Html elements inside of Link Labels, the Series H tests were added to provide
a thorough testing of those combinations.  Rounding out those tests, the Series J
tests provided for various combinations of Inline elements with Link elements and
Image elements, once again added due to some issues that I ran into.</p>
<h3 id="the-proof-is-in-the-pudding">The Proof Is In The Pudding<a class="headerlink" href="#the-proof-is-in-the-pudding" title="Permanent link">¶</a></h3>
<p>As they used to say
“<a href="https://idioms.thefreedictionary.com/proof+is+in+the+pudding">the proof is in the pudding</a>”.
Basically, the only way that I am going to find out if this works or not is by using
it and judging the results.  However, I can say that this initial task
of putting the table together has already yielded positive results.  There were
tests that were duplicated, and there were new distinct tests that were child
tests of existing tests.  Putting that table together helped me clean up the extra
tests by
fixing up those cases.  In addition, it found a missing scenario that dealt with an
inline link type that did not have a title but had whitespace after the URI.  That
scenario is one that I would not have found otherwise.</p>
<p>I feel the balance point of this work needs to be mentioned, as the cost of putting
this table together was a couple of days’ worth of work.  That cost would have be
spread out over numerous issues
if it was started at the beginning, but at that point, I am not sure if the benefit of
putting this table together is something that I thought would justify the cost.  As a
matter of personal sanity, I try not to do the “what ifs” too often.  From my point of
view, while it might have been better to do this earlier, it was at this point that
I started seeing that it needed to be done.  After I made that observation, it was only
a couple of weeks before I took the time to create the table.  And that time was spent
thinking about how I wanted to organize the table, so it was not wasted time.</p>
<p>I guess the thing I am trying to say is this: do not kick yourself and do not rush
things. If you can see something ahead of time, and the benefit is worth the cost to
mitigate the issue, then mitigate.  Otherwise, wait until the benefit becomes worth the
cost, plan it out to make sure you can do it cleanly and clearly, and then work on it.</p>
<h2 id="is-a-character-entity-the-same-as-a-character">Is A Character Entity the Same As A Character?<a class="headerlink" href="#is-a-character-entity-the-same-as-a-character" title="Permanent link">¶</a></h2>
<p>In the section of the GFM on
<a href="https://github.github.com/gfm/#entity-and-numeric-character-references">Entity References</a>,
the specification is very clear about how Character Entities are to be used:</p>
<blockquote>
<p>Entity and character references cannot stand in place of special characters that define structural elements in [Markdown]. For example, although * can be used in place of a literal * character, * cannot replace * in emphasis delimiters, bullet list markers, or thematic breaks.</p>
</blockquote>
<p>To be blunt, you cannot get clearer than that.  If you want the Markdown document to
be interpreted properly, your document must use the actual character used to invoke the
behavior you want, not a character reference.</p>
<p>For the most part, I was very comfortable with that, and I was sure that I had adhered
to that rule throughout the parser.  When it came to the newline character, I
was not as confident.  I was pretty sure that if I tested all the inline elements with
the character entity newline, that the HTML output would look correct.  However, while
I was sure that I properly handled most of the cases, I was not as sure that I had
properly handled all those cases.  Therefore, enter Series K.</p>
<p>To get this series started, I began with the Link elements.  Starting with the inline
Link element, I enumerated the 7 places where the character entity <code>&amp;#xa;</code> could be
inserted, followed by the 2 places for the full Link element and 1 a piece for the
shortcut Link element and the Collapsed Link element.  Once that was in place, I
duplicated those scenarios, transforming the Link elements into their equivalent
Image elements.  Finally, I added cases for the Emphasis element, the Code Span element,
the Raw Html element, and both Autolink elements.</p>
<p>With a total of 27 new scenarios to cover, I started to work on creating these scenario
tests, one at a time.  As with other tests I have documented in previous articles, I
was very precise and meticulous with the creation of those tests.  When each test was
created, I gave it a manual check before testing it against the parser’s HTML output,
but only after running the Markdown against
<a href="https://johnmacfarlane.net/babelmark2">BabelMark</a>.</p>
<p>In the end, 11 of those new scenario tests resulted in failures, with 16 of them passing
right away.  But at that point, it had taken me most of the day to add and verify the
tests, along with all the things that life threw at me that Saturday.  A bit
reluctantly, I committed those tests as-is, after adding 11 new items to the issue list
to track those tests I needed to finish.  Then I went to sleep.</p>
<h2 id="finishing-up-the-series-k-tests">Finishing Up the Series K Tests<a class="headerlink" href="#finishing-up-the-series-k-tests" title="Permanent link">¶</a></h2>
<p>After a good night’s sleep, I took a look at that week’s article notes.  I figured
that the article notes were in a good enough state for me to look at those 11 new items
I added
the night before.  Planning out my work to address those issues, a couple of things
leapt out at me.</p>
<p>The first thing that I noticed was that while I had added some good tests for the link
types, I had
not varied the type of character entity or numeric entity that I used in place of
the newline character.  While I was confident it had been covered in the base GFM
Specification, I believed that for completeness it would be good if I also added it
in this group of tests.  When I was done fixing that, there were 14 new tests in
the table, 7 new tests for Link elements and 7 new tests for Image elements.  In
addition, there was 3 extra scenario tests that I added to complete the coverage
for the other inline elements.  When that work was done, the Series K group contained
42 tests.</p>
<p>The other thing that I did not realize the day before was that the failures were nicely
bucketed into three groups: one that failed in the <code>InlineProcessor</code> class, ones that
failed in the <code>__verify_next_inline_handle_previous_end</code> function, and ones that failed
in the <code>__verify_next_inline_text</code> function.  While it would have been nice if they
all had the same root cause, three different causes to examine was still better than
eleven!</p>
<h3 id="attacking-the-parse-failure-cases">Attacking the Parse Failure Cases<a class="headerlink" href="#attacking-the-parse-failure-cases" title="Permanent link">¶</a></h3>
<p>As luck would have it, this was the easiest problem to fix.  In the code for the
<code>__calculate_inline_deltas</code> function, there was an assert statement as follows:</p>
<div class="highlight"><pre><span></span>    <span class="k">assert</span> <span class="n">link_part_index</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Newline in link token not accounted for."</span>
</pre></div>
<p>When I originally added this code, I was being defensive, thinking that I had not
properly
handled a newline character occurring in the link label part of the Link element and
the Image element.  It took me a bit of time and some extra debug scenarios, but
I was able to conclusively prove that newline character in link labels were already
been handled by another part of the code.  As such, I was able to comment out that
assert and resolve two out of the eleven failures.  On the the next one!</p>
<h3 id="properly-handling-split-lines">Properly Handling Split Lines<a class="headerlink" href="#properly-handling-split-lines" title="Permanent link">¶</a></h3>
<p>After a bit of looking at the remaining tests, one pattern leapt out at me.
Immediately, it looked like the line/column numbers being calculated by the parser were
correct, but the same calculation for the consistency checks was off.  With only
a small amount of looking at the problem, the cause for that result became obvious
to me almost immediately.</p>
<p>When any of the character entities or numeric entities are used in a normally
processed part of the document, a replacement sequence is placed within the token
to represent that sequence.  For the Markdown generator, the original entity is
persisted, and for the HTML generator, the replacement text is persisted.  This
is performed by using a replacement sequence such as <code>\a&amp;#xa;\a\n\a</code>, making it
clear which part is “what is replaced” and which part is “what it is replaced with”.</p>
<p>And therein lied the problem.  In the <code>__verify_next_inline_text</code> function, the
<code>current_line</code> variable is split as follows:</p>
<div class="highlight"><pre><span></span>    <span class="n">split_current_line</span> <span class="o">=</span> <span class="n">current_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p>From there, each part of that split line is processed.  But due to the above
replacement sequence,
each entity sequence like <code>&amp;#xa;</code> generates another entry in that list.  Now, if the
HTML output were being verified, that would work well.  But as the consistency checks
are used to verify the line/column numbers in the Markdown document, those newline
characters confuse the issue.</p>
<p>I realize that this may seem confusing, so consider a small Markdown document like:</p>
<div class="highlight"><pre><span></span><span class="n">a</span><span class="o">&amp;#</span><span class="n">xa</span><span class="p">;</span><span class="n">b</span>
</pre></div>
<p>When this document is parsed, the above Python code will generate an array with two
values in it:</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"a</span><span class="se">\a</span><span class="s2">&amp;#xa;</span><span class="se">\a</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\a</span><span class="s2">b"</span><span class="p">]</span>
</pre></div>
<p>If that does look right, it is because it is not right.  It is a faithful interpretation
of the request made to split the string <code>a\a&amp;#xa;\a\n\ab</code> at its newlines, but it
does not understand that it should only consider the first part of the replacement
sequence, not both the first and the second parts.</p>
<p>I needed to come up with a way to deal with this issue.</p>
<h3 id="fixing-the-issue-with-split-lines">Fixing the Issue With Split Lines<a class="headerlink" href="#fixing-the-issue-with-split-lines" title="Permanent link">¶</a></h3>
<p>That is when I started putting together the <code>__handle_newline_character_entity_split</code>
function.  Given that array of split lines, this function specifically looks for
any entries that start with the replacement character (<code>\a</code>), and the previous entry
ends with the first part of the replacement sequence.  Basically, as the data is split
on the newline character (<code>\n</code>), we want to look for cases where one entry ends with
the <code>\a&amp;#xa;\a</code> part of the sequence and the following entry starts with the <code>\a</code> at
the end of that sequence.</p>
<p>When it was all said and done, the function looked like:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">__handle_newline_character_entity_split</span><span class="p">(</span><span class="n">split_current_line</span><span class="p">):</span>

    <span class="n">try_again</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">try_again</span><span class="p">:</span>
        <span class="n">try_again</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">search_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_current_line</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">split_current_line</span><span class="p">[</span><span class="n">search_index</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"</span><span class="se">\a</span><span class="s2">"</span><span class="p">)</span> <span class="ow">and</span> <span class="n">split_current_line</span><span class="p">[</span>
                <span class="n">search_index</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">__create_newline_tuple</span><span class="p">()):</span>
                <span class="n">combined_line</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">split_current_line</span><span class="p">[</span><span class="n">search_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
                    <span class="o">+</span> <span class="n">split_current_line</span><span class="p">[</span><span class="n">search_index</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">split_current_line</span><span class="p">[</span><span class="n">search_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_line</span>
                <span class="k">del</span> <span class="n">split_current_line</span><span class="p">[</span><span class="n">search_index</span><span class="p">]</span>
                <span class="n">try_again</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">split_current_line</span>
</pre></div>
<p>After testing this new function with a single scenario test, I execute all the failed
tests again, and was rewarded with only four failing tests.  Time to buckle down
and get the last ones taken care of.</p>
<h3 id="cleaning-up">Cleaning Up<a class="headerlink" href="#cleaning-up" title="Permanent link">¶</a></h3>
<p>With four tests remaining, I was ready to put in a lot of work to figure out what
the problem was.  I made sure I had a good snack and a big glass of water, turned
on the debug logging output for some of the tests, and
proceeded to look at the failed scenario tests and the scenario tests that were
around them and were passing. </p>
<p>The first issues I noticed in the failed tests were in the
<code>__verify_next_inline_handle_current_end</code> function, where the number of newlines
characters are counted.  Looking at the difference between the reported line numbers
and the calculated line numbers, there was a direct correlation between the number
of entity sequences used and how much the reported difference in line numbers.  Having
seen this pattern many times before,
it was easy for me to see that instead of using fields in this manner:</p>
<div class="highlight"><pre><span></span>        <span class="n">newline_count4</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">count_newlines_in_text</span><span class="p">(</span>
            <span class="n">current_inline_token</span><span class="o">.</span><span class="n">start_markdown_token</span><span class="o">.</span><span class="n">link_title</span>
        <span class="p">)</span>
</pre></div>
<p>I needed to change that to:</p>
<div class="highlight"><pre><span></span>        <span class="n">pre_link_title</span> <span class="o">=</span> <span class="n">current_inline_token</span><span class="o">.</span><span class="n">start_markdown_token</span><span class="o">.</span><span class="n">link_title</span>
        <span class="k">if</span> <span class="n">current_inline_token</span><span class="o">.</span><span class="n">start_markdown_token</span><span class="o">.</span><span class="n">pre_link_title</span><span class="p">:</span>
            <span class="n">pre_link_title</span> <span class="o">=</span> <span class="n">current_inline_token</span><span class="o">.</span><span class="n">start_markdown_token</span><span class="o">.</span><span class="n">pre_link_title</span>

        <span class="o">...</span>

        <span class="n">newline_count4</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">count_newlines_in_text</span><span class="p">(</span><span class="n">pre_link_title</span><span class="p">)</span>
</pre></div>
<p>After a quick check against the tests, it was obvious that there were also some
issues with the <code>__verify_next_inline_handle_previous_end</code> function, of the same
type.  Looking at that function, I needed to do the same with the <code>link_uri</code> field
and the <code>pre_link_uri</code> field that I did in the above example with the <code>link_title</code>
field and the <code>pre_link_title</code> field.</p>
<p>While verifying those changes, I did notice that there was an omission that was not
tested.  In cases where an inline link contains an URI that is inside of “angle
brackets” (<code>&lt;</code> and <code>&gt;</code>), I was not adjusting the counts to accommodate for that.
After adding an extra test or two, the solution to this was easy, adding
the code:</p>
<div class="highlight"><pre><span></span>        <span class="k">if</span> <span class="n">parent_cur_token</span><span class="o">.</span><span class="n">did_use_angle_start</span><span class="p">:</span>
            <span class="n">part_3</span> <span class="o">+=</span> <span class="mi">2</span>
</pre></div>
<p>to the <code>__verify_next_inline_handle_previous_end</code> function.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>There were a couple of times during the creation and validation of the scenarios
table that I wanted to give up.  It was a large body of work with no immediate
validation of its correctness.  It was also a body of work that could easily fall
out of sync with the actual scenario tests themselves, so there was the future work
to maintain and revalidate the table to consider.</p>
<p>But still, that table was, and still is worth it!  I emphatically believe this with
few reservations, if any.  I do agree that I need to be careful in concluding about
whether to add a scenario test or two versus adding a new scenario
test group.  That is a no-brainer.  But this is another tool that I have in my toolbelt
to help me make sure the quality of the PyMarkdown project is where I want it to be.</p>
<p>Take the case with the group for the newline character entity sequence.  If I had added
only a couple of tests, I would have wondered if I had captured all the cases.  By
adding the tests as a group of cases, I carefully documented and tested the cases that
I could come up with, but left the door open for more cases to be added at a future
date.  For me, that is a winning proposition for the right kind of scenario tests.</p>
<p>And as I mentioned above, the proof is in the pudding.  I have already cleaned
up an old assert statement in the Inline Processor, something I would have overlooked
without that group of tests.  In addition, it found at least three issues with the
consistency checks for the line/column numbers, making that watchdog code more complete.
That small step towards completeness of the consistency checks means that I have more
confidence that it will detect any issues that arise when something is changed.</p>
<p>I know I am getting close to the end of the project, and my goal is to add both
single tests and groups of tests with no changes to either the parser itself or the
consistency checks.  And this work brought me one step closer to that goal!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>Now that I had the master table of scenario tests and their groups together, it
was time to leverage that information and add to it.  That was the focus of
the next week’s work, work that was indeed satisfying.</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%207&url=https%3A//jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%207&amp;body=https%3A//jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-delving-into-the-issues-7"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/" title="Previous: Markdown Linter - Delving Into the Issues - 6">Markdown Linter - Delving Into the Issues - 6</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2020/11/11/autism-stress-and-anxiety/" title="Next: Autism, Stress, and Anxiety">Autism, Stress, and Anxiety</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~14 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2020-11-09T00:00:00-08:00">Nov 9, 2020</time>
        <h4>Markdown Linter Issues</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2020/09/28/markdown-linter-delving-into-the-issues-1/" title="Markdown Linter - Delving Into the Issues - 1">Part 1: Markdown Linter - Delving Into the Issues - 1</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/05/markdown-linter-delving-into-the-issues-2/" title="Markdown Linter - Delving Into the Issues - 2">Part 2: Markdown Linter - Delving Into the Issues - 2</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/" title="Markdown Linter - Delving Into the Issues - 3">Part 3: Markdown Linter - Delving Into the Issues - 3</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" title="Markdown Linter - Delving Into the Issues - 4">Part 4: Markdown Linter - Delving Into the Issues - 4</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/26/markdown-linter-delving-into-the-issues-5/" title="Markdown Linter - Delving Into the Issues - 5">Part 5: Markdown Linter - Delving Into the Issues - 5</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/" title="Markdown Linter - Delving Into the Issues - 6">Part 6: Markdown Linter - Delving Into the Issues - 6</a>
            </li>
            <li  class="active-part">
            Part 7: Markdown Linter - Delving Into the Issues - 7
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/" title="Markdown Linter - Delving Into the Issues - 8">Part 8: Markdown Linter - Delving Into the Issues - 8</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" title="Markdown Linter - Delving Into the Issues - 9">Part 9: Markdown Linter - Delving Into the Issues - 9</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/30/markdown-linter-delving-into-the-issues-10/" title="Markdown Linter - Delving Into the Issues - 10">Part 10: Markdown Linter - Delving Into the Issues - 10</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/" title="Markdown Linter - Delving Into the Issues - 11">Part 11: Markdown Linter - Delving Into the Issues - 11</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" title="Markdown Linter - Delving Into the Issues - 12">Part 12: Markdown Linter - Delving Into the Issues - 12</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" title="Markdown Linter - Delving Into the Issues - 13">Part 13: Markdown Linter - Delving Into the Issues - 13</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/28/markdown-linter-delving-into-the-issues-14/" title="Markdown Linter - Delving Into the Issues - 14">Part 14: Markdown Linter - Delving Into the Issues - 14</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/04/markdown-linter-delving-into-the-issues-15/" title="Markdown Linter - Delving Into the Issues - 15">Part 15: Markdown Linter - Delving Into the Issues - 15</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/11/markdown-linter-delving-into-the-issues-16/" title="Markdown Linter - Delving Into the Issues - 16">Part 16: Markdown Linter - Delving Into the Issues - 16</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/" title="Markdown Linter - Delving Into the Issues - 17">Part 17: Markdown Linter - Delving Into the Issues - 17</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" title="Markdown Linter - Delving Into the Issues - 18">Part 18: Markdown Linter - Delving Into the Issues - 18</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/01/markdown-linter-delving-into-the-issues-19/" title="Markdown Linter - Delving Into the Issues - 19">Part 19: Markdown Linter - Delving Into the Issues - 19</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>73</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>91</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>