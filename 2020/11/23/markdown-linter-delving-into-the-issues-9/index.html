<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I split my time between adding to the scenario cases tables and dealing with items from the issues list. Introduction¶ Not much of an introduction here, just my usual …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Delving Into the Issues - 9 "/>
<meta property="og:url" content="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" />
<meta property="og:description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I split my time between adding to the scenario cases tables and dealing with items from the issues list. Introduction¶ Not much of an introduction here, just my usual …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2020-11-23T00:00:00-08:00" />
<meta name="twitter:title" content="Markdown Linter - Delving Into the Issues - 9 ">
<meta name="twitter:description" content="Summary¶ In my last article, I continued in my quest to reduce the size of the issues list. In this article, I split my time between adding to the scenario cases tables and dealing with items from the issues list. Introduction¶ Not much of an introduction here, just my usual …">

        <title>Markdown Linter - Delving Into the Issues - 9  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/">
                Markdown Linter - Delving Into the Issues - 9
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#dismissing-an-easy-issue">Dismissing an Easy Issue</a></li>
<li><a href="#empty-link-labels">Empty Link Labels</a></li>
<li><a href="#bolstering-up-the-scenario-cases">Bolstering Up the Scenario Cases</a><ul>
<li><a href="#moving-simple-inline-links">Moving Simple Inline Links</a></li>
<li><a href="#adding-links-as-the-last-element-in-the-document">Adding Links as The Last Element in the Document</a></li>
<li><a href="#following-up-with-image-elements">Following Up with Image Elements</a></li>
<li><a href="#moving-scenario-tests-into-their-own-modules">Moving Scenario Tests into Their Own Modules</a></li>
</ul>
</li>
<li><a href="#better-tests-for-link-reference-definitions">Better Tests for Link Reference Definitions</a></li>
<li><a href="#dont-judge-a-book">Don’t Judge A Book…</a></li>
<li><a href="#i-really-need-to-be-more-specific">I Really Need to Be More Specific</a></li>
<li><a href="#verifying-link-reference-definitions-with-other-blocks">Verifying Link Reference Definitions with Other Blocks</a></li>
<li><a href="#cleaning-up-character-entity-tests">Cleaning Up Character Entity Tests</a></li>
<li><a href="#closing-things-up">Closing Things Up</a></li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/">last article</a>,
I continued in my quest to reduce the size of the issues list.  In this article, I
split my time between adding to the scenario cases tables and dealing with items from
the issues list.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Not much of an introduction here, just my usual plodding forward.  Having spent time
in the last couple of weeks working on either the scenario cases tables or resolving
items from the issues list, I tried this week to split my time evenly between those two
tasks.  Without further ado, on to the work!</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/3ff576dcdbac37f42e176a0db6dd6b3d1933188e">03 Nov 2020</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/fe184f8a312033c2998f76b983b83a74a61a96ee">08 Nov 2020</a>.</p>
<h2 id="dismissing-an-easy-issue">Dismissing an Easy Issue<a class="headerlink" href="#dismissing-an-easy-issue" title="Permanent link">¶</a></h2>
<p>Initially, looking at  the following item:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">553</span> <span class="k">with</span> <span class="n">other</span> <span class="k">in</span><span class="o">-</span><span class="n">lines</span><span class="o">?</span>
</pre></div>
<p>I thought I would have some work to do.  However, when I started looking at this
item, it did not take longer than a couple of minutes before I was able to resolve
this issue.</p>
<p>Along the way, there are times where I have good ideas on things to check, and then
other times where I just have ideas.  While I think I meant well with this item,
it ended up falling into neither of those two buckets.  Taking a look at the Markdown
for
<a href="https://github.github.com/gfm/#example-553">example 553</a>:</p>
<div class="highlight"><pre><span></span><span class="k">[bar][foo\\!]</span>

<span class="na">[foo!]: /url</span>
</pre></div>
<p>I believe I wanted to make sure that I tested other concepts to make sure the lookup
worked properly.  The most obvious of those concepts would usually be inline elements,
so I think it might have made sense from that point of view.  However,
I had missed one little thing.  As function <code>test_reference_links_553</code> centers around
subtle variations with the link reference, any inline element would be treated as
plain text, without any interpretation.</p>
<p>Based on that quick research and the fact that I already had tests for inline elements
in the link label, I just resolved it without any changes.  I think while I might have
had something else on my mind when I added that issue to the list, I was unsure of a
good way to honor it in any reasonable form.  It was good to check out though, just
nothing to do to enhance the project with.</p>
<h2 id="empty-link-labels">Empty Link Labels<a class="headerlink" href="#empty-link-labels" title="Permanent link">¶</a></h2>
<p>Added a long time ago, I spotted two issues that I knew that I could resolve
quickly:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">link</span> <span class="k">ref</span> <span class="n">def</span> <span class="k">with</span> <span class="n">empty</span> <span class="n">link</span> <span class="n">label</span><span class="p">,</span> <span class="k">like</span> <span class="mi">560</span><span class="o">?</span>
<span class="o">-</span> <span class="k">full</span> <span class="n">reference</span> <span class="n">link</span> <span class="k">with</span> <span class="n">empty</span> <span class="n">link</span> <span class="n">label</span><span class="p">,</span> <span class="k">like</span> <span class="mi">560</span><span class="o">?</span>
</pre></div>
<p>Obviously added at a time when I was not as complete in my knowledge of the
GFM Specification as I am now, both items were indicating confusion as to why an
empty link label wasn’t valid.</p>
<p>With the experience gained since those items were added, it was easy for me to
reference the GFM Specification on
<a href="https://github.github.com/gfm/#link-reference-definitions">Link Reference Definitions</a>,
select the
<a href="https://github.github.com/gfm/#link-label">link label</a>
reference in the first line of the first paragraph, and extract the following bit
of text from the definition of a link label:</p>
<blockquote>
<p>Between these brackets there must be at least one non-whitespace character.</p>
</blockquote>
<p>While that one line escaped me early in the development of the project, I was now
familiar enough with it to be able to locate it in 30 seconds or less.  As I
acknowledge it is a boundary case, I can see why the specification writers added that
text in there to deal with that case.  From my point of view, an empty link label is
just an empty string that needs to be parsed.  But I also understand that there is
plenty of precedence to also look on an empty string as having no value.  I am not
sure if that is the way I would have gone with this, but I was happy to follow along
with the specification with this one.</p>
<h2 id="bolstering-up-the-scenario-cases">Bolstering Up the Scenario Cases<a class="headerlink" href="#bolstering-up-the-scenario-cases" title="Permanent link">¶</a></h2>
<p>The more I used the new <code>scenario-cases.md</code> document, the more I was enjoying it and
the confidence it brings to the project.  While it is still early in the document’s
life, I am starting to rely on that document at the same level that I rely on the GFM
Specification examples.  Basically,
if a parser can properly handle either one of those groups of tests, it is a good thing.
If it can properly handle both groups of tests, it is a wonderful thing.</p>
<p>As such, a certain amount of this week was spent beefing up that important document.</p>
<h3 id="moving-simple-inline-links">Moving Simple Inline Links<a class="headerlink" href="#moving-simple-inline-links" title="Permanent link">¶</a></h3>
<p>At the start of this block of work, one of the things that I wanted to do was to move
the non-base <code>test_inline_links_518</code> functions into the Series F group by moving them
into the <code>test_paragraph_extra_</code> group.  While this was not a big move, it filled a
hole that I had perceived in the Series F group tests.  And since it was just
moving the tests from one module to the other, the tests were already passing.
That made the duration task seem to fly by.</p>
<h3 id="adding-links-as-the-last-element-in-the-document">Adding Links as The Last Element in the Document<a class="headerlink" href="#adding-links-as-the-last-element-in-the-document" title="Permanent link">¶</a></h3>
<p>Having just moved that small group of tests into the Series F group, I noticed that
all the test cases in that group ended with a Text token, and not a Link element.
As that affects what is checked at the end of a leaf block, I thought it was
prudent to go through the Series F group and add a variation for each case that
tested the base document without any elements after the document.</p>
<p>That was not a difficult task but was a task that was both tedious and lengthy.  I went
through each of the 16 base tests registered in the Series F group and created a
new variant of that base test.  Once created, I removed any trailing non-link
characters from each test document, double checking that I had not disturbed the Link
element itself.  As usual, I verified the HTML document against
<a href="https://johnmacfarlane.net/babelmark2/">Babelmark</a>,
then running the tests to see if there were any issues.</p>
<p>When I ran the tests, I was greeted with the good news that the parser itself was
working properly and the consistency checks only required minor changes.  Those changes
were in the <code>__handle_last_token_end_link</code> function, each of them small adjustments to
handle the various parts of the Link token in its various forms, but nothing that
wasn’t immediately resolvable.</p>
<h3 id="following-up-with-image-elements">Following Up with Image Elements<a class="headerlink" href="#following-up-with-image-elements" title="Permanent link">¶</a></h3>
<p>It should be no surprise that after completing the work documented in the previous two
sections that I decided to follow that work up with ensuring parity for the Image
elements in the Series F group. In total, 29 new scenarios were added to the group,
mirroring the existing Link element tests.</p>
<p>Due to previous hard work and a bit of luck, there
was only one change required in the <code>__handle_last_token_image</code> function.  In the
case where the last token is a full Image token, I just needed to add a single line
to properly increase the <code>inline_height</code> variable by one for each newline in the
<code>text_from_blocks</code> field of the Image token.  While the verification phase of each
test took a while, the testing phase of these additions went by very successfully and
very quickly.</p>
<h3 id="moving-scenario-tests-into-their-own-modules">Moving Scenario Tests into Their Own Modules<a class="headerlink" href="#moving-scenario-tests-into-their-own-modules" title="Permanent link">¶</a></h3>
<p>Over the course of the next three commits, I took on the immense chore of moving and
renaming tests belonging to seven of the identified scenario case groups.  Those seven
groups were Series A to Series E, Series H and Series J.  For each group, I created a
new file, such as <code>test_markdown_paragraph_series_a.py</code> and moved tests in from their
original modules, renaming them as I went.</p>
<p>As I renamed those functions, I started to come up with a solution for how to identify
each test uniquely.  What I quickly settled on was to start the test name with
the series that it belonged to, followed by a descriptive name based on the contents
of the test document.  In this way, I could easily tell if I repeated a test within
a given group by looking at the name of the function.</p>
<p>While this work was primarily copying and renaming scenario tests, it was exhausting.
For each test, I needed to make sure that the name of the function matched the
Markdown document contained within the test.  Then I needed to take that Markdown
document and run in through Babelmark to make sure the HTML output was correct.
Repeated on over 100 scenario tests, it took a lot of time and a lot of patience to
get correct.  But in the end, it was satisfying to be able to see the groups
come together, painting a cohesive picture of a group of passing tests along a given
theme.</p>
<h2 id="better-tests-for-link-reference-definitions">Better Tests for Link Reference Definitions<a class="headerlink" href="#better-tests-for-link-reference-definitions" title="Permanent link">¶</a></h2>
<p>Switching back to resolving items from the issues list, the first thing that caught
my eye was an issue dealing with Link Reference Definitions.
Of all the leaf blocks elements that I have had to design and code for this project,
the Link Reference
Definition element was by far the most difficult to get right.  It was no surprise to
me to find the following item in the issues list:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="nv">what</span> <span class="k">if</span> <span class="nv">bad</span> <span class="nv">link</span> <span class="nv">definition</span> <span class="nv">discovered</span> <span class="nv">multiple</span> <span class="nv">lines</span> <span class="nv">down</span>, <span class="nv">how</span> <span class="nv">to</span> <span class="nv">back</span> <span class="nv">track</span>?
</pre></div>
<p>Starting back in April 2020 when I added support for
<a href="https://jackdewinter.github.io/2020/04/06/markdown-linter-adding-link-reference-definitions/">Link Reference Definitions</a>,
I felt that while the feature was implemented, I knew that there was always going to be
a possibility of a gap in the feature implementation.  Because of the unique multiline
nature of this feature, it is impossible to determine if the element itself is valid
without reading the next line.  As such, I had to implement a “requeue” functionality
to allow the parsing of a possible Link Reference Definition element to be rewound and
attempted again as a different element.  While that has worked well, the bulk of my
concerns over this feature centered around whether that rewinding functionality
dealt with all possible side effects, not just the most common set of them.</p>
<p>Given that history, I decided to add functions <code>test_link_reference_definitions_166a</code>
and <code>test_link_reference_definitions_166b</code> to test for two more cases where an element
was only discovered to be invalid.  In the case of function
<code>test_link_reference_definitions_166a</code>, I made sure that the title portion starts on
the same line but was not properly terminated.  This was to make sure that the entire
element would be discarded as there was no solution where the Link Reference Definition
could be considered complete under any circumstances.  When I added function
<code>test_link_reference_definitions_166b</code>, I took the opposite approach, starting the title
on the next line.  As I started it on the next line, the Link Reference Definition could
be completed, just without the title.</p>
<p>When I ran the tests for these two tests, it was no surprise to me that there was a
failure.  In looking at the tests, the failure was with function
<code>test_link_reference_definitions_166b</code> which fails due to an extra Blank Line token
being generated before the rewind is reprocessed.  It took me a bit of time to realize
that I needed to add the line:</p>
<div class="highlight"><pre><span></span>    <span class="n">force_ignore_first_as_lrd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_to_requeue</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
</pre></div>
<p>at the end part of the <code>__stop_lrd_continuation</code> function that dealt with continuations
that were partially successful.  I just had to try different combinations before
figuring out what the correct one was before proceeding.</p>
<!--- pyml disable-next-line md026-->
<h2 id="dont-judge-a-book">Don’t Judge A Book…<a class="headerlink" href="#dont-judge-a-book" title="Permanent link">¶</a></h2>
<p>Indeed, when I came across this item:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">603</span> <span class="o">-</span> <span class="n">href</span><span class="o">?</span> <span class="n">doesn</span><span class="err">'</span><span class="n">t</span> <span class="n">look</span> <span class="k">right</span>
</pre></div>
<p>I agreed that it did not look right.  The Markdown for
<a href="ex-603">example 603</a> is:</p>
<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">foo</span><span class="p">.</span><span class="n">bar</span><span class="p">.</span><span class="n">baz</span><span class="o">/</span><span class="n">test</span><span class="o">?</span><span class="n">q</span><span class="o">=</span><span class="n">hello</span><span class="o">&amp;</span><span class="n">id</span><span class="o">=</span><span class="mi">22</span><span class="o">&amp;</span><span class="nb">boolean</span><span class="o">&gt;</span>
</pre></div>
<p>producing the HTML:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"http://foo.bar.baz/test?q=hello&amp;amp;id=22&amp;amp;boolean"</span><span class="p">&gt;</span>http://foo.bar.baz/test?q=hello<span class="ni">&amp;amp;</span>id=22<span class="ni">&amp;amp;</span>boolean<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div>
<p>I was able to verify it quickly against Babelmark, but it took me a bit to figure out
what the parser did to get to that result.  The big thing that I had to remember for
this case was that it was interpreted as an Autolink, which is meant as a quick way to
provide references.  As such, it makes sense that instead of a literal interpretation
of the
specified link, the processing leans more towards what the user probably intended.  To
that end, it makes sense that the ampersand (<code>&amp;</code>) character in the link is translated
into the named character entity <code>&amp;amp;</code> for use in both the reference and the text.</p>
<p>So, after thinking it through and checking it out, the function <code>test_autolinks_603</code> is
100% correct.  For extra points though, to produce the correct link, I determined that
the following HTML block would be needed:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://foo.bar.baz/test?q=hello&amp;id=22&amp;boolean"</span><span class="nt">&gt;</span>http://foo.bar.baz/test?q=hello<span class="err">&amp;</span>id=22<span class="err">&amp;</span>boolean<span class="nt">&lt;/a&gt;</span>
</pre></div>
<p>Yeah, I like puzzles, and this was a good one.</p>
<h2 id="i-really-need-to-be-more-specific">I Really Need to Be More Specific<a class="headerlink" href="#i-really-need-to-be-more-specific" title="Permanent link">¶</a></h2>
<p>While I am usually good at adding items to the issues list, this one was cryptic:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">620</span> <span class="o">-</span> <span class="k">more</span> <span class="n">bad</span> <span class="n">cases</span><span class="p">,</span> <span class="k">like</span> <span class="o">&lt;</span>
</pre></div>
<p>Huh?  That really was not a lot to go on, but I gave it a shot.  Without more
information in the item, I just got a bit creative.</p>
<p>Taking a look at function <code>test_autolinks_604</code>, I took the initial URI autolink of
<code>&lt;irc://foo.bar:2233/baz&gt;</code>, stripping it down to <code>&lt;irc:foo.bar&gt;</code> for
function <code>test_autolinks_604a</code> and expanding the theme to
<code>&lt;my+weird-custom.scheme1:foo.bar&gt;</code> for function <code>test_autolinks_604b</code>. Similarly,
I took the email Autolink of <code>&lt;foo+special@Bar.baz-bar0.com&gt;</code> from function
<code>test_autolinks_613</code> and reduced it down to <code>&lt;l@f&gt;</code> for function <code>test_autolinks_613a</code>.
Having added some good positive tests, I then decided to add negative tests.  For
function <code>test_autolinks_620a</code> I specified a theme with too few characters, while
function <code>test_autolinks_620b</code> specified a theme with too many characters. Test
function <code>test_autolinks_613c</code> specified a scheme with an invalid character in the
theme, while function <code>test_autolinks_613d</code> had no domain part and function
<code>test_autolinks_613e</code> had no name part.</p>
<p>These tests all passed without incident, but it felt good to increase the scenarios
and increase my confidence in the project.  While I was pretty sure that these would
all pass, as they are all based on regular expressions with specific character counts,
it just felt right to explicitly test those limits and make sure they were consistent.</p>
<h2 id="verifying-link-reference-definitions-with-other-blocks">Verifying Link Reference Definitions with Other Blocks<a class="headerlink" href="#verifying-link-reference-definitions-with-other-blocks" title="Permanent link">¶</a></h2>
<p>In the same manner as other tests, this one started from the issues list item:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">test_link_reference_definitions_183</span> <span class="k">is</span> <span class="n">a</span> <span class="k">partial</span> <span class="n">lrd</span> <span class="n">followed</span> <span class="k">by</span> <span class="n">bq</span><span class="p">,</span> <span class="k">add</span> <span class="n">cont</span><span class="o">+</span><span class="n">leaf</span> <span class="n">blocks</span>
</pre></div>
<p>In test function <code>test_link_reference_definitions_183</code>, the Link Reference Definition
(or its acronym LRD as used in the item) follows an Atx Heading element.  In the
GFM Specification for this example, it explicitly states:</p>
<blockquote>
<p>However, it can directly follow other block elements, such as headings and thematic breaks, and it need not be followed by a blank line.</p>
</blockquote>
<p>While it states that it can follow other block elements, it only gave three examples:
one after an Atx Heading element, one before a Thematic Break element, and one before a
SetExt Heading element.  Those three tests cases, spread out in the three functions
between <code>test_link_reference_definitions_183</code> and <code>test_link_reference_definitions_185</code>
were a good start, I felt that better coverage was warranted.  Therefore, I created
functions <code>a</code> to <code>g</code> for function <code>test_link_reference_definitions_183</code> and functions
<code>a</code> to <code>f</code> for function <code>test_link_reference_definitions_185</code> to cover the before and
after cases.</p>
<p>Except for two of the tests, they all passed without incident.  The two
that did not pass were tests that involved a Link Reference Definition occurring both
before and after a list. As I knew I was going to be finishing up with leaf blocks
and heading to container blocks in the next week or two, I marked those test as
disabled, added an item to the issues list, and kept on going.</p>
<h2 id="cleaning-up-character-entity-tests">Cleaning Up Character Entity Tests<a class="headerlink" href="#cleaning-up-character-entity-tests" title="Permanent link">¶</a></h2>
<p>At first, when I saw the issues list item:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">test_markdown_entity</span><span class="o">*</span> <span class="n">various</span> <span class="n">extra</span> <span class="n">tests</span>
</pre></div>
<p>I thought that I had missed a couple of cases and looked for some missing cases.  It
was during that search that I came across the following text at the end of the
<code>test_markdown_entity_and_numeric_character_references.py</code> module:</p>
<div class="highlight"><pre><span></span><span class="c1"># TODO</span>
<span class="c1">#</span>
<span class="c1"># &amp; and various forms at end of line</span>
<span class="c1">#</span>
<span class="c1"># 327 special parsing for html blocks?</span>
<span class="c1"># &lt;a href="&amp;ouml;&amp;ouml;.html" x="&amp;ouml;"&gt;</span>
<span class="c1"># &lt;x-me foo="&amp;ouml;"&gt;</span>

<span class="c1"># &lt;script&gt;</span>
<span class="c1"># &amp;ouml; bar="&amp;ouml;" bbb</span>
</pre></div>
<p>Comparing the items in the Python list, I determined that all those cases had already
been covered by other tests, but there were some tests that I thought it was worth
adding.</p>
<p>While the example for function <code>test_character_references_321</code> specified that the text
must match that of an entity in the named entities table, I added function
<code>test_character_references_321a</code> to make it explicit that it was a case-sensitive
lookup.  Similarly, functions <code>test_character_references_322</code> and
<code>test_character_references_323</code> mention turning numeric entities into characters, but
only included the special <code>NUL</code> character <code>0</code> as a byproduct of the text in an example.
As such, I created the <code>test_character_references_323a</code> function to call attention to
this special character, also showing that any number of leading zeroes does not matter
for numeric entities.</p>
<p>In a similar pattern, but at a higher level, I added the <code>test_character_references_336</code>
series of functions, named <code>a</code> to <code>e</code>.  While I was okay with the examples showing the
usage of entities in paragraphs, I felt that having explicit cases of entities in each
of the other leaf blocks was useful.  In order, the tests added named entities in each
of an Atx Heading element, a SetExt Heading element, and Indented Code Block element,
a Fenced Code Block element, and a Html Block element.  I also verified that the entity
was interpreted in the first two elements, and not interpreted in the last three
elements, as per the GFM Specification.</p>
<p>Finally, as a simple set of comprehensive tests, I wanted to have a good example of
specifying
a named entity using all three forms: named, decimal, and hexadecimal.  As such, I
created the <code>test_character_references_extra_</code> functions with <code>01</code> using <code>&amp;quot;</code>,
<code>02</code> using <code>&amp;#34;</code>, and <code>03</code> using <code>&amp;#x22;</code>.  I know that these functions were going
to pass ahead of time, but it gave me confidence knowing that I had a concrete set of
three tests showing that the form of the entity didn’t matter, as they all produced
the same HTML results.</p>
<h2 id="closing-things-up">Closing Things Up<a class="headerlink" href="#closing-things-up" title="Permanent link">¶</a></h2>
<p>Even though I was getting close to writing time on Sunday morning, I wanted to try and
clear one more easy issue from the list:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="k">is</span> <span class="n">HTML</span> <span class="n">transformer</span> <span class="k">using</span> <span class="n">text_from_chars</span><span class="p">,</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">other</span> <span class="n">field</span><span class="o">?</span>
  <span class="o">-</span> <span class="n">see</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">jackdewinter</span><span class="o">/</span><span class="n">pymarkdown</span><span class="o">/</span><span class="n">commit</span><span class="o">/</span><span class="n">a506ddd3bda08a8ca1d97a7b0d68c114325b545e</span> <span class="ss">`extra_74`</span>
</pre></div>
<p>This was more of a bookkeeping issue than anything else, or at least I hoped it was.
During a previous change on 02 Oct 2020, I thought I had noticed that the HTML
transformer was using the <code>text_from_blocks</code> field to create the text for the links.
Thankfully, resolving this took a quick look at the <code>__handle_image_token</code> function
in the <code>transform__to_gfm.py</code> module to verify it was not using that field.</p>
<p>When I took a second, this should have been more obvious to me.  While it is possible
to derive the <code>image_alt_text</code> field from the <code>text_from_blocks</code> field, it is the last
thing I would have thought about when generating HTML.  But I still felt good that I
verified this and dispelled any doubts about the HTML output being based on the wrong
part of the token out of my mind.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>The work went on like it always does, but an interesting milestone was met with
the completion of this work: any outstanding issues clearly identified as being
attributable to a leaf block has been solved.  Short version?  I finished any
issue that was clearly a leaf block issue.</p>
<p>While the realization of that goal was not a big thing to me, it wasn’t a small one
either.  It still meant that I needed to check how leaf blocks interacted with the two
container blocks, but it reduced the number of things to check to just interactions
with and between container blocks.  That was a good feeling, knowing I had hit that
mark.  It increased my confidence that things were going in the right direction.</p>
<p>It is still too early to tell, but I am now starting to hope for an initial release
of PyMarkdown as a linter in the early parts of 2021.  That felt good typing that.
Real good.</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>With the work done to verify the leaf blocks, the next week was going to be full of
me trying to reduce the issues specific to list blocks. Closer to the line I get!</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%209&url=https%3A//jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%209&amp;body=https%3A//jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-delving-into-the-issues-9"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/" title="Previous: Markdown Linter - Delving Into the Issues - 8">Markdown Linter - Delving Into the Issues - 8</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2020/11/30/markdown-linter-delving-into-the-issues-10/" title="Next: Markdown Linter - Delving Into the Issues - 10">Markdown Linter - Delving Into the Issues - 10</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~14 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2020-11-23T00:00:00-08:00">Nov 23, 2020</time>
        <h4>Markdown Linter Issues</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2020/09/28/markdown-linter-delving-into-the-issues-1/" title="Markdown Linter - Delving Into the Issues - 1">Part 1: Markdown Linter - Delving Into the Issues - 1</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/05/markdown-linter-delving-into-the-issues-2/" title="Markdown Linter - Delving Into the Issues - 2">Part 2: Markdown Linter - Delving Into the Issues - 2</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/" title="Markdown Linter - Delving Into the Issues - 3">Part 3: Markdown Linter - Delving Into the Issues - 3</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" title="Markdown Linter - Delving Into the Issues - 4">Part 4: Markdown Linter - Delving Into the Issues - 4</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/26/markdown-linter-delving-into-the-issues-5/" title="Markdown Linter - Delving Into the Issues - 5">Part 5: Markdown Linter - Delving Into the Issues - 5</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/" title="Markdown Linter - Delving Into the Issues - 6">Part 6: Markdown Linter - Delving Into the Issues - 6</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" title="Markdown Linter - Delving Into the Issues - 7">Part 7: Markdown Linter - Delving Into the Issues - 7</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/" title="Markdown Linter - Delving Into the Issues - 8">Part 8: Markdown Linter - Delving Into the Issues - 8</a>
            </li>
            <li  class="active-part">
            Part 9: Markdown Linter - Delving Into the Issues - 9
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/30/markdown-linter-delving-into-the-issues-10/" title="Markdown Linter - Delving Into the Issues - 10">Part 10: Markdown Linter - Delving Into the Issues - 10</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/" title="Markdown Linter - Delving Into the Issues - 11">Part 11: Markdown Linter - Delving Into the Issues - 11</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" title="Markdown Linter - Delving Into the Issues - 12">Part 12: Markdown Linter - Delving Into the Issues - 12</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" title="Markdown Linter - Delving Into the Issues - 13">Part 13: Markdown Linter - Delving Into the Issues - 13</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/28/markdown-linter-delving-into-the-issues-14/" title="Markdown Linter - Delving Into the Issues - 14">Part 14: Markdown Linter - Delving Into the Issues - 14</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/04/markdown-linter-delving-into-the-issues-15/" title="Markdown Linter - Delving Into the Issues - 15">Part 15: Markdown Linter - Delving Into the Issues - 15</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/11/markdown-linter-delving-into-the-issues-16/" title="Markdown Linter - Delving Into the Issues - 16">Part 16: Markdown Linter - Delving Into the Issues - 16</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/" title="Markdown Linter - Delving Into the Issues - 17">Part 17: Markdown Linter - Delving Into the Issues - 17</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" title="Markdown Linter - Delving Into the Issues - 18">Part 18: Markdown Linter - Delving Into the Issues - 18</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/01/markdown-linter-delving-into-the-issues-19/" title="Markdown Linter - Delving Into the Issues - 19">Part 19: Markdown Linter - Delving Into the Issues - 19</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>55</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>73</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2020 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>