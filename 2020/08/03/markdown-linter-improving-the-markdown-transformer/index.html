<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I walked through the items that I chose to work on from the issues list, detailing my process for resolving each one. In this article, I detail how I continued the march forward to increase my consistency check confidence by further implementing the token to …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Improving the Markdown Transformer "/>
<meta property="og:url" content="https://jackdewinter.github.io/2020/08/03/markdown-linter-improving-the-markdown-transformer/" />
<meta property="og:description" content="Summary¶ In my last article, I walked through the items that I chose to work on from the issues list, detailing my process for resolving each one. In this article, I detail how I continued the march forward to increase my consistency check confidence by further implementing the token to …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2020-08-03T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Improving the Markdown Transformer ">
<meta name="twitter:description" content="Summary¶ In my last article, I walked through the items that I chose to work on from the issues list, detailing my process for resolving each one. In this article, I detail how I continued the march forward to increase my consistency check confidence by further implementing the token to …">

        <title>Markdown Linter - Improving the Markdown Transformer  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2020/08/03/markdown-linter-improving-the-markdown-transformer/">
                Markdown Linter - Improving the Markdown Transformer
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#did-i-take-the-week-off">Did I Take the Week Off?</a></li>
<li><a href="#adding-html-support">Adding HTML Support</a></li>
<li><a href="#adding-setext-heading-support">Adding SetExt Heading Support</a><ul>
<li><a href="#the-initial-push">The Initial Push</a></li>
<li><a href="#the-problem">The Problem</a></li>
<li><a href="#another-rabbit-hole">Another Rabbit Hole?</a></li>
<li><a href="#over-the-next-2-days">Over the Next 2 Days</a></li>
<li><a href="#the-final-breakthrough">The Final Breakthrough</a></li>
<li><a href="#the-solution">The Solution</a></li>
<li><a href="#hindsight-is-always-clearer">Hindsight is Always Clearer</a></li>
</ul>
</li>
<li><a href="#adding-emphasis-support">Adding Emphasis Support</a></li>
<li><a href="#adding-autolink-and-raw-html-support">Adding Autolink and Raw HTML Support</a></li>
<li><a href="#adding-code-span-support">Adding Code Span Support</a><ul>
<li><a href="#the-initial-attempt">The Initial Attempt</a></li>
<li><a href="#addressing-the-issue">Addressing the Issue</a></li>
</ul>
</li>
<li><a href="#adding-fenced-code-block-support">Adding Fenced Code Block Support</a></li>
<li><a href="#adding-atx-heading-support">Adding Atx Heading Support</a></li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2020/07/27/markdown-linter-addressing-the-initial-markdown-transformer-issues/">last article</a>,
I walked through the items that I chose to work on from the issues list, detailing my
process for resolving each one.  In this article, I detail how I continued the march
forward to increase my consistency check confidence by further implementing the token
to Markdown transformer.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Having removed a good number of items from the issues list, I decided that
it was time to get back to verifying the tokens using the Markdown transformer.  While
my initial attempt at implementing the transformer yielded 8 new items on my issues
list, I was hopeful that this next batch of features for the transformer would uncover
fewer errors. Do not get me wrong. If there are issues with any part of the project, I
want to know about them so I can properly prioritize them.  I was just hoping that the
number of new items that I found would be lower this time.</p>
<p>It is with that hopeful mindset that I started to work on implementing the
transformations for the other Markdown features, excluding the container blocks and the
link related blocks.  While awkwardly stated, that statement outlined a block of work
that I knew I would be comfortable working on and confident that I could complete.
Looking ahead, I knew that link transformations were next on the list, with container
blocks taking up the final position.  I knew I still needed to tackle those token
groups, but I was far more confident about handling the simpler cases first.  By
handling those simpler cases first, I hoped to build up my confidence to work on the
links in the subsequent section.  At least it would build up if I did not discover as
many errors as with the last chunk of work!</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/c9cd5e54a7a6167594dbce593e8869856db6db32">19 Jul 2020</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/7151ea88a180bdc4b977940e90e9db4908b13ede">26 Jul 2020</a>.</p>
<h2 id="did-i-take-the-week-off">Did I Take the Week Off?<a class="headerlink" href="#did-i-take-the-week-off" title="Permanent link">¶</a></h2>
<p>Looking at the commits for this chunk of work, it may look like I did the HTML block on
the Sunday, then took the week off, restarting the work on Saturday.  For no other
reason than dumb luck, I just hit a wall when trying to transform the SetExt Heading
tokens. Everything else just flew right by!  More on that in a bit.</p>
<h2 id="adding-html-support">Adding HTML Support<a class="headerlink" href="#adding-html-support" title="Permanent link">¶</a></h2>
<p>During the writing of that week’s article, I just felt that I needed a bit of a break.
Being a bit fidgety about the block of work that was coming up next, I decided that I
wanted to start doing some work on a random token type.
The HTML block token support was that work, the type of token to work on chosen randomly
using the time-tested
<a href="https://en.wikipedia.org/wiki/Eeny,_meeny,_miny,_moe">Eeny, Meeny method</a>.
I honestly did not think that adding that support would be so easy that I could
complete it with only 25
lines of code changed, even less if I do not include blank lines.  I was just looking
to find something to give my mind a break from writing the article.  Nothing more.</p>
<p>However, I cannot lie about it.  It was refreshing.  Go in, add the transformation, run
the tests, fix 1 or 2 problems that I found, and… done!  It worked so well, I thought
I would do it with the next token.  And that token is the SetExt Heading Token</p>
<h2 id="adding-setext-heading-support">Adding SetExt Heading Support<a class="headerlink" href="#adding-setext-heading-support" title="Permanent link">¶</a></h2>
<p>While you can estimate and plan for hours, there are times where the effort required to
do something seems almost random.  In one of the teams that I worked on, we referred to
this type of work as the spins on the “Wheel of Effort”.  One spin of the wheel and you
may get 1 hour, and another spin for a similar item may get 1 day.  It just depends.
I know there were underlying conditions that were contributing to that calculation of
effort.  However, from my viewpoint, it just seemed like a spin of the wheel.</p>
<p>And the wheel was about to give me a spin that I really did not like.</p>
<h3 id="the-initial-push">The Initial Push<a class="headerlink" href="#the-initial-push" title="Permanent link">¶</a></h3>
<p>From experience dealing with SetExt Heading issues, I had a feeling that adding the
support for the SetExt Heading tokens was going to be more difficult than most other
tokens.  That experience also reminded me that most of the issues that I have had with
SetExt Headings were not with the SetExt Heading tokens themselves, but the text block
contained within.  While the SetExt Heading token itself is created to replace an
existing Paragraph token, the handling of the two text blocks was different enough that
I was immediately cautious about those differences.</p>
<p>The first change that I made for this feature was to write a simple implementation of
the token handlers.  It was during that implementation that I discovered that while the
SetExt Heading tokens contained information about which heading character was used, the
quantity of those characters in the Markdown document was absent.  That was an easy
fix to implement.  A quick jump over to the <code>SetextHeadingMarkdownToken</code> class to add
the <code>heading_character_count</code> argument and member variable.  Then another quick jump
back to the new token handlers to use that new member variable when rehydrating the end
token.  Done.  Easy.</p>
<p>Except it was not.  A single set of tests were failing in each test run: the
<a href="https://github.github.com/gfm/#example-52">example 052</a>
series of tests dealing with SetExt text that starts with whitespace.  To simplify
the test for a previous fix, I created the scenario test <code>test_setext_headings_052a</code>
to keep the problem simple and easy to diagnose.  The issues for both
<code>test_setext_headings_052</code> and <code>test_setext_headings_052a</code> were easily fixed, but I
then noticed
a glaring issue:  there was no tests for SetExt Heading text that had both leading
and trailing whitespace.  To address that, I created
<code>test_setext_headings_052b</code> to add some trailing whitespace while maintaining the same
HTML output with <code>test_setext_headings_052a</code>.  From there, the <code>c</code>, <code>d</code> and <code>e</code>
variations were added to test various other patterns that I hoped were working
properly.  All those variations passed immediately, except for scenario test
<code>test_setext_headings_052b</code>. That was failing and I was not sure why.</p>
<h3 id="the-problem">The Problem<a class="headerlink" href="#the-problem" title="Permanent link">¶</a></h3>
<p>Scenario test <code>test_setext_headings_052b</code> is a simpler version of
<a href="https://github.github.com/gfm/#example-52">example 52</a>
with some changes thrown in.  In this new scenario test, the data is as follows:</p>
<div class="highlight"><pre><span></span>  <span class="n">a</span><span class="err">{</span><span class="k">space</span><span class="err">}</span>
  <span class="n">b</span><span class="err">{</span><span class="k">space</span><span class="err">}</span>
  <span class="k">c</span>
<span class="o">===</span>
</pre></div>
<p>where the literal text <code>{space}</code> are space characters at the end of each of those lines.
For comparison, the Markdown for test <code>test_setext_headings_052a</code> is:</p>
<div class="highlight"><pre><span></span>  <span class="n">a</span>
  <span class="n">b</span>
  <span class="k">c</span>
<span class="o">===</span>
</pre></div>
<p>and the HTML output for that test is:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>a
b
c<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</pre></div>
<p>By comparison, the new scenario test <code>test_setext_headings_052b</code>, is a literal copy of
that original
scenario test <code>test_setext_headings_052a</code> with the addition of a single space
character at the end of the first two lines.  As the GFM specification states that
leading and trailing spaces are removed in normal paragraphs, it makes sense that those
additional space characters would be removed as excess whitespace.  As such, I expected
that the HTML output would be the same, and it was.</p>
<p>But when the Markdown transformer rehydrated the text, that removed whitespace was
inserted at the start of the line.  The rehydrated Markdown for this initial stage was:</p>
<div class="highlight"><pre><span></span>   <span class="n">a</span>
   <span class="n">b</span>
  <span class="k">c</span>
<span class="o">===</span>
</pre></div>
<p>Digging a bit deeper, it took a fair amount of additional logging and debugging before
an answer started forming in my head.  The last line was fine, mostly because it did not
have any whitespace at the end of its line.  In the case of the first and second lines,
that trailing space was being placed at the start of the line, instead of the end of
the line.</p>
<p>The problem?  The 2 spaces removed from the start of the line and the 1 space removed
from the end of the line were being merged.  The result?  When the Markdown
transformer went to rehydrate the token, all 3 of those removed spaces were placed at
the start of the line.  I needed some way to keep the two groups of spaces separate
from each other.</p>
<h3 id="another-rabbit-hole">Another Rabbit Hole?<a class="headerlink" href="#another-rabbit-hole" title="Permanent link">¶</a></h3>
<p>Yup, that thought had crossed my mind.  By the time that I had debugged the problem and
understood it clearly, it was late Wednesday night and I had already spent 2 nights
working on this issue.  To ensure that I did not go “missing” again, I set a maximum
duration of 2 days to solve this issue.  If not solved in that time, it would go on the
issues list to be dealt with later.</p>
<p>Was this a bit overboard?  Perhaps.  But given my past history with
<a href="({filename}/articles/SoftwareQuality/core-5.md)">chasing down issues like this</a>,
I figured it was better to plan ahead to prevent myself from getting
in that predicament.  Given how much I like puzzles, combined with a gut feeling about
this issue, it just seemed the right thing to do at the time.</p>
<h3 id="over-the-next-2-days">Over the Next 2 Days<a class="headerlink" href="#over-the-next-2-days" title="Permanent link">¶</a></h3>
<p>Over the next 2 days, I tried 3 or 4 different approaches.  But in each
case, there was some manner of complication that prevented me from going forward with
it. It was frustrating, but I was adamant that I was going to find a solution.  Well,
if it did not exceed my self-imposed deadline of Friday night.  And that
deadline just kept on getting closer and closer.</p>
<h3 id="the-final-breakthrough">The Final Breakthrough<a class="headerlink" href="#the-final-breakthrough" title="Permanent link">¶</a></h3>
<p>Early on Friday night, I was very frustrated that nothing I tried had worked.  After
resetting the code yet again, I decided I was going to do my best to keep things
simple.  Before, I had tried altering the signatures of the functions and passing
variables around, and that did not get me anywhere.  Turning that effort around, I
figured that the simplest way to separate the two parts of the line was with a
separator character.</p>
<p>Previously, the tokens for scenario test <code>test_setext_headings_052b</code> were:</p>
<div class="highlight"><pre><span></span>    expected_tokens = [
        "[setext(4,1):=:3:  :(1,3)]",
        "[text:a\nb\nc:: \n   \n  ]",
        "[end-setext::]",
    ]
</pre></div>
<p>Using a simple separator character of <code>\x02</code>, I was able to change the serialized form
of the text token to:</p>
<div class="highlight"><pre><span></span>    expected_tokens = [
        "[setext(4,1):=:3:  :(1,3)]",
        "[text:a\nb\nc:: \n  \x02 \n  \x02]",
        "[end-setext::]",
    ]
</pre></div>
<p>That one change was simple and pivotal, and it struck a chord in me right away.
That separator character clearly separated the two different whitespace sequences from
each other, with no complex variable passing to enforce it.  But that was only part of
it.  Would it the Markdown transformer portion of this fix be as clean and easy?</p>
<h3 id="the-solution">The Solution<a class="headerlink" href="#the-solution" title="Permanent link">¶</a></h3>
<p>I needed a come up with a fix to compensate for that change in the token’s text.
Before this change, the token’s text and the token’s whitespace were reintegrated with
each other using a simple algorithm:</p>
<div class="highlight"><pre><span></span>    <span class="n">rejoined_token_text</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">split_token_text</span> <span class="o">=</span> <span class="n">main_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">split_parent_whitespace_text</span> <span class="o">=</span> <span class="n">next_token</span><span class="o">.</span><span class="n">end_whitespace</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iterator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">split_token_text</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">joined_text</span> <span class="o">=</span> <span class="n">split_parent_whitespace_text</span><span class="p">[</span><span class="n">iterator</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">iterator</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rejoined_token_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">joined_text</span><span class="p">)</span>
    <span class="n">main_text</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rejoined_token_text</span><span class="p">)</span>
</pre></div>
<p>Basically, split the text string and the whitespace string into arrays, splitting
them on the newline character.  Then take those two arrays and create a new array with
the concatenation of the element from the whitespace array with the text from the text
token element.  When done with all the elements, create a new string by merging the
contents of the array together, using a newline character to join the lines.</p>
<p>After this change, that algorithm got a bit more complex, but not by much.</p>
<div class="highlight"><pre><span></span>    <span class="n">rejoined_token_text</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">split_token_text</span> <span class="o">=</span> <span class="n">main_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">split_parent_whitespace_text</span> <span class="o">=</span> <span class="n">next_token</span><span class="o">.</span><span class="n">end_whitespace</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iterator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">split_token_text</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">ws_prefix_text</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="n">ws_suffix_text</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="k">if</span> <span class="n">split_parent_whitespace_text</span><span class="p">[</span><span class="n">iterator</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>
            <span class="n">split_setext_text</span> <span class="o">=</span> <span class="n">split_parent_whitespace_text</span><span class="p">[</span><span class="n">iterator</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\x02</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_setext_text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">iterator</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ws_suffix_text</span> <span class="o">=</span> <span class="n">split_setext_text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ws_prefix_text</span> <span class="o">=</span> <span class="n">split_setext_text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ws_prefix_text</span> <span class="o">=</span> <span class="n">split_setext_text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ws_suffix_text</span> <span class="o">=</span> <span class="n">split_setext_text</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">joined_text</span> <span class="o">=</span> <span class="n">ws_prefix_text</span> <span class="o">+</span> <span class="n">iterator</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ws_suffix_text</span>
        <span class="n">rejoined_token_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">joined_text</span><span class="p">)</span>
    <span class="n">main_text</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rejoined_token_text</span><span class="p">)</span>
</pre></div>
<p>Instead of the very simple concatenation of the whitespace and the text, there was a bit
more work to do.  First, the whitespace needed to be split into two, based on the new
separator character <code>\x02</code>.</p>
<p>It was more difficult than the original algorithm, but not by much.  Once I did a
refactoring pass on the Markdown transformer, I was sure that I could clean that
algorithm up a lot.  But even without that refactoring, the changes in the algorithm
were easy to understand.</p>
<p>The root of the changes centered on the splitting on the whitespace in the newly
inserted <code>\x02</code> character.
Once that given line was split, there were 3 cases to handle.  The easy case
was the one where the <code>\x02</code> character was present, yielding an array with 2 entries.
In that case, the <code>ws_prefix_text</code> variable was set to the first element and the
<code>ws_suffix_text</code> variable was set to the second element.  The second case was where
there was only 1 element in the array and it was the very first entry in the array.  In
that case, the prefix whitespace had already been applied when the SetExt Heading token
was dealt with, therefore the whitespace was assigned to the <code>ws_suffix_text</code> variable.
Finally, in all other cases, that whitespace was good at the start of the line,
hence it was assigned to the <code>ws_prefix_text</code> variable.</p>
<p>Testing this algorithm endlessly in my head, I was pleased when I tested the algorithm
with the actual code and it almost worked.  The first iteration of this algorithm did
not include the properly handling of the second case, as detailed above.  As such,
the other lines were formatted properly, but that first line was still a bit off.
However, the good news is that it only took a little bit of debugging before I had that
cause identified and fixed.  And after 4 days, seeing all the tests pass for this
change was a sweet sight for my eyes!</p>
<h3 id="hindsight-is-always-clearer">Hindsight is Always Clearer<a class="headerlink" href="#hindsight-is-always-clearer" title="Permanent link">¶</a></h3>
<p>Looking back at the solution, the simplicity and correctness of it is even more
evident. Add an extra marker during the initial processing and interpret it during
the Markdown transformer processing just makes sense.  Looking back, the thing that
made the most sense was that the simplest solution was the one that one.  It was
as complex as it needed to be, and not more complex.</p>
<p>And after taking the time to add this support properly, I could only hope I would
have enough time to finish adding the support for the other tokens that I had planned
for.</p>
<h2 id="adding-emphasis-support">Adding Emphasis Support<a class="headerlink" href="#adding-emphasis-support" title="Permanent link">¶</a></h2>
<p>After the effort required to add the SetExt Heading transformation, I was hesitant to
start working on another token.  It was not a lack of confidence that was causing me to
pause for a bit, it was the work!  After taking 4 days to complete the SetExt Heading
token support, I was exhausted.  Also, by the time the code changes were committed,
I only had about 24 hours to complete the rest of the work!</p>
<p>After adding my initial attempt to perform a simple transformation of Emphasis tokens,
I was very pleased when I found out that my work for this token was almost complete. The
writing of that initial attempt used the information already present in the
token and was able to satisfy most of the tests in dealing with emphasis.  The only
tests
that had a problem were the tests that used the alternate emphasis character <code>_</code> and its
slightly altered emphasis rules.  When I originally added the <code>EmphasisMarkdownToken</code>
class, the HTML transformer did not need to know which character was used for emphasis,
only the level of emphasis in the <code>emphasis_length</code> field.  As such, any indication of
the emphasis character used was absent from the token.</p>
<p>To address that problem, I simply added the <code>emphasis_character</code> field to the
<code>EmphasisMarkdownToken</code> class.  This was followed up by some small changes in the
<code>__process_emphasis_pair</code> function to ensure that the new field was being properly
initialized in both the <code>EmphasisMarkdownToken</code> constructor and the emphasis block’s end
token constructor.  The change in the end token was a bit trickier in that it does not
have a specific place for the character, just a generic <code>extra_end_data</code> variable.
Those changes modified the code from:</p>
<div class="highlight"><pre><span></span>            <span class="n">EmphasisMarkdownToken</span><span class="p">(</span><span class="n">emphasis_length</span><span class="p">),</span>
<span class="o">...</span>
            <span class="n">MarkdownToken</span><span class="o">.</span><span class="n">token_inline_emphasis</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">emphasis_length</span><span class="p">),</span>
</pre></div>
<p>to:</p>
<div class="highlight"><pre><span></span>            <span class="n">EmphasisMarkdownToken</span><span class="p">(</span><span class="n">emphasis_length</span><span class="p">,</span> <span class="n">emphasis_character</span><span class="p">),</span>
<span class="o">...</span>
            <span class="n">MarkdownToken</span><span class="o">.</span><span class="n">token_inline_emphasis</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> \
                 <span class="nb">str</span><span class="p">(</span><span class="n">emphasis_length</span><span class="p">)</span> <span class="o">+</span> <span class="s2">":"</span> <span class="o">+</span> <span class="n">emphasis_character</span><span class="p">,</span>
</pre></div>
<p>These changes made sure that both the start of the emphasis block and the end of the
emphasis block had access to the emphasis character that had been used.  To accommodate
these changes, a trivial change was needed in the HTML transformer.  Once that was done,
I temporarily disabled the consistency checks and ran the full set of tests against
those changes.</p>
<p>Perhaps I am paranoid, but even with such a small change, I wanted to
run the full battery of GFM specification tests to ensure that those changes were solid
on their own before adding in more changes.  But with all those changes in place and
all tests passing, I then returned to the Markdown transformer.  Due to the above work,
the Markdown transfer was changed to be aware of the
emphasis character used.  Similar to the HTML transformer, the Markdown transformer
only required a few lines to be changed to accommodate the new versions of the tokens.
After that work was completed, the consistency checks were enabled, and I was glad to
find out that all emphasis tests were passing on the first try.  Compared to the last
element, this element was a breeze!</p>
<h2 id="adding-autolink-and-raw-html-support">Adding Autolink and Raw HTML Support<a class="headerlink" href="#adding-autolink-and-raw-html-support" title="Permanent link">¶</a></h2>
<p>Seemingly on a roll, the Autolink token support was added in 15 minutes and the raw HTML
token support was added in just over 10 minutes.  In both cases, the tokens contained
all the required information, allowing the transformation to be accomplished with very
simple functions.  The testing for these changes was likewise, quick, as the amount of
code that was changed was small.  As these changes took less than 30 minutes combined,
there really is not anything more to add.</p>
<h2 id="adding-code-span-support">Adding Code Span Support<a class="headerlink" href="#adding-code-span-support" title="Permanent link">¶</a></h2>
<p>Trivial, Hard, Decent, Trivial.  That was the effort that I required to add support for
the tokens documented in the last 4 sections.  Picking Code Spans by random out of the
group of remaining tokens, I was not
sure where the “Wheel of Effort” would land this time.  It turned out that adding
support for the code span tokens was a bit more difficult than adding support for the
Autolink token and the Raw HTML token, but it was not much more difficult.</p>
<h3 id="the-initial-attempt">The Initial Attempt<a class="headerlink" href="#the-initial-attempt" title="Permanent link">¶</a></h3>
<p>To add the support for the Code Span tokens, I first needed to change the constructor
for the
<code>InlineCodeSpanMarkdownToken</code> class to keep track of three additional fields:
<code>extracted_start_backticks</code>, <code>leading_whitespace</code>, and <code>trailing_whitespace</code>. While
those 3 fields were easy add to the token and populate with the right information,
their use in many of the scenario tests required small changes in each of those tests.
Even those changes were annoying, once they were out of the way, the changes to the
Markdown transformer to properly support the Code Span token were minimal.</p>
<p>After running the all the tests with the above changes implemented, everything looked
good except for a couple of tests.  When I looked at those tests more closely, in each
test the Markdown contained a code span with a newline
character in the middle of it.  While Code Span tokens keep everything within their
boundaries exactly as they are, including backslashes and character reference sequences,
newline characters are a separate matter.</p>
<h3 id="addressing-the-issue">Addressing the Issue<a class="headerlink" href="#addressing-the-issue" title="Permanent link">¶</a></h3>
<p>When a Code Span element has a newline character in it, that newline character gets
replaced with a single space character.  This introduced a bit of a problem for the
Markdown transformer, as the HTML transformer was expecting a space character and the
Markdown transformer was expecting a newline character.  Luckily, I was able to
repurpose some work I did a couple of weeks ago for
<a href="https://jackdewinter.github.io/2020/07/20/markdown-linter-transforming-back-to-markdown/#Handling-Character-References">character references</a>
in indented code blocks.
As I wanted to ensure that I represented both states of the code span data in the
tokens, I replaced the
newline characters with the text <code>\a\n\a \a</code> instead of replacing it with a single space
character.  At that point, depending on which viewpoint I was taking, I was able to know
both the before processing and after processing states of that character.</p>
<p>Going forward with those changes, I went to look at any errors with the HTML
transformer, but there were not any.  It turned out that the work I did on
<a href="https://github.com/jackdewinter/pymarkdown/commit/20b129ee1b2058b4495395251d25a8fafa88bfa3">16 Jul 2020</a>
included adding a call to the <code>resolve_references_from_text</code> function, then housed in
the <code>tranform_to_gfm.py</code> module.  To be honest, I was not aware that I did that, but it
was nice that it was already in place.  That just left the changes to the Markdown
transformer to resolve any replacement markers in that data.  And given the the
literal text string <code>\a\n\a \a</code>, that was a simple task.</p>
<p>Running the tests at each interval along the way, I was confident that I had made the
right changes.  But there is always that moment where I say to myself “did I remember
everything?”.  Fighting past that though, I ran the all the tests and was happy to
see that Code Spans were now being transformed properly.</p>
<h2 id="adding-fenced-code-block-support">Adding Fenced Code Block Support<a class="headerlink" href="#adding-fenced-code-block-support" title="Permanent link">¶</a></h2>
<p>Like the work done for the Code Span tokens, the Fenced Code Block tokens were
missing some information. In this case, that information was tied to both the
start token and the end token.  For the start token, the information was being
serialized properly, but I needed to add specific member variables for each of the
arguments being passed in.  This small change allowed me to use that information
in the transformers in subsequent steps.  For the end token, instead
of trying to add a lot of generic information to the token, I opted to add a new
member variable <code>start_markdown_token</code> to allow for a reference to the start token.  In
this way, I was able to easily reference the data of the start token without having to
duplicate information in a generic way in the end token.</p>
<p>When I started testing these changes, there were a couple of tests that were trickier
than the others to get working.  Debugging into those tests, I quickly found that the
whitespace removed from the start of lines within the fenced code block was causing
issues for the Markdown transformer.  Having faced a similar problem with the Code
Span tokens, I was quickly able to pivot and replace that removed whitespace with
a similar replaced sequence and a <code>noop</code> character.</p>
<p>Based on the work in dealing with Code Spans, if knew that if I needed to replace a
single newline character with a space character, I would replace the newline with the
sequence <code>\a\n\a \a</code>.  As there are boundary cases where replacements can be nested, I
did not
want to use the sequence <code>\a \a\a</code> to replace a removed space character.  Instead,
I used the <code>\x03</code> character to signal a character that did not mean anything, in effect
a
<a href="https://www.urbandictionary.com/define.php?term=noop">NOOP character</a>.
Thus, the replacement string became <code>\a \a\x03\a</code>.  After a few small fixes, everything
passed.</p>
<h2 id="adding-atx-heading-support">Adding Atx Heading Support<a class="headerlink" href="#adding-atx-heading-support" title="Permanent link">¶</a></h2>
<p>With the way the “Wheel of Effort” had been spinning for me during this chunk of work,
I had no
clue where the effort for this token would land on that metaphorical wheel.  On one
side, there were plenty of simple changes required to add support for many of the
tokens.  On the other side were the SetExt Heading tokens, which took days.  It was
with trepidation and caution that I started to work on the support for this token.</p>
<p>And it was within a couple of minutes of starting that I figured out this work was
destined for the the trivial category.  Piggybacking on the work documented in the last
section regarding the <code>start_markdown_token</code> field, the big change for the parser was
to set this field in the end token for the heading.  Seeing as the change was solely
additive, I jumped to the Markdown transformer, and added the handlers for both the
<code>AtxHeadingMarkdownToken</code> and its corresponding end token.  The handlers were both
simple, just regurgitating the token’s member variables back into a Markdown form.</p>
<p>Running the tests, I was pleased to see that most of the tests worked on the first
run.  The ones that did not caused me to look at the tests more closely.  It was there
that I realized that the only tests that were failing were tests with closing
Atx Heading characters.  Looking specifically at the code to handle those closing
characters, I discovered that I had transposed two variables, producing weird results
in the output.  Fixing that error, the tests ran without any issues.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>While I mentioned in the last article that I started to believe that I could see the
end of the project, it was this chunk of work that brought it into sharper focus for me.
In my mind, anyone can say that they can properly parse a Markdown document, but for me,
anything short of being able to empirically prove that the project can parser the
Markdown project properly is a failure.  For me, it is not about guesswork, it is
whether I can back up my claim with data.</p>
<p>The comparisons between the HTML parser output
and the HTML output from the GFM specification? They proved the project could get the
HTML right for those specific cases.  The comparisons between the line numbers and
column numbers from the parser’s tokens and the consistency check algorithms?  They
proved that the project could pinpoint the origin of any element in the original
Markdown document.  The consistency check using the Markdown transformer?  It proved
that the project could, with certainty, transform the Markdown document into an
intermediate form and then back again, with no loss of data.</p>
<p>From my point of view, each one of these checks was building on the work of the other,
providing solid, empirical proof that the parser had properly tokenized the document.
I understand that to some it may seem excessive.  But to me, this was just dotting
my Is and crossing my Ts.  I wanted to make a good first impression with this parser,
and I wanted to take steps to ensure that.</p>
<p>In addition, that new level of confidence spoke to me. The scenario tests were
effective.  The consistency checks were working.  And in my mind, the project was
clearly past the half-way point on its journey to the finish line!  It was all
starting to come together.</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>As mentioned above, Link transformations were next on the list of Markdown
transformations to add.  Given the work documented in this article, I was sure that
I would run into at least a couple of issues.  It was just a question of how much
effort it would take for me to push through it!</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Improving%20the%20Markdown%20Transformer&url=https%3A//jackdewinter.github.io/2020/08/03/markdown-linter-improving-the-markdown-transformer/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2020/08/03/markdown-linter-improving-the-markdown-transformer/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Improving%20the%20Markdown%20Transformer&amp;body=https%3A//jackdewinter.github.io/2020/08/03/markdown-linter-improving-the-markdown-transformer/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2020/08/03/markdown-linter-improving-the-markdown-transformer/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-improving-the-markdown-transformer"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2020/07/27/markdown-linter-addressing-the-initial-markdown-transformer-issues/" title="Previous: Markdown Linter - Addressing the Initial Markdown Transformer Issues">Markdown Linter - Addressing the Initial Markdown Transformer Issues</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2020/08/10/markdown-linter-adding-links-to-the-markdown-transformer/" title="Next: Markdown Linter - Adding Links to the Markdown Transformer">Markdown Linter - Adding Links to the Markdown Transformer</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~18 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2020-08-03T00:00:00-07:00">Aug 3, 2020</time>
        <h4>Markdown Linter Core</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2020/05/04/markdown-linter-core-pre-rule-improvements/" title="Markdown Linter - Core - Pre-Rule Improvements">Part 1: Markdown Linter - Core - Pre-Rule Improvements</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/06/01/markdown-linter-taking-time-to-evaluate/" title="Markdown Linter - Taking Time To Evaluate">Part 2: Markdown Linter - Taking Time To Evaluate</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/06/08/markdown-linter-adding-line-and-column-support/" title="Markdown Linter - Adding Line and Column Support">Part 3: Markdown Linter - Adding Line and Column Support</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/06/15/markdown-linter-rabbit-hole-1-adding-consistency-checks/" title="Markdown Linter - Rabbit Hole 1 - Adding Consistency Checks">Part 4: Markdown Linter - Rabbit Hole 1 - Adding Consistency Checks</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/06/22/markdown-linter-rabbit-hole-2-losing-my-way/" title="Markdown Linter - Rabbit Hole 2 - Losing My Way">Part 5: Markdown Linter - Rabbit Hole 2 - Losing My Way</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/07/06/markdown-linter-weeding-the-projects-issue-list/" title="Markdown Linter - Weeding the Project's Issue List">Part 6: Markdown Linter - Weeding the Project's Issue List</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/06/29/markdown-linter-rabbit-hole-3-trying-to-dig-myself-out/" title="Markdown Linter - Rabbit Hole 3 - Trying To Dig Myself Out">Part 7: Markdown Linter - Rabbit Hole 3 - Trying To Dig Myself Out</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/07/13/markdown-linter-improving-consistency/" title="Markdown Linter - Improving Consistency">Part 8: Markdown Linter - Improving Consistency</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/07/20/markdown-linter-transforming-back-to-markdown/" title="Markdown Linter - Transforming Back to Markdown">Part 9: Markdown Linter - Transforming Back to Markdown</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/07/27/markdown-linter-addressing-the-initial-markdown-transformer-issues/" title="Markdown Linter - Addressing the Initial Markdown Transformer Issues">Part 10: Markdown Linter - Addressing the Initial Markdown Transformer Issues</a>
            </li>
            <li  class="active-part">
            Part 11: Markdown Linter - Improving the Markdown Transformer
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/08/10/markdown-linter-adding-links-to-the-markdown-transformer/" title="Markdown Linter - Adding Links to the Markdown Transformer">Part 12: Markdown Linter - Adding Links to the Markdown Transformer</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/08/17/markdown-linter-adding-lists-to-the-markdown-transformer/" title="Markdown Linter - Adding Lists to the Markdown Transformer">Part 13: Markdown Linter - Adding Lists to the Markdown Transformer</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/08/25/markdown-linter-adding-consistency-to-block-quotes/" title="Markdown Linter - Adding Consistency to Block Quotes">Part 14: Markdown Linter - Adding Consistency to Block Quotes</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/08/31/markdown-linter-adding-consistency-to-token-heights/" title="Markdown Linter - Adding Consistency to Token Heights">Part 15: Markdown Linter - Adding Consistency to Token Heights</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/09/07/markdown-linter-starting-to-add-linecolumn-numbers-for-inline-tokens/" title="Markdown Linter - Starting to Add Line/Column Numbers For Inline Tokens">Part 16: Markdown Linter - Starting to Add Line/Column Numbers For Inline Tokens</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/09/14/markdown-linter-adding-consistency-checks-for-emphasis-and-text-tokens/" title="Markdown Linter - Adding Consistency Checks for Emphasis and Text Tokens">Part 17: Markdown Linter - Adding Consistency Checks for Emphasis and Text Tokens</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/09/21/markdown-linter-adding-remaining-inline-tokens/" title="Markdown Linter - Adding Remaining Inline Tokens">Part 18: Markdown Linter - Adding Remaining Inline Tokens</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>42</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>60</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2020 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>