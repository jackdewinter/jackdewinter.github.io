<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I started to add extra scenario tests that tested newline characters in various groups or themes. In this article, I continue working towards having a good level of group coverage for each of those groups. Introduction¶ There are times during the development of a project …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Delving Into the Issues - 4 "/>
<meta property="og:url" content="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" />
<meta property="og:description" content="Summary¶ In my last article, I started to add extra scenario tests that tested newline characters in various groups or themes. In this article, I continue working towards having a good level of group coverage for each of those groups. Introduction¶ There are times during the development of a project …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2020-10-19T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Delving Into the Issues - 4 ">
<meta name="twitter:description" content="Summary¶ In my last article, I started to add extra scenario tests that tested newline characters in various groups or themes. In this article, I continue working towards having a good level of group coverage for each of those groups. Introduction¶ There are times during the development of a project …">

        <title>Markdown Linter - Delving Into the Issues - 4  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/">
                Markdown Linter - Delving Into the Issues - 4
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#cleaning-up-after-last-week">Cleaning Up After Last Week</a><ul>
<li><a href="#doing-the-research">Doing the Research</a></li>
<li><a href="#fixing-the-issues">Fixing the Issues</a></li>
</ul>
</li>
<li><a href="#rounding-out-image-support">Rounding Out Image Support</a><ul>
<li><a href="#adding-the-tests">Adding The Tests</a></li>
<li><a href="#reviewing-collapsed-and-shortcut-images">Reviewing Collapsed and Shortcut Images</a></li>
<li><a href="#why-review-this">Why Review This?</a></li>
</ul>
</li>
<li><a href="#debugging-the-alt-attribute">Debugging The Alt Attribute</a><ul>
<li><a href="#fixing-the-issue">Fixing The Issue</a></li>
<li><a href="#circular-references-suck">Circular References Suck!</a></li>
<li><a href="#rounding-the-corner">Rounding The Corner</a></li>
</ul>
</li>
<li><a href="#duplicating-tests-without-duplicating-effort">Duplicating Tests Without Duplicating Effort</a></li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/">last article</a>, I started to add extra
scenario tests that tested newline characters in various groups or themes.  In this
article, I continue working towards having a good level of group coverage for each of
those groups.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>There are times during the development of a project where the tasks are all feature
related, and then there are times where the tasks are all issue related.  Instead of
waiting for that second era to arrive, I instead elected to proactively invest extra
time in trying to improve the scenario tests.  While I know I will not find every
issue, I want to make sure I do my best to throw as many combinations of elements
against the wall, hoping none of those combinations will stick.<sup id="fnref:spaghetti"><a class="footnote-ref" href="#fn:spaghetti">1</a></sup></p>
<p>From my viewpoint, I am aware that this focus on quality is taking time and effort
away from adding new rules to PyMarkdown.  However, in my eyes, every minute spent on
making sure the project is stable is worth it.  Even with the knowledge that I will
not catch every issue before it happens, I am confident that by being proactive and
adding groups of tests, I will put the project in a great position to be a stable
platform for linting Markdown documents.  Even better, by focusing on groups of
combinations instead of individual tests, I believe I can discover a large group
of issues at the current stage, instead of in a bug report later.  At the very least,
that is my hope, and my confidence is increasing with each group I add.</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits
<a href="https://github.com/jackdewinter/pymarkdown/commit/a506ddd3bda08a8ca1d97a7b0d68c114325b545e">02 Oct 2020</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/953ed1b4afdc40353995dd7b1dcd41e7a306effc">04 Oct 2020</a>.</p>
<h2 id="cleaning-up-after-last-week">Cleaning Up After Last Week<a class="headerlink" href="#cleaning-up-after-last-week" title="Permanent link">¶</a></h2>
<p>As the work I documented last week ran into the overtime territory, I decided at that
time to disable those tests, with promises to work on them next week.  As this is the
next article, this is the next week.  Time to get to work!</p>
<p>With very few exceptions, the results of each scenario test have been checked at
least three times.  As such, I was very confident that I needed to update the
consistency checks to deal with these changes, and not the results. As an ancillary
task, since the code to calculate the line/column number was just introduced, I knew
that there was a decent chance that I might find an issue or two that would need to be
fixed.  As the consistency checks were not passing, I was hoping that it was the
checks that needed updating but prepared for changes in the parser itself.  Only
research would tell, so it was on to more research!</p>
<h3 id="doing-the-research">Doing the Research<a class="headerlink" href="#doing-the-research" title="Permanent link">¶</a></h3>
<p>Digging into the code for links, it seemed obvious that the issue was with the links
and their column numbers was something simple.  As I scanned more code, my confidence
that it was something simple just increased.  All the big pieces of code looked
fine, but one thing was sticking out: replacements.  Back when I was adding the
Markdown transformer, I made sure that both the HTML-friendly and Markdown-friendly
versions of the token’s text were included in the Link Token.  However, when I added
the code to handle this into the consistency checks, I got confused.</p>
<p>Part of this is my own fault, but the reason I was confused was due to the duality
that exists in the tokens and the project.  In inline text situations, replacement
sequences are used to show both the <em>before</em> and <em>after</em> parts of the replacement.
In link situations, a similar pattern is used, including both parts of the replacement
in the token.  However, in the link case, there are a couple of added wrinkles.</p>
<p>The first wrinkle is that there are usually 2 different fields of the Link token
that contain this information. Using the <code>link_title</code> field as an example, the processed
version is stored in that field, while the raw text used to generate that field is
kept in the <code>pre_link_title</code> field.  To avoid useless duplication of fields, the
<code>pre_</code> version of the field is only used if they have a different value that their
processed field.  That is the second wrinkle.  In processing that Link token
information, it is common to see code likeL</p>
<div class="highlight"><pre><span></span>    <span class="n">link_title</span> <span class="o">=</span> <span class="n">parent_cur_token</span><span class="o">.</span><span class="n">link_title</span>
    <span class="k">if</span> <span class="n">parent_cur_token</span><span class="o">.</span><span class="n">pre_link_title</span><span class="p">:</span>
        <span class="n">link_title</span> <span class="o">=</span> <span class="n">parent_cur_token</span><span class="o">.</span><span class="n">pre_link_title</span>
</pre></div>
<p>Basically, set the <code>link_title</code> variable to the token’s <code>link_title</code> field by default.
But if the <code>pre_link_title</code> field is set, use that instead.</p>
<p>Given that there are two different access patterns, sometimes I can get confused and
use a process for dealing with the other access pattern.  And that is where the third
wrinkle shows up: dealing with link labels.  In the case of link labels, the processed
version of the text exists between the start Link token and the end Link token, with
the raw version being kept in the start Link token’s <code>text_from_blocks</code> field.</p>
<p>And to be honest, while it does make sense in how each of the 3 use cases are used in
practice, remembering which one is in play when I am writing code on a given field
can be difficult.</p>
<h3 id="fixing-the-issues">Fixing the Issues<a class="headerlink" href="#fixing-the-issues" title="Permanent link">¶</a></h3>
<p>Hopefully there is enough information in the previous section to allow for this
revelation
to be easy to see in advance: I used the wrong pattern in one place and the wrong
field in another place.  While the fix was just a couple of lines of code in the
newly refactored <code>__verify_next_inline_inline_image_inline</code> function, it took some
debugging to properly address the issue by using the correct patterns.  With both
patterns adjusted, most of the tests were passing.</p>
<p>It was in those remaining failures that I noticed that another problem that was hiding
behind that problem:
character references were not updating the column number.  With all the confusion
of the other problem out of the way, there were a couple of outlier tests dealing
with character entities that were not adding any space for the Code Span tokens.
That was fixed by adding the following code to the end of the
<code>handle_character_reference</code> function:</p>
<div class="highlight"><pre><span></span>        <span class="n">inline_response</span><span class="o">.</span><span class="n">delta_line_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">inline_response</span><span class="o">.</span><span class="n">delta_column_number</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">inline_response</span><span class="o">.</span><span class="n">new_index</span> <span class="o">-</span> <span class="n">inline_request</span><span class="o">.</span><span class="n">next_index</span>
        <span class="p">)</span>
</pre></div>
<p>Once again, it was obvious that something needed to be done once I started looking
at the function itself, but without something causing me to look there, it was
overlooked.  I was just grateful that the extra scenario tests pointed this out!</p>
<h2 id="rounding-out-image-support">Rounding Out Image Support<a class="headerlink" href="#rounding-out-image-support" title="Permanent link">¶</a></h2>
<p>While the support for images and their line/column numbers was added a long time ago,
the proper validation support in the consistency checks was only recently added.  In
addition, while previous work tested the inline image support, there was very little
testing of the shortcut and compressed image types, and no testing of the full image
type.</p>
<h3 id="adding-the-tests">Adding The Tests<a class="headerlink" href="#adding-the-tests" title="Permanent link">¶</a></h3>
<p>The testing part of this support was easy to address.  As part of finishing the work
from the previous
week, I copied over tests <code>test_paragraph_extra_78</code> to <code>test_paragraph_extra_89</code>, renaming them <code>test_paragraph_extra_90</code> to <code>test_paragraph_extra_a2</code>.  Once that was
done, I changed the example text from the link start sequence <code>[</code> to the image start
sequence <code>![</code>.  Temporarily disabling the consistency checks, I then ran through
each of the scenario tests, adjusting the token output and the HTML output for the
change from a Link token to an Image token.  From the token point of view, I was
primarily looking for the Image token to take the place of the start Link token.  In
addition, I was checking to ensure that any tokens after the start Link token but before
(and including) the end Link token were removed.  Finally, I adjusted the HTML for the
scenario from an HTML anchor tag to an HTML image tag, along with any tag attribute
changes that were required.</p>
<p>At this point, it should go without saying that as I was making those changes, I ran
through the token output and the HTML output multiple times.  I did these checks both
mentally and my tried and true method of “counting out loud”, verifying that both values
were the same. As I knew the next task was to properly implement the consistency checks
for the other image types, I also knew that an extra count or two would take less time
than trying to debug any off-by-one issues with any of the line/column numbers.  It just
made sense to take an extra minute per test and do that extra level of verification.</p>
<h3 id="reviewing-collapsed-and-shortcut-images">Reviewing Collapsed and Shortcut Images<a class="headerlink" href="#reviewing-collapsed-and-shortcut-images" title="Permanent link">¶</a></h3>
<p>Containing only a link label, the shortcut and collapsed image types had already been
coded into the consistency check.  From a quick visual inspection, they both made
sense and looked great:</p>
<div class="highlight"><pre><span></span>    <span class="k">elif</span> <span class="n">previous_inline_token</span><span class="o">.</span><span class="n">label_type</span> <span class="o">==</span> <span class="s2">"collapsed"</span><span class="p">:</span>
        <span class="n">image_alt_text</span> <span class="o">=</span> <span class="n">previous_inline_token</span><span class="o">.</span><span class="n">image_alt_text</span>
        <span class="k">if</span> <span class="n">previous_inline_token</span><span class="o">.</span><span class="n">text_from_blocks</span><span class="p">:</span>
            <span class="n">image_alt_text</span> <span class="o">=</span> <span class="n">previous_inline_token</span><span class="o">.</span><span class="n">text_from_blocks</span>

        <span class="n">token_prefix</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">newline_count</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">count_newlines_in_text</span><span class="p">(</span><span class="n">image_alt_text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">newline_count</span><span class="p">:</span>
            <span class="n">estimated_line_number</span> <span class="o">+=</span> <span class="n">newline_count</span>
            <span class="n">para_owner</span><span class="o">.</span><span class="n">rehydrate_index</span> <span class="o">+=</span> <span class="n">newline_count</span>
            <span class="n">estimated_column_number</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">split_label_text</span> <span class="o">=</span> <span class="n">image_alt_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">image_alt_text</span> <span class="o">=</span> <span class="n">split_label_text</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">token_prefix</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">estimated_column_number</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="n">estimated_column_number</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">token_prefix</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_alt_text</span><span class="p">)</span>
</pre></div>
<p>Using the collapsed link type as an example, the algorithm was really easy to code up.
A Markdown collapsed link type looks like this: <code>[reference][]</code>.  To start with, the
code to determine the content of the link label is used, as was mentioned in the
previous sections.  With that information in hand, the <code>token_prefix</code> was set to <code>1</code> to
account for the opening <code>[</code>, before proceeding to deal with any newlines.  Dealing
with the newlines used the same pattern that I used for each part of the inline image
type.  However, the big change here is that the <code>token_prefix</code> is set to <code>0</code> if a
newline character is found.  The rationale behind this is that if there any newlines
in the link label, the length of the opening <code>[</code> is no longer useful in determining
the column number, as it comes before the part that has a newline character in it.</p>
<p>With all that preparation in place, it is then time to compute the change in the
column number.  The initial <code>estimated_column_number += 2</code> takes care of the
<code>[]</code> characters at the end of the image text.  The <code>2</code> from the first part of the
following statement combines a <code>+1</code> for the translation from an index into a position
and a <code>+1</code> for the <code>]</code> character after the link label.  The <code>token_prefix</code> variable
is then added to account for the length of the opening <code>[</code> label, as described above,
followed by adding the length of the raw version of the link label text.</p>
<h3 id="why-review-this">Why Review This?<a class="headerlink" href="#why-review-this" title="Permanent link">¶</a></h3>
<p>It may seem weird that I reviewed this before going forward but let me explain.
I reviewed both because I knew that I had plans to use either the shortcut
code or the collapsed code as a template for the full image type.  I knew that the
only difference in the code between those two types was the addition of a link
reference.  To me, it just made sense to start with the code for either of those image
types and just add the extra code to handle the link reference.</p>
<p>Following that plan to reuse that code, the support for the full image types was
added within a couple of hours.  After making sure the consistency checks were enabled,
I started running the newly added scenario tests against the newly added consistency
check code.  It was then that I started noticing some weird failures.</p>
<h2 id="debugging-the-alt-attribute">Debugging The Alt Attribute<a class="headerlink" href="#debugging-the-alt-attribute" title="Permanent link">¶</a></h2>
<p>Digging into those failures, it was initially hard for me to figure out what the issue
was.  Everything looked fine until I started doing a character by character mental
reconstruction of the tokens from the Markdown.  It was then that I saw it:  the <code>alt</code>
attributes on a handful of the image tags were wrong.</p>
<p>The scenario test function <code>test_paragraph_extra_73</code> is a great example of that.  With
the Markdown text:</p>
<div class="highlight"><pre><span></span><span class="n">a</span><span class="o">!</span><span class="p">[</span><span class="n">Fo</span><span class="o">&amp;</span><span class="n">beta</span><span class="p">;</span><span class="n">o</span><span class="p">](</span><span class="o">/</span><span class="n">uri</span> <span class="ss">"testing"</span><span class="p">)</span><span class="n">a</span>
</pre></div>
<p>and a simple knowledge of Markdown, the text assigned to the <code>alt</code> attribute of the
HTML image tag was obvious to me.  It should be <code>Foβo</code>.  But when I looked at the
token itself, that token was:</p>
<div class="highlight"><pre><span></span>[image(1,2):inline:/uri:testing:Foo::::Foo:False:":: :]
</pre></div>
<p>That was close, but I was expecting a token that was more like:</p>
<div class="highlight"><pre><span></span>[image(1,2):inline:/uri:testing:Foβo::::Fo&amp;beta;o:False:":: :]
</pre></div>
<p>which contained both the processed version of the text <code>Foβo</code> and the unprocessed
version of the text <code>Fo&amp;beta;o</code>.  This was not like some previous issues that I had
already resolved where one of the other inline tokens was not being represented
properly.  This was a case of some very simple replacements needing to take place
but being missed.</p>
<p>In addition, after looking at some other cases, backslash escape sequences
were also causing issues, though usually hidden.  Function <code>test_paragraph_extra_74</code>
is a good example where the output HTML was correct, but the tokenization contained an
<code>o</code> for the processed text instead of <code>Fo]o</code>.  </p>
<h3 id="fixing-the-issue">Fixing The Issue<a class="headerlink" href="#fixing-the-issue" title="Permanent link">¶</a></h3>
<p>To get around this issue, I was faced with three different choices.  The first choice
was to code something up specific to this issue.  I immediately rejected that approach
as I felt that one of the extensions that I will need to support in the future may have
to introduce some base level of character manipulation like the character entities.  As
such, I wanted to leave my options open.</p>
<p>That left the other two options, or rather one option with two variations.  In
either case, I already had a mechanism for registering inline handling and using those
handlers.  As such, my second choice was to use the existing inline processor code for
text blocks.  The issue that I had with that approach was that I would need to pass an
additional flag into that function that would limit its use to only the backslash
escapes and the character entities.  While that may have been possible with a smaller
function, the size and complexity of the <code>__process_inline_text_block</code> function gave me
have concerns about possible side effects.</p>
<p>From three choices down to one, I went with a simplified processor approach to the
<code>__process_inline_text_block</code> function.  When
the handlers register themselves, I added a new flag to denote whether the
handler was for
one of the two simple inline sequences.  If it was, I added the text sequence to
the <code>__valid_inline_simple_text_block_sequence_starts</code>.  Then, in the imaginatively
named <code>process_simple_inline</code> function, I added the code for a very pared down
version of the <code>__process_inline_text_block</code> function.  This function was purposefully
crafted to
only handle those simple inline sequences and the newline character, nothing else.</p>
<p>It was when I went to wire the function up that I found another interesting surprise
waiting for me.</p>
<h3 id="circular-references-suck">Circular References Suck!<a class="headerlink" href="#circular-references-suck" title="Permanent link">¶</a></h3>
<p>With a decent first attempt at a simplified inline processor in place, I did as I
normally do and went to the place where I needed the function, the
<code>__consume_text_for_image_alt_text</code> function in the <code>LinkHelper</code> module, and added
the reference and the import to go along with it.  After starting the test executing,
there was a long pause, and I was then greeted with a simple error telling me:</p>
<div class="highlight"><pre><span></span>E   ImportError: cannot import name 'LinkHelper' from 'pymarkdown.link_helper'
    (C:\old\enlistments\pymarkdown\pymarkdown\link_helper.py)
</pre></div>
<p>Having hit these a number of times, I was sure it was a circular import reference,
but where was it?  It was then that I thought about it.  The <code>LinkHelper</code> module
was already imported from the <code>InlineProcessor</code> module, as I used it to handle
all the heavy lifting with the links.  As Python does not have any concept of
forward references, all referenced classes or functions must be loaded before
a reference is made to that item.  In this case, with the relationship already
established, I could not add the reference in the other direction.  I needed to find
another solution.</p>
<p>I was sure that I would be able to come up with a more elegant solution at a later
time, but I wanted to finish this task up, so I took the <em>lazy</em> approach of passing
the function as an object.  As it was passed as an argument to each function, there
was no restriction imposed and I was able to use that method at the target
<code>__consume_text_for_image_alt_text</code> function.  I may want to look at a better way
to do that in the future, but at the time, it worked.</p>
<h3 id="rounding-the-corner">Rounding The Corner<a class="headerlink" href="#rounding-the-corner" title="Permanent link">¶</a></h3>
<p>At that point, all the scenario tests were passing.  I was sure that there were
other scenarios that I could find and test, but I was confident that I had a good
collection of paragraph tests added to the project.  I knew in future weeks I would
need to expand that collection in size and cover the SetExt Headings, but that could
come later.</p>
<h2 id="duplicating-tests-without-duplicating-effort">Duplicating Tests Without Duplicating Effort<a class="headerlink" href="#duplicating-tests-without-duplicating-effort" title="Permanent link">¶</a></h2>
<p>With those scenario tests completed for links and images contained within paragraphs,
it was time to extend those tests to including inline processing within SetExt Heading
tokens.  To that extent, I copied over <code>test_paragraph_extra_43</code> to
<code>test_paragraph_extra_a2</code>, creating tests <code>test_setext_headings_extra_43</code> to
<code>test_setext_headings_extra_a2</code>.  In terms of the Markdown documents for each test,
the only change I made was to add <code>---</code> after the Markdown being tested, transforming
it from a Paragraph token test to a SetExt Heading token test.</p>
<p>As I expected, there were some issues that I needed to resolve to get those tests
working.  As the original versions of the tests used Paragraph Tokens, and the handling
of those Paragraph tokens relied on the <code>rehydrate_index</code> field of the Paragraph
token, that was an obvious change that needed to be made.  To be specific, I needed
to add code to each reference of the <code>rehydrate_index</code> field to only reference that
field if the Paragraph token was the container for the inline text.  For the consistency
check and the Inline Processor, this meant protecting any use of the <code>para_owner</code>
variable, and the <code>owning_paragraph_token</code> variable for the Markdown transformer.</p>
<p>With that change made, the only other thing that needed to be dealt with is the change
in how the leading whitespaces are handled within a Paragraph token and within a
SetExt Heading token.  To allow better processing of paragraphs, the Paragraph token
collects any leading whitespace in the Paragraph token, whereas the processing of
inline tokens within the SetExt Heading token stores that information with the inline
tokens themselves.  That handling was changed to ensure the information was properly
being mined from each inline token.</p>
<p>And while it probably took a couple of hours to resolve, it felt like these changes
only took a couple of minutes.  Compared to some of the other changes I have done
in the last couple of weeks, these changes were completed quickly.  I am sure that
there were a couple of issues in the code that I needed to fix, but as I said, the
time just flew by.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>In the introduction, I mentioned my increase in confidence for the project, mostly due
to my switch from individual scenario tests to scenario test groups.  From a work
point of view, instead of many small issues, I am lucky if I can get 2 to 3 medium
or large sized issues done in a week.  But as I am covering many combinations in one
task, I feel that the benefit easily outweighs the cost.  And
that benefit is what helps me drive forward.</p>
<p>And especially with today’s climate, I find that I sometimes need some help in
maintaining focus on this project and driving it forward.  At times like that, when
I need some extra focus, I find it is good to think about the positive parts of the
project.  Instead of focusing on what is left to do, I focus on the progress I have
made in getting to this point.  Instead of focusing on the quantity of tasks I can
get done in a week, I focus on the quality that those tasks being to the project.
And most importantly, instead of focusing on what I cannot change around me, I choose
to focus on this PyMarkdown project, and the benefits I can provide to Markdown
authors with this project.</p>
<p>So, as I move forward with the project, focusing on quality, I choose these areas
to focus on.</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>Staying with the theme of testing blocks, I tackle another couple of testing blocks
in the next article.</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:spaghetti">
<p><a href="http://www.english-for-students.com/Spaghetti.html#:~:text=Alternative%3A%20Throwing%20spaghetti%20on%20the%20wall%20is%20how,to%20the%20walls%20too%21%20Thanks%20to%20Tarean%20West">Throwing Spaghetti</a>. <a class="footnote-backref" href="#fnref:spaghetti" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%204&url=https%3A//jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%204&amp;body=https%3A//jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-delving-into-the-issues-4"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/" title="Previous: Markdown Linter - Delving Into the Issues - 3">Markdown Linter - Delving Into the Issues - 3</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2020/10/26/markdown-linter-delving-into-the-issues-5/" title="Next: Markdown Linter - Delving Into the Issues - 5">Markdown Linter - Delving Into the Issues - 5</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~14 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2020-10-19T00:00:00-07:00">Oct 19, 2020</time>
        <h4>Markdown Linter Issues</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2020/09/28/markdown-linter-delving-into-the-issues-1/" title="Markdown Linter - Delving Into the Issues - 1">Part 1: Markdown Linter - Delving Into the Issues - 1</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/05/markdown-linter-delving-into-the-issues-2/" title="Markdown Linter - Delving Into the Issues - 2">Part 2: Markdown Linter - Delving Into the Issues - 2</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/" title="Markdown Linter - Delving Into the Issues - 3">Part 3: Markdown Linter - Delving Into the Issues - 3</a>
            </li>
            <li  class="active-part">
            Part 4: Markdown Linter - Delving Into the Issues - 4
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/26/markdown-linter-delving-into-the-issues-5/" title="Markdown Linter - Delving Into the Issues - 5">Part 5: Markdown Linter - Delving Into the Issues - 5</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/" title="Markdown Linter - Delving Into the Issues - 6">Part 6: Markdown Linter - Delving Into the Issues - 6</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" title="Markdown Linter - Delving Into the Issues - 7">Part 7: Markdown Linter - Delving Into the Issues - 7</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/" title="Markdown Linter - Delving Into the Issues - 8">Part 8: Markdown Linter - Delving Into the Issues - 8</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" title="Markdown Linter - Delving Into the Issues - 9">Part 9: Markdown Linter - Delving Into the Issues - 9</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/30/markdown-linter-delving-into-the-issues-10/" title="Markdown Linter - Delving Into the Issues - 10">Part 10: Markdown Linter - Delving Into the Issues - 10</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/" title="Markdown Linter - Delving Into the Issues - 11">Part 11: Markdown Linter - Delving Into the Issues - 11</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" title="Markdown Linter - Delving Into the Issues - 12">Part 12: Markdown Linter - Delving Into the Issues - 12</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" title="Markdown Linter - Delving Into the Issues - 13">Part 13: Markdown Linter - Delving Into the Issues - 13</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/28/markdown-linter-delving-into-the-issues-14/" title="Markdown Linter - Delving Into the Issues - 14">Part 14: Markdown Linter - Delving Into the Issues - 14</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/04/markdown-linter-delving-into-the-issues-15/" title="Markdown Linter - Delving Into the Issues - 15">Part 15: Markdown Linter - Delving Into the Issues - 15</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/11/markdown-linter-delving-into-the-issues-16/" title="Markdown Linter - Delving Into the Issues - 16">Part 16: Markdown Linter - Delving Into the Issues - 16</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/" title="Markdown Linter - Delving Into the Issues - 17">Part 17: Markdown Linter - Delving Into the Issues - 17</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" title="Markdown Linter - Delving Into the Issues - 18">Part 18: Markdown Linter - Delving Into the Issues - 18</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/01/markdown-linter-delving-into-the-issues-19/" title="Markdown Linter - Delving Into the Issues - 19">Part 19: Markdown Linter - Delving Into the Issues - 19</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>41</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>59</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2020 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>