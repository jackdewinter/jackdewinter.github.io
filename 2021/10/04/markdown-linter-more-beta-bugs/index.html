<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I talked about getting to work on reducing the count of bugs in the Issues List. In this article, I talk about the headway I am making towards getting those issues dealt with. Introduction¶ Issues, issues, issues. Bugs, bugs, bugs. Problems, problems, problems. No matter …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - More Beta Bugs "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/10/04/markdown-linter-more-beta-bugs/" />
<meta property="og:description" content="Summary¶ In my last article, I talked about getting to work on reducing the count of bugs in the Issues List. In this article, I talk about the headway I am making towards getting those issues dealt with. Introduction¶ Issues, issues, issues. Bugs, bugs, bugs. Problems, problems, problems. No matter …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-10-04T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - More Beta Bugs ">
<meta name="twitter:description" content="Summary¶ In my last article, I talked about getting to work on reducing the count of bugs in the Issues List. In this article, I talk about the headway I am making towards getting those issues dealt with. Introduction¶ Issues, issues, issues. Bugs, bugs, bugs. Problems, problems, problems. No matter …">

        <title>Markdown Linter - More Beta Bugs  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/10/04/markdown-linter-more-beta-bugs/">
                Markdown Linter - More Beta Bugs
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#issue-34-getting-things-to-line-up">Issue 34 - Getting Things To Line Up</a><ul>
<li><a href="#digging-into-the-debug">Digging Into The Debug</a></li>
</ul>
</li>
<li><a href="#issue-36-verifying-disabled-rules">Issue 36 - Verifying Disabled Rules</a></li>
<li><a href="#issue-37-verifying-lists-and-blank-lines">Issue 37 - Verifying Lists and Blank Lines</a></li>
<li><a href="#issue-38-false-positive">Issue 38 - False Positive</a></li>
<li><a href="#issue-39-fun-with-nested-containers">Issue 39 - Fun with Nested Containers</a></li>
<li><a href="#issue-40-images-as-headings">Issue 40 - Images as Headings</a></li>
<li><a href="#issues-41-cleaning-up-documentation">Issues 41 - Cleaning Up Documentation</a></li>
<li><a href="#issue-42-sorted-output">Issue 42 - Sorted Output</a></li>
<li><a href="#issue-31-adding-module-support">Issue 31 - Adding Module Support</a></li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="{filename}/articles/SoftwareQuality/beta-bugs-a.md">last article</a>, I talked
about getting to work on reducing the count of bugs in the Issues List. In
this article, I talk about the headway I am making towards getting those
issues dealt with.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Issues, issues, issues.  Bugs, bugs, bugs.   Problems, problems, problems.
No matter which way I talk about it, it means the same thing to me.  With the beta
release out the door, it is time for me to try and battle the issues on the Issues
List.  I know I need to either resolve them as already fixed or to fix them there
and then.  I just need to keep on making good progress on fixing things.</p>
<p>That and I hope that I do not find any “must rearchitect” issues.  That would
be… well… expensive and time consuming.  Fingers crossed!</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please consult the commits that occurred between
<a href="https://github.com/jackdewinter/pymarkdown/commit/5f14d073b6a526fde77cbb88292e6639185340b5">26 Sep 2021</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/86f974d15dc6eff1602a3fd88f8eeac41de15f9a">03 Oct 2021</a>.</p>
<h2 id="issue-34-getting-things-to-line-up"><a href="https://github.com/jackdewinter/pymarkdown/issues/34">Issue 34</a> - Getting Things To Line Up<a class="headerlink" href="#issue-34-getting-things-to-line-up" title="Permanent link">¶</a></h2>
<p>This issue was recorded simply as a Markdown document:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">this</span> <span class="k">is</span> <span class="nb">text</span>
<span class="o">&gt;</span> <span class="p">[</span><span class="n">a</span> <span class="k">not</span>
<span class="o">&gt;</span>  <span class="n">so</span>
<span class="o">&gt;</span>  <span class="k">simple</span><span class="p">](</span><span class="o">/</span><span class="n">link</span>
<span class="o">&gt;</span> <span class="ss">"a</span>
<span class="ss">&gt;  title"</span>
<span class="o">&gt;</span>  <span class="p">)</span>
<span class="o">&gt;</span> <span class="n">a</span> <span class="nb">real</span> <span class="n">test</span>
</pre></div>
<p>The note itself was not that helpful, but once I parsed the document into
its tokens and looked at them, I noticed the problem right away:  the tokens
were not there.  Looking more closely at the output, an exception occurred
that stopped the document from being parsed.</p>
<p>Enabling the <code>--stack-trace</code> command line option, I quickly found that
within a loop in the <code>correct_for_leaf_block_start_in_list</code> function, an assert
statement was present to ensure that the loop only worked on lists.  It
was that assert statement that was failing, causing the parsing to be stopped.
I started to address the issue by adding code to only continue the loop
if the last item on the <code>token_stack</code> list was a list.  Also adding
code to conditional cleanup after the loop based on the same condition,
I was ready to see how this document would parse.</p>
<p>Feeling a bit anxious, I reran the test, hoping that everything would
work.  It initially looked like everything was going to work properly.
But when I looked at the tokens, something was wrong.  It looked like
most of the tokens were correct, but there were tokens that were slightly
off.  For the most part, the data was correct, but the position of the
tokens was a bit off.</p>
<p>This was going to be a more complicated issue to work through.</p>
<h3 id="digging-into-the-debug">Digging Into The Debug<a class="headerlink" href="#digging-into-the-debug" title="Permanent link">¶</a></h3>
<p>It took a fair amount of experimentation to figure out what the real issue
was.  Adding debug here and there and observing the behavior slowly
led me to the observation that the positions were not off by line numbers,
but by small column numbers.  Doing some further digging into the problem,
I noticed that each column number offset remained constant within
an example.  With a stroke of luck, I noticed that it only happened with
examples that had other elements within a Block Quote element.</p>
<p>It was then I figured out it was a problem with Block Quote elements
and their <code>leading_text_index</code> variable.  Suddenly, the full scope of the
problem fell into place, and additional debug confirmed that hypothesis.
When each example was being parsed, the leading text for the Block
Quote was being carefully removed and placed in the Block Quote token,
but the <code>leading_text_index</code> variable
was not updated.  As such, each of the calculated positions within the
Block Quote element were calculated solely using the length of the
leading text from the first Block Quote line.</p>
<p>Wow… it did take a while to get to that hypothesis, and it took a
bit more time to confirm it.  But when I had it confirmed, it made a lot
of sense.  To address it, I started adding the required plumbing to
update the <code>leading_text_index</code> variable properly, and the rest just
fell into place.  It didn’t take me long to get that up and working,
but I wanted to be extra sure that I solved the problem properly.</p>
<p>As the positions for most of the inline tokens are calculated, I double
checked those tokens more thoroughly than the other tokens.  I even
checked variations on the Markdown document to make sure they were also
working.  In the end, after much thinking to get there, the issue was solved.</p>
<p>After that long effort, I wanted to pick something more relaxing to
work on and get my energy back.</p>
<h2 id="issue-36-verifying-disabled-rules"><a href="https://github.com/jackdewinter/pymarkdown/issues/36">Issue 36</a> - Verifying Disabled Rules<a class="headerlink" href="#issue-36-verifying-disabled-rules" title="Permanent link">¶</a></h2>
<p>This was a monotonous task, but one that I knew that I needed to do at some point:
verify that any rule test that disabled another rule did so for the right reasons.  As
the number of rules grew dramatically in the last three months, I had suspicions that some
of the reasons that rules were disabled were no longer applicable.  And while I can check
for any enabled rule and its applicability by executing the full set of tests for the
project, verifying disabled rules was a very manual process.</p>
<p>This task took the better part of ten hours to complete over four days.  It wasn’t
that exciting, so I decided to break the one big task into smaller tasks to help keep me motivated
throughout the entire process.  That turned out to be a great decision. I found
that the more I worked on the process, the more errors I made in verifying the disabled
rules.  Nothing too serious, but for each error I made, I restarted the testing at the
last-known good point, hindering my forward process.  As far as I can tell, it was just
the monotonous nature of the task that made my mind wander just enough to lose track of
things.</p>
<p>But after almost ten hours, I was done.  When all was said and done, just over one
hundred rules had extra <code>--disable-rules</code> options that they did not need.  And while
it was a very boring task, I found it to be a very worthwhile task.  I now had my
confidence back that the rules tests were testing what they were supposed to test,
and only disabling rules when they had to.  That meant I could introduce changes
to the core and the rules with “that much” more confidence that the tests would
catch any changes gone bad.</p>
<h2 id="issue-37-verifying-lists-and-blank-lines"><a href="https://github.com/jackdewinter/pymarkdown/issues/37">Issue 37</a> - Verifying Lists and Blank Lines<a class="headerlink" href="#issue-37-verifying-lists-and-blank-lines" title="Permanent link">¶</a></h2>
<p>While I do try and put forth my best effort every time, sometimes I fall short
of that goal.  When I picked this Markdown out of the Issues List:</p>
<div class="highlight"><pre><span></span><span class="n">This</span> <span class="k">is</span> <span class="nb">text</span> <span class="k">and</span> <span class="n">a</span> <span class="n">blank</span> <span class="n">line</span><span class="p">.</span>

<span class="o">&gt;</span> <span class="n">a</span> <span class="n">block</span> <span class="n">quote</span>
<span class="o">&gt;</span> <span class="o">+</span> <span class="n">a</span> <span class="n">list</span>

<span class="n">This</span> <span class="k">is</span> <span class="n">a</span> <span class="n">blank</span> <span class="n">line</span> <span class="k">and</span> <span class="k">some</span> <span class="nb">text</span><span class="p">.</span>
</pre></div>
<p>I looked for it in the scenario tests and found it.  But for some reason, I
focused on the scenario test right above the actual test that held this document.
I feel kind of stupid, but for the first three or four times that I looked
at what I thought was the test housing this example, I was looking at the
previous test.  After that, I think it was just stuck in my head until
I came back to it after leaving it alone for a while.  I was very embarrassed
when I finally figured that out.</p>
<p>Once I got that straightened out, everything made sense.  Because I had
made this mistake this time, I probably had made a similar mistake when
adding this document to the Issues List.  But while I was verifying that
example, I used the time to check the other examples for the rule.  While
all the existing tests were fine, I added this document:</p>
<div class="highlight"><pre><span></span><span class="n">This</span> <span class="k">is</span> <span class="nb">text</span> <span class="k">and</span> <span class="n">a</span> <span class="n">blank</span> <span class="n">line</span><span class="p">.</span>

<span class="o">&gt;</span> <span class="o">+</span> <span class="n">a</span> <span class="n">list</span>

<span class="n">This</span> <span class="k">is</span> <span class="n">a</span> <span class="n">blank</span> <span class="n">line</span> <span class="k">and</span> <span class="k">some</span> <span class="nb">text</span><span class="p">.</span>
</pre></div>
<p>to fill in a hole that I saw in the testing.</p>
<p>While the actual example was not a problem, I did find a minor problem
that I was able to overcome and add to the tests for the rule.  Sometimes,
the steps are small.  I am okay with that!</p>
<h2 id="issue-38-false-positive"><a href="https://github.com/jackdewinter/pymarkdown/issues/38">Issue 38</a> - False Positive<a class="headerlink" href="#issue-38-false-positive" title="Permanent link">¶</a></h2>
<p>Sometimes I get lucky and see issues that look like problems, only to have them
turn out not be problems at all.  While that does not happen as often as I would
like, this was one of those cases.  The Markdown is:</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="n">a</span>
<span class="n">paragraph</span> <span class="n">inspired</span> <span class="n">link</span><span class="p">](</span>
<span class="o">/</span><span class="n">paragraph</span>
<span class="ss">"paragraph"</span><span class="p">)</span>
</pre></div>
<p>While there wasn’t that much information in the list except for the Markdown example,
I can only assume that the extra newline in the Link’s label was the cause of my concern.
Looking at other examples for rule Md044, I was able to find examples that somewhat
looked like that example, but not one that had a split Link label.</p>
<p>But in the end, just like the previous issue, the example in the Issues List passed
without any problem.  I added a new scenario test to fill a small hole that I found,
but that was it.  However, I still feel that this was time well spent.  Sure, for the
second time in a row the actual issue was a false positive, but I was also able to
find something that I missed.  And if nothing else, I verified that things were working
properly.</p>
<h2 id="issue-39-fun-with-nested-containers"><a href="https://github.com/jackdewinter/pymarkdown/issues/39">Issue 39</a> - Fun with Nested Containers<a class="headerlink" href="#issue-39-fun-with-nested-containers" title="Permanent link">¶</a></h2>
<p>During the testing of Rule Md007, I came across a document that was parsing incorrectly:</p>
<div class="highlight"><pre><span></span><span class="n">This</span> <span class="k">is</span> <span class="n">a</span> <span class="n">test</span>

<span class="o">&gt;</span> <span class="o">*</span> <span class="n">this</span> <span class="k">is</span> <span class="k">level</span> <span class="mi">1</span>
<span class="o">&gt;</span>   <span class="o">*</span> <span class="n">this</span> <span class="k">is</span> <span class="k">level</span> <span class="mi">2</span>
<span class="o">&gt;</span>     <span class="o">*</span> <span class="n">this</span> <span class="k">is</span> <span class="k">level</span> <span class="mi">3</span>
</pre></div>
<p>Playing around with it at the time, I noted that the first two levels were being parsed
properly, but the text from the third level was being included into the second level.
Taking the time to look at it some more, I determined that the same example without
any Block Quote element worked fine.  Therefore, it was something about the Block Quote
that was causing this to happen.  And that meant looking at the
<code>__get_nested_container_starts</code> function.</p>
<p>It was obvious that I needed to massage the whitespace to consider the
Block Quote, but I was not sure how.  After four or five hours of tinkering,
I had this code ready:</p>
<div class="highlight"><pre><span></span>        <span class="n">_</span><span class="p">,</span> <span class="n">ex_ws_test</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">extract_whitespace</span><span class="p">(</span><span class="n">line_to_parse</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">whitespace_scan_start_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">token_stack_index</span> <span class="ow">in</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token_stack_index</span><span class="o">.</span><span class="n">is_block_quote</span><span class="p">:</span>
                <span class="c1"># if text_removed_by_container:</span>
                <span class="c1">#     if text_removed_by_container.startswith("&gt; "):</span>
                <span class="c1">#         text_removed_by_container = text_removed_by_container[2:]</span>
                <span class="c1">#     elif text_removed_by_container.startswith("&gt;"):</span>
                <span class="c1">#         text_removed_by_container = text_removed_by_container[1:]</span>
                <span class="c1">#     else:</span>
                <span class="c1">#         POGGER.info("check next container_start&gt; out of block quote data")</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">token_stack_index</span><span class="o">.</span><span class="n">is_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">token_stack_index</span><span class="o">.</span><span class="n">ws_before_marker</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ex_ws_test</span><span class="p">):</span>
                    <span class="n">whitespace_scan_start_index</span> <span class="o">=</span> <span class="n">token_stack_index</span><span class="o">.</span><span class="n">ws_before_marker</span>

        <span class="n">after_ws_index</span><span class="p">,</span> <span class="n">ex_whitespace</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">extract_whitespace</span><span class="p">(</span>
            <span class="n">line_to_parse</span><span class="p">,</span> <span class="n">whitespace_scan_start_index</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ex_whitespace</span><span class="p">:</span>
            <span class="n">ex_whitespace</span> <span class="o">=</span> <span class="s2">""</span>
            <span class="n">after_ws_index</span> <span class="o">=</span> <span class="n">whitespace_scan_start_index</span>
</pre></div>
<p>If there is a lot of whitespace to deal with, the function needs to
make an educated guess as to how much of that is actual whitespace and how much
of that belongs to the List element.  For example, given this Markdown:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="o">*</span> <span class="n">this</span> <span class="k">is</span> <span class="k">level</span> <span class="mi">1</span>
<span class="o">&gt;</span>   <span class="o">*</span> <span class="n">this</span> <span class="k">is</span> <span class="k">level</span> <span class="mi">2</span>
<span class="o">&gt;</span>     <span class="o">*</span> <span class="n">this</span> <span class="k">is</span> <span class="k">level</span> <span class="mi">3</span>
</pre></div>
<p>it is visibly obvious that there are three levels to the list, with all three
levels within a Block Quote element.  But creating an algorithm to figure
that out is not as easy.  That algorithm must consider whether the text on
the third line is a new level or is a continuation of level two.  And since
the container processing comes before the leaf processing, that determination
needs to be made early on.</p>
<p>The algorithm works with this and tries to remove only as much whitespace
as is necessary to get a solid determination of whether the line is eligible
for a new List element start or if it is just text.  While the second part
of the algorithm, not shown in the above example, tackles the “eligible List
element start” part of that process, the above code tries to get the whitespace
ready for that process.  If there is whitespace that has a length that
is less than the current List element indentation, that whitespace can be
removed for the purposes of the second algorithm.  In fact, it is imperative
that the whitespace is removed.</p>
<p>It took a while to get there, but with a couple of slight changes, it was
working. And for what it is worth, I know that this is probably just the start of issues with
nested container tokens.  Right now, it is just a feeling, but that feeling tells me
that I am going to need to add extra testing for various nested container elements.
And as far as this project goes, those feelings are usually correct.</p>
<h2 id="issue-40-images-as-headings"><a href="https://github.com/jackdewinter/pymarkdown/issues/40">Issue 40</a> - Images as Headings<a class="headerlink" href="#issue-40-images-as-headings" title="Permanent link">¶</a></h2>
<p>Most of the time, I look at a collection of rules and they just look like they are meant to be
together.  But sometime, I see a set of rules that look like two completely different
organizations crafted them.  That was the case with Rule Md041 and Rule Md033.  Rule Md041
allows a top-level heading to be defined as a <code>H1</code> HTML tag, but Rule Md033 triggers on any
HTML tags that are present in the document.  To me, that looked like a bit of a mismatch,
and a mismatch that was easily fixable.</p>
<p>To cleanly fix this issue, I added a configuration value <code>allow_first_image_element</code> that
defaults to <code>True</code>.  First, I added code to set the <code>__is_first_element</code> variable
if the current token is the very first token, and the <code>__is_first_html_block</code>
variable to allow the <code>__look_for_html_start</code> function to know that the HTML block was
part of that first token.  With that preamble set up, the following code was added:</p>
<div class="highlight"><pre><span></span><span class="n">is_first_image_element</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">if</span> <span class="p">(</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__is_first_html_block</span>
    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__allow_first_image_element</span>
    <span class="ow">and</span> <span class="n">tag_text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"h1"</span><span class="p">):</span>

    <span class="n">is_first_image_element</span> <span class="o">=</span> <span class="n">full_tag_text</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"&lt;/h1&gt;"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_first_image_element</span><span class="p">:</span>
        <span class="n">full_tag_text</span> <span class="o">=</span> <span class="n">full_tag_text</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="s2">"&lt;/h1&gt;"</span><span class="p">)]</span>
        <span class="n">end_of_start_heading_index</span> <span class="o">=</span> <span class="n">full_tag_text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"&gt;"</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">end_of_start_heading_index</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">full_tag_text</span> <span class="o">=</span> <span class="n">full_tag_text</span><span class="p">[</span><span class="n">end_of_start_heading_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
        <span class="n">end_of_image_index</span> <span class="o">=</span> <span class="n">full_tag_text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"&gt;"</span><span class="p">)</span>
        <span class="n">is_first_image_element</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">full_tag_text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"&lt;img"</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">end_of_image_index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_tag_text</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
<p>The code is not pretty, but it is packed with functionality.
This code ensures that the <code>allow_first_image_element</code> configuration value is
enabled and that the HTML tag text starts with <code>&lt;h1</code>.  From there, it makes sure
that the text ends with <code>&lt;/h1&gt;</code>, that only the <code>img</code> tag follows the <code>&lt;h1&gt;</code> tag,
and that the <code>img</code> tag is the only tag present between the <code>&lt;h1&gt;</code> tag and the <code>&lt;/h1&gt;</code> tag.
Only if all those things line up, does the <code>is_first_image_element</code> variable get set to
<code>True</code>, allowing the rule to not trigger on image headings.</p>
<p>It just felt good to get this taken care of.  If I can find someone to make a good
heading image for the PyMarkdown project, I might use this!</p>
<h2 id="issues-41-cleaning-up-documentation"><a href="https://github.com/jackdewinter/pymarkdown/issues/41">Issues 41</a> - Cleaning Up Documentation<a class="headerlink" href="#issues-41-cleaning-up-documentation" title="Permanent link">¶</a></h2>
<p>Another issue that was added to the Issues List was the documentation for Rule Md041.
While verifying that everything looked good for all rule documentation, there was a cryptic
set of text at the bottom of the documentation for that rule:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">diff</span> <span class="n">html</span> <span class="n">comments</span>
</pre></div>
<p>“Diff html comments?”  What did that mean?  I wasn’t sure.  It took me a big of
poking around before I was able to figure out what it meant.  After looking at the
test documents for this rule in my Markdown editor, I noticed that there was only
one difference between the project rule and the original rule: it handled the HTML
comment tags differently.  Specifically, the original rule doesn’t deal with the
comment tags or other special tags at all, rendering them more or less invisible.</p>
<p>Thinking through this difference, I came to a defensible decision that I had written
the PyMarkdown rule correctly.  Depending on the definitive source used, tags such
as the comment tags can be viewed as either proper HTML tags or helper HTML tags.
Since those tags do not directly affect how the web page is displayed, it can be
argued that they are not proper tags.  But it can also be argued that those tags
are as important to a document as punctuation or foot notes.</p>
<p>Taking a holistic
view, I decided that view every part of a HTML document as integral part of that
document.  Therefore, HTML comment tags and the other special tags are integral
to the document.  It therefore follows, if they show up in the Markdown before
being translated into HTML, they will be present in the rendered HTML document.
Therefore, the rule should trigger on those special tags just like it triggers
on any other tag.  Done!</p>
<p>Hopefully, resolving this issue will teach me to leave better notes for myself.
Probably not right away, but I hope it does!</p>
<h2 id="issue-42-sorted-output"><a href="https://github.com/jackdewinter/pymarkdown/issues/42">Issue 42</a> - Sorted Output<a class="headerlink" href="#issue-42-sorted-output" title="Permanent link">¶</a></h2>
<p>This issue was recently put on the Issues List after more rules were added to the project.
While it does not have a lot of impact on the tests within the project, I have seen unordered
output in normal uses.  It is not usually a big problem to mentally go through the list
of reported issues and figure out where they are in the document.   However, I thoroughly
admitted that it would be useful to have them be in sorted order to allow for a good top-to-bottom
or bottom-to-top scan of the output.</p>
<p>To supply the output in a sorted order, a couple of small changes needed to be made,
mostly in the <code>plugin_manager.py</code> module.  Previously, an instance of the <code>ScanContext</code>
class was created at the start of each document and functioned as a conduit to ensure that
any triggered rules were reported properly.  To address this issue, that design was changed slightly to
introduce the <code>add_triggered_rule</code> function and the <code>report_on_triggered_rules</code> function.
Instead of the <code>report_next_line_error</code> function and the <code>report_next_token_error</code> function
directly calling the <code>log_scan_failure</code> function themselves, the new <code>add_triggered_rule</code> function
is called, adding the reported error to the context’s list of errors.  Once the entire
document has been scanned, the <code>report_on_triggered_rules</code> function is then called.  This
function simply sorts the list of reported errors before calling the <code>log_scan_failure</code> function
to report each error.</p>
<p>While resolving this issue does not provide a lot of difference to documents with a small
number of reported failures, I find that it makes a substantial difference to larger
sets of reported failures.  In my case, when going through lists of errors, I tend to
work from the bottom of the list to the top so that the line numbers are not disturbed.
I can see this working better for me and how I attack those lists.  I hope it helps
others too!</p>
<h2 id="issue-31-adding-module-support"><a href="https://github.com/jackdewinter/pymarkdown/issues/31">Issue 31</a> - Adding Module Support<a class="headerlink" href="#issue-31-adding-module-support" title="Permanent link">¶</a></h2>
<p>This issue didn’t really involve a big change, but it was a request from one of the users, so it
made the top of the list.  In Python, one of the interesting ways of executing Python
code is through exposing the package as an
<a href="https://docs.python.org/3/tutorial/modules.html">executable module</a>.
As I was not sure which people would want to execute the project it that manner, I left it off the
list of features to add.  But with a request from a user, it was back on the list.</p>
<p>It took a bit of research to get it right, but in the end, the only change that was
needed was the addition of the <code>__main__.py</code> module:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymarkdown</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">pymarkdown</span><span class="o">.</span><span class="n">PyMarkdownLint</span><span class="p">()</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
<p>If that code seems overly simplistic, it is because it is.  According to various
pages on the <a href="https://docs.python.org/3/library/__main__.html">Python site</a>,
the <code>__main__.py</code> file had special properties that are invoked when it is
invoked on behalf of a package using the <code>-m</code> module flag.  When it is run as
a module, the above <code>if</code> statement evaluates to <code>True</code> and the <code>main</code> function
from the <code>main.py</code> module is invoked.</p>
<p>Not much to add, but a good addition to tidy things up for the week!</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>While I know there are probably a couple of difficult issues hiding
in plain sight amongst the Issues List, I haven’t hit any of them yet.
I am keeping up a good pace and finding and fixing issues, and I happy
with the progress.  Do I wish it went faster? Sure… but I also know
it will take as long as it takes.  Now that I have the beta release
out there, it takes the pressure off a bit.</p>
<p>But I also know that I have a good collection of fixed issues, so
I am planning a build version update tomorrow to get these fixed
issues into the hands of users.  That does feel great, knowing that
I am at a place where I can do that!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>What else? More issues. Hopefully, some exciting ones this next week.
Well… maybe hopefully? Stay tuned!</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20More%20Beta%20Bugs&url=https%3A//jackdewinter.github.io/2021/10/04/markdown-linter-more-beta-bugs/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/10/04/markdown-linter-more-beta-bugs/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20More%20Beta%20Bugs&amp;body=https%3A//jackdewinter.github.io/2021/10/04/markdown-linter-more-beta-bugs/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/10/04/markdown-linter-more-beta-bugs/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-beta-bugs-b"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/09/27/markdown-linter-clearing-away-some-bugs/" title="Previous: Markdown Linter - Clearing Away Some Bugs">Markdown Linter - Clearing Away Some Bugs</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/10/10/markdown-linter-cleaning-things-up/" title="Next: Markdown Linter - Cleaning Things Up">Markdown Linter - Cleaning Things Up</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~14 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-10-04T00:00:00-07:00">Oct 4, 2021</time>
        <h4>Markdown Linter Beta Bugs</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2021/09/27/markdown-linter-clearing-away-some-bugs/" title="Markdown Linter - Clearing Away Some Bugs">Part 1: Markdown Linter - Clearing Away Some Bugs</a>
            </li>
            <li  class="active-part">
            Part 2: Markdown Linter - More Beta Bugs
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/10/10/markdown-linter-cleaning-things-up/" title="Markdown Linter - Cleaning Things Up">Part 3: Markdown Linter - Cleaning Things Up</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/10/17/markdown-linter-tying-up-some-loose-ends/" title="Markdown Linter - Tying Up Some Loose Ends">Part 4: Markdown Linter - Tying Up Some Loose Ends</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/10/25/markdown-linter-fun-with-nested-containers/" title="Markdown Linter - Fun With Nested Containers">Part 5: Markdown Linter - Fun With Nested Containers</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/11/01/markdown-linter-double-checking-my-double-checks/" title="Markdown Linter - Double Checking My Double Checks">Part 6: Markdown Linter - Double Checking My Double Checks</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/11/08/markdown-linter-fun-with-block-quotes/" title="Markdown Linter - Fun With Block Quotes">Part 7: Markdown Linter - Fun With Block Quotes</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/11/29/markdown-linter-the-bug-that-almost-knocked-me-down/" title="Markdown Linter - The Bug That Almost Knocked Me Down">Part 8: Markdown Linter - The Bug That Almost Knocked Me Down</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/12/20/markdown-linter-getting-back-to-work/" title="Markdown Linter - Getting Back To Work">Part 9: Markdown Linter - Getting Back To Work</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/12/27/markdown-linter-deciding-what-is-important/" title="Markdown Linter - Deciding What Is Important">Part 10: Markdown Linter - Deciding What Is Important</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/01/03/markdown-linter-keeping-at-it-with-something-that-works-for-you/" title="Markdown Linter - Keeping At It With Something That Works (For You)">Part 11: Markdown Linter - Keeping At It With Something That Works (For You)</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/01/10/markdown-linter-know-when-to-break-the-rules/" title="Markdown Linter - Know When To Break The Rules">Part 12: Markdown Linter - Know When To Break The Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/01/17/markdown-linter-finding-something-that-works/" title="Markdown Linter - Finding Something That Works">Part 13: Markdown Linter - Finding Something That Works</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/01/24/markdown-linter-why-nested-containers-are-so-difficult/" title="Markdown Linter - Why Nested Containers Are So Difficult">Part 14: Markdown Linter - Why Nested Containers Are So Difficult</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/01/31/markdown-linter-there-is-no-such-thing-as-professional-life/" title="Markdown Linter - There Is No Such Thing As Professional Life">Part 15: Markdown Linter - There Is No Such Thing As Professional Life</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/02/07/markdown-linter-is-it-worth-it/" title="Markdown Linter - Is It Worth It?">Part 16: Markdown Linter - Is It Worth It?</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/02/14/markdown-linter-grinding-away-at-issues/" title="Markdown Linter - Grinding Away At Issues">Part 17: Markdown Linter - Grinding Away At Issues</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/03/14/markdown-linter-pi-day-blues/" title="Markdown Linter - Pi Day Blues">Part 18: Markdown Linter - Pi Day Blues</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/03/28/markdown-linter-python-type-hinting/" title="Markdown Linter - Python Type Hinting">Part 19: Markdown Linter - Python Type Hinting</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/05/17/markdown-linter-shifting-left/" title="Markdown Linter - Shifting Left">Part 20: Markdown Linter - Shifting Left</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>110</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>128</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>