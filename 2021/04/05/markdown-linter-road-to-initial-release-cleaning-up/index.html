<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I talked about how I integrated my configuration system into the PyMarkdown project, revamping the command line interface along the way. In this article, I talk about my efforts in resolving the remaining Priority 1 items from the issues list. Introduction¶ At one point late …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Road To Initial Release - Cleaning Up "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/04/05/markdown-linter-road-to-initial-release-cleaning-up/" />
<meta property="og:description" content="Summary¶ In my last article, I talked about how I integrated my configuration system into the PyMarkdown project, revamping the command line interface along the way. In this article, I talk about my efforts in resolving the remaining Priority 1 items from the issues list. Introduction¶ At one point late …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-04-05T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Road To Initial Release - Cleaning Up ">
<meta name="twitter:description" content="Summary¶ In my last article, I talked about how I integrated my configuration system into the PyMarkdown project, revamping the command line interface along the way. In this article, I talk about my efforts in resolving the remaining Priority 1 items from the issues list. Introduction¶ At one point late …">

        <title>Markdown Linter - Road To Initial Release - Cleaning Up  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/04/05/markdown-linter-road-to-initial-release-cleaning-up/">
                Markdown Linter - Road To Initial Release - Cleaning Up
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#why-was-this-cleanup-required">Why Was This Cleanup Required?</a><ul>
<li><a href="#a-quick-note">A Quick Note</a></li>
</ul>
</li>
<li><a href="#the-important-of-good-scenario-tests">The Important Of Good Scenario Tests</a></li>
<li><a href="#end-tokens">End Tokens</a><ul>
<li><a href="#the-research">The Research</a></li>
<li><a href="#the-effort">The Effort</a></li>
<li><a href="#the-cleanup">The Cleanup</a></li>
</ul>
</li>
<li><a href="#fenced-code-blocks">Fenced Code Blocks</a><ul>
<li><a href="#the-examples">The Examples</a></li>
<li><a href="#the-research_1">The Research</a></li>
<li><a href="#the-effort_1">The Effort</a></li>
<li><a href="#the-cleanup_1">The Cleanup</a></li>
</ul>
</li>
<li><a href="#hard-line-breaks">Hard Line Breaks</a><ul>
<li><a href="#the-examples_1">The Examples</a></li>
<li><a href="#the-effort_2">The Effort</a></li>
<li><a href="#setext-headings">SetExt Headings</a></li>
<li><a href="#the-cleanup_2">The Cleanup</a></li>
</ul>
</li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2021/03/29/markdown-linter-road-to-initial-release-command-lines/">last article</a>, I talked about
how I integrated my configuration system into the PyMarkdown project, revamping the
command line interface along the way.  In this article, I talk about my efforts in
resolving the remaining Priority 1 items from the issues list.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>At one point late last year, I was worried that I would never get to the point where
I would release the PyMarkdown project in some form.  It seemed that for every
item I resolved from the issues list, I added two more items.  It just looked like I
was never going to get to a point where I was comfortable with releasing the project.</p>
<p>Things have changed a lot since last year.  While it is taking me longer to get to that
initial release point than I had hoped for, I know that I am very close to having a
solid first release of this project.  One of the best things I did
to help me work towards that point was to classify most of the issues list into one
of four categories.  And with only three items left in the Priority 1 section of that
list, it was time to deal with them and get that much closer to a solid release!</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/7d5fd4f265d3bf33963c1cf3c91af7a001473a39">27 Mar 2021</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/02c2f671fe397bba2d0e9cd89498570763f22895">28 Mar 2021</a>.</p>
<h2 id="why-was-this-cleanup-required">Why Was This Cleanup Required?<a class="headerlink" href="#why-was-this-cleanup-required" title="Permanent link">¶</a></h2>
<p>Looking through the issues list, I knew that most of the issues were in one of four
buckets of issues, numbered one to four.  There were a small handful of issues left
in the bucket labelled <em>“Priority 1 - Must Solve Before Initial”</em>, and these were
important to me to get resolved before the initial release of the project.  But why?</p>
<p>In categorizing the remaining issues into those buckets, any issues placed in the first
bucket were issues that either would drastically impede the project’s success or would
be too costly to fix later.   The remaining handful of issues in the Priority 1 section
were all issues that I consider to be breaking changes.</p>
<p>From experience, breaking changes are painful.  A breaking change is any change to a
system that causes dependent systems to fail specifically due to that change.  These
changes usually happen when some part of the interface between systems is deleted or
changed, but it can also occur if a newly added part of the interface is required.
A great
example of a breaking change starts with a system allowing free-form user input for the
<code>id</code> field of one of its objects.  If that system decided to modify that user input
process to mandate that any <code>id</code> fields must be only alphabetic characters, that is
not enough for it to be a breaking change.  For it to be a breaking change, there needs
to be a dependent system that interfaces with that field, requiring that system to
change its understanding of that field to match the newly provided understanding. Until
such time as that understanding is fixed, the dependency between those two systems is
broken.</p>
<p>These changes are painful for two main reasons.  The biggest reason is that the
interface between the two systems is changed in such a way that the old interface is
invalidated.  Therefore, one of the more frequently suggested mitigations for breaking
changes is to support a fixed number
of the old interfaces, say the last two interfaces, until such a time as there is
confidence that no other system is depending on that old interfaces.  If things are
done properly, the oldest of the supported interfaces can then be dropped with no
systems being dependent on it, therefore removing the “breaking” from a breaking change.</p>
<p>That is where the other big reason comes in: communication.  Whether the strategy is
to “bite the bullet” and do everything at once or whether it is to support old interfaces,
that must be clearly communicated to other teams and other projects.  If not, everything
falls apart very quickly.  And please take it from me, that is where the wrong kind of
communication usually happens, with a lot of finger pointing and harsh words being thrown
around.  Unless careful attention and effort is made to clearly communicate what is going
to be done, when it is going to be done, and the work required of all teams, breaking
changes are just a source of pain that it is best to avoid.</p>
<p>For each of the remaining Priority 1 issues, I wanted to change small things with tokens
and how their debug output is rendered.  If I waited until after I released the project,
I believe these changes would all qualify as breaking changes when people start to use
the project.  As these tokens are part of the foundation of the project, it would be
difficult to version them in any way that would make sense.  Therefore, I mandated
these changes as a requirement for the initial release.</p>
<h3 id="a-quick-note">A Quick Note<a class="headerlink" href="#a-quick-note" title="Permanent link">¶</a></h3>
<p>The PyMarkdown project uses its Markdown parser to translate Markdown into tokens, layering
a rules engine on top of those tokens emitted by the parser.  Unlike other
articles in this series, this article almost exclusively deals with tokens.  Therefore,
I believe that a rudimentary knowledge of tokens is required to understand this article.</p>
<p>The base of every token is either the <code>MarkdownToken</code> class or the <code>EndMarkdownToken</code>
class.  The <code>MarkdownToken</code> class itself contains the names of each of the different
tokens in a list of member variables at the top of the class.  When looking at the debug
output for a token, it is the open square bracket character <code>[</code> and this name that
form the start of every token. For every <code>MarkdownToken</code> instance and most instances of
<code>EndMarkdownToken</code><sup id="fnref:whenNot"><a class="footnote-ref" href="#fn:whenNot">1</a></sup>, this information is followed by the line number and column
number where the area belonging to that token begins.  This is then followed by the
separator character <code>:</code>, any extra token data, and the close square bracket character <code>]</code>.</p>
<p>A simple example of this is a simple Text token containing the words <code>baz</code> and <code>bar</code>
separated by a newline character.  When parsed, the Text token <code>[text(1,1):baz\nbar::\n]</code>
is emitted within the scope of a Paragraph token. Following the instructions above,
it reads that this a <code>text</code> token that starts at line <code>1</code> and column <code>1</code>.
The extra data for this token starts with the text content <code>baz\nbar</code>, followed by some
extra information regarding any whitespace encountered.</p>
<p>As the extra data for each token varies from token to token, the extra token data part of
the debug output varies from token to token.  Where possible, I will try and call out what
is present in the tokens in the description of the information.  As the HTML output is
usually not concerned with whitespace characters, the most common start to the extra
token data section of the debug output usually deals with any whitespace that was
encountered.</p>
<h2 id="the-important-of-good-scenario-tests">The Important Of Good Scenario Tests<a class="headerlink" href="#the-important-of-good-scenario-tests" title="Permanent link">¶</a></h2>
<p>While I usually consider good unit tests and good scenario tests pivotal to any project,
they are even more important when refactoring code.  The group of tests for any
project present a logical description of how the project is supposed to behave under
a given set of circumstances.  Depending on the type of refactoring that is being done,
one of two types of expectations are desired.  If the refactoring only changes
internal components, then the expectation is that no tests will need to be changed.
For these changes, a small external change is the expected change, and if the refactoring
is successful, then only those small external changes should occur.</p>
<p>I maintain a high level of code coverage and scenario coverage for the PyMarkdown project.
Because of this, I have the confidence to make these changes.  If anything breaks, I will
know about it right away, and not days later.  With that confidence in hand, it was time
to start making those changes.</p>
<h2 id="end-tokens">End Tokens<a class="headerlink" href="#end-tokens" title="Permanent link">¶</a></h2>
<p>The first change that I wanted to tackle was something that sounded simple, but I
figured it was going to trickle down into many changes.  That change was to refine how the
<code>EndMarkdownToken</code> was used, specifically with how it closed certain tokens.</p>
<p>During my development of the PyMarkdown project, I made certain decisions based on
the information I had at the time.  One of the first decisions that I needed to make
revolved around the use of the <code>EndMarkdownToken</code> token.  This token is used for
tokens that require some manner of manual close token to delineate the section being
specified.  One part of that token was an indicator <code>force_close</code>, which indicates
whether one or more characters caused the section to be closed without force, or whether
the section was forced close without any characters.  It was that decision that I wanted
to take another look at.  Was it always necessary?</p>
<h3 id="the-research">The Research<a class="headerlink" href="#the-research" title="Permanent link">¶</a></h3>
<p>One week, as I was fixing an issue with the <code>EmphasisMarkdownToken</code> tokens, I looked
at the <code>EndMarkdownToken</code> output and wondered if I had made the right choice, those many
months
ago.  While I was sure that I had made the right decision at that time,
I was not sure that the information underlying that decision had changed enough
to invalidate that decision.  I needed to take a new look.</p>
<p>To me, it just seemed wasteful and misleading to have a <code>force_close</code> field that
was always set to <code>False</code>.  It was correct to say that it was never forced close,
but it just seemed to me that it was extra information that could be conveyed in a better
form.</p>
<p>Searching through the source code for <code>[end-emphasis</code>, I searched the many results that
appeared and could not find one case where the found debug output indicated a forced
close.  This backed up my thoughts that always presenting that <code>force_close</code> field
in the debug output was inefficient.  That information along with the over 100 results
that I found in my search led me to decide to make this change.  Without searching for
any other end tokens, I believe that making this change solely on the merits of the
end Emphasis token were enough.</p>
<h3 id="the-effort">The Effort<a class="headerlink" href="#the-effort" title="Permanent link">¶</a></h3>
<p>The fist change was an easy one.  To better understand things in the future, I
added a new <code>requires_end_token</code> field to the token classes to define which tokens require
an end token to match their start token.  There was no external indication of this
change, it was just something to help me to define the characteristics of each type
of token.  To make use of this change, I added a new <code>assert</code> call when a new
<code>EndMarkdownToken</code> is created to confirm that the token type supports end tokens.</p>
<p>It was the other change that I was dreading.  If I wanted to remove the <code>force_close</code>
indication for any type of token that did not support it, I needed to know with
certainty that it would never be forced.  To do this, I added a new <code>can_force_close</code>
field and property to track that property of the tokens.  Adding to the effort
started in the previous section, I also added another check in the <code>EndMarkdownToken</code>
constructor to verify that if that flag was set, the <code>was_forced</code> argument was never
set.  This left me with the following code:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_markdown_token</span><span class="p">,</span> <span class="n">MarkdownToken</span><span class="p">):</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">start_markdown_token</span><span class="o">.</span><span class="n">requires_end_token</span>
        <span class="p">),</span> <span class="n">f</span><span class="s2">"Token '{start_markdown_token} does not require end token."</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">start_markdown_token</span><span class="o">.</span><span class="n">can_force_close</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">was_forced</span>
            <span class="p">),</span> <span class="n">f</span><span class="s2">"Token '{start_markdown_token}'s end token cannot be forced."</span>
</pre></div>
<p>With that in place, a small change to <code>__compose_data_field</code> function was all that
was needed to effect the change:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__start_markdown_token</span><span class="p">,</span> <span class="n">MarkdownToken</span><span class="p">)</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__start_markdown_token</span><span class="o">.</span><span class="n">can_force_close</span>
    <span class="p">):</span>
        <span class="n">field_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">was_forced</span><span class="p">))</span>
</pre></div>
<p>That was not the part I was dreading… that came next.</p>
<h3 id="the-cleanup">The Cleanup<a class="headerlink" href="#the-cleanup" title="Permanent link">¶</a></h3>
<p>With all the foundational changes in place, it was time to activate that code.  To be
doubly sure, I again verified that the corresponding end token was always created with
<code>was_forced</code> set to <code>False</code> and set the new <code>can_force_close</code> field to <code>False</code>.
Running the scenario tests, I went through and fixed all the scenario tests that
were expecting the old format and corrected them to the new format.  That might
sound difficult, but it effectively was changing the expected output that
looked like <code>"[end-emphasis(1,8):::False]"</code> into <code>"[end-emphasis(1,8)::]"</code> for
each reference that occurred in a scenario test.</p>
<p>Once those changes were fixed, I looked for other tokens that fell into this
category and discovered that this behavior was true for the <code>AtxHeadingMarkdownToken</code>,
the <code>SetExtHeadingMarkdownToken</code>, and the <code>LinkStartMarkdownToken</code>.  One at a time,
I verified that the <code>EndMarkdownToken</code> for those tokens were not being forced, and set
the <code>can_force_close</code> arguments to <code>False</code>.  From there it was lather, rinse, and repeat.
By the time I was done, I had changed the format more than 879 times in over 879 scenario
tests.</p>
<p>That was about five hours of really mind-numbing work, but it was worth it. It just
looked cleaner to me. It was a good first step.</p>
<h2 id="fenced-code-blocks">Fenced Code Blocks<a class="headerlink" href="#fenced-code-blocks" title="Permanent link">¶</a></h2>
<p>One of the things that I never had time to research is why the Text tokens inside of
Fenced Code Blocks tokens did not coalesce like they did within other tokens.
And it was not all the time either, it was only part of the time.  With this issue, there
were two things that I wanted to accomplish.  The first was to figure out why it happened.
The second, depending on the answer of the first, was to fix it.  If I was going
to fix it, I was highly confident that it would require changes to the tokens.  So,
while it was not big enough to normally make my radar, if I was going to fix it, now was
the time while I was addressing other tokens.</p>
<h3 id="the-examples">The Examples<a class="headerlink" href="#the-examples" title="Permanent link">¶</a></h3>
<p>To illustrate this behavior, consider the Markdown string from the test function
<code>test_fenced_code_blocks_099f</code>:</p>
<div class="highlight"><pre><span></span>    <span class="n">source_markdown</span> <span class="o">=</span> <span class="s2">"""```</span>

<span class="se">\a</span><span class="s2"></span>
<span class="se">\a\a</span><span class="s2">abc</span>
<span class="se">\a</span><span class="s2"></span>

<span class="s2">```"""</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s2">"</span><span class="se">\a</span><span class="s2">"</span><span class="p">,</span> <span class="s2">" "</span>
    <span class="p">)</span>
</pre></div>
<p>This test was created to test how blank lines and lines with text interact with each other
within a Fenced Code Block element.  Since this occurs within a Fenced Code Block, the
important thing to remember is that the translation to HTML must occur without losing
any data, including whitespaces.  As such, when it is tokenized, it tokenizes into the
following form:</p>
<div class="highlight"><pre><span></span>    <span class="n">expected_tokens</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"[fcode-block(1,1):`:3::::::]"</span><span class="p">,</span>
        <span class="s2">"[BLANK(2,1):]"</span><span class="p">,</span>
        <span class="s2">"[BLANK(3,1): ]"</span><span class="p">,</span>
        <span class="s2">"[text(4,3):abc:  ]"</span><span class="p">,</span>
        <span class="s2">"[BLANK(5,1): ]"</span><span class="p">,</span>
        <span class="s2">"[BLANK(6,1):]"</span><span class="p">,</span>
        <span class="s2">"[end-fcode-block::3:False]"</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
<p>This set of tokens generated for that Markdown starts and ends with generic Fenced Code
Block tokens.  Between those tokens are the Blank Line tokens representing each blank
line and the one Text token for the one non-blank line of text.</p>
<p>For comparison, test function <code>test_fenced_code_blocks_099c</code> starts with a line of text
and then is followed by blank lines until a final line of text and the closing fence:</p>
<div class="highlight"><pre><span></span>    <span class="n">source_markdown</span> <span class="o">=</span> <span class="s2">"""```</span>
<span class="s2">z</span>
<span class="se">\a</span><span class="s2"></span>
<span class="se">\a\a</span><span class="s2"></span>
<span class="se">\a</span><span class="s2"></span>
<span class="s2">z</span>
<span class="s2">```"""</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s2">"</span><span class="se">\a</span><span class="s2">"</span><span class="p">,</span> <span class="s2">" "</span>
    <span class="p">)</span>
</pre></div>
<p>This is translated into the tokenized form of:</p>
<div class="highlight"><pre><span></span>    expected_tokens = [
        "[fcode-block(1,1):`:3::::::]",
        "[text(2,1):z\n\x03 \n\x03  \n\x03 \nz:]",
        "[end-fcode-block::3:False]",
    ]
</pre></div>
<p>Unlike the previous token output, the Text tokens and Blank Line tokens have all been
coalesced or combined into a single Text token.  In the debug output for this Text token,
the <code>\n</code> sequence represents a newline character and the <code>\x03</code> is used to separate the
removed whitespace from the start of the line from the removed whitespace at the end of
the line. While it is a dense form of the information, it provides every bit of
information needed to faithfully generate the HTML output for that Markdown sample.</p>
<p>I sincerely believe that this single Text token format is easier to understand than the
alternative.  That alternative would be to use five tokens instead of one token; the
first and last tokens of that sequence would be Text tokens with the remaining three
tokens being Blank Line tokens.  While the single Text token is packed with information,
all the necessary information is contained within that one token, not spread out over five
tokens.  As such, I find that I do not need to try and remember what interactions occur
between the tokens as there is only the one token.  It is just there.</p>
<p>But if this is the case, why didn’t the previous example also coalesce its tokens into
one token?</p>
<h3 id="the-research_1">The Research<a class="headerlink" href="#the-research_1" title="Permanent link">¶</a></h3>
<p>It did not take me that long to track the cause for this behavior down, and I was shocked
at how easy it was to fix.  Inside of the <code>coalesce_processor.py</code> module, there is a loop
that looks for Text tokens and Blank Line tokens and sees if it can combine those tokens
into an already encountered Text token.  Basically, a Text token for <code>a</code> followed by a
Text token for <code>b</code> becomes a Text token for <code>a\nb</code>.  Similarly, a Text token for <code>a</code>
followed by a Blank Line Token becomes <code>a\n</code>.  Of course, this is all without whitespace,
which changes those combinations a bit, but not by much.</p>
<p>There are five Markdown elements that can contain Text tokens: the two paragraph-like
elements (Paragraph and SetExt Heading) and the three code block elements (Indented Code
Block, Fenced Code Block, and HTML Code Block).  Because of the way that they are parsed,
the two paragraph-like elements never start with a Blank Line token.  The paragraph-like
element is only started when actual text is presented, skipping over those blank lines.
The HTML Code Blocks elements are always started by a HTML tag and the Indented Code
Block element is always started by indented text.  That leaves the Fenced Code Block
element as the only element that can start with a Blank Line token.</p>
<h3 id="the-effort_1">The Effort<a class="headerlink" href="#the-effort_1" title="Permanent link">¶</a></h3>
<p>With that research under my belt, it was easy to determine the base change needed
to fix this issue.  The reason that the Text tokens and Blank Line tokens were not
coalescing was that there was no Text token to coalesce to.  The change was to add the
following code to the end of the loop in the <code>coalesce_text_blocks</code> function:</p>
<div class="highlight"><pre><span></span>            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">first_pass_results</span><span class="p">[</span><span class="n">coalesce_index</span><span class="p">]</span><span class="o">.</span><span class="n">is_blank_line</span>
                <span class="ow">and</span> <span class="n">coalesced_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_code_block</span>
            <span class="p">):</span>
                <span class="n">replacement_token</span> <span class="o">=</span> <span class="n">TextMarkdownToken</span><span class="p">(</span>
                    <span class="s2">""</span><span class="p">,</span>
                    <span class="n">first_pass_results</span><span class="p">[</span><span class="n">coalesce_index</span><span class="p">]</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="p">,</span>
                    <span class="n">line_number</span><span class="o">=</span><span class="n">first_pass_results</span><span class="p">[</span><span class="n">coalesce_index</span><span class="p">]</span><span class="o">.</span><span class="n">line_number</span><span class="p">,</span>
                    <span class="n">column_number</span><span class="o">=</span><span class="n">first_pass_results</span><span class="p">[</span><span class="n">coalesce_index</span><span class="p">]</span><span class="o">.</span><span class="n">column_number</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">coalesced_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replacement_token</span><span class="p">)</span>
                <span class="n">did_process</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<p>This code would only trigger for the scenarios in which the current element was a
Blank Line token and it was the first token inside of a code block.  In those cases,
it kicked off the coalesce process by creating an “empty” Text token that represented
the blank line.  With this new logic in place, the Markdown for function
<code>test_fenced_code_blocks_099f</code> now parsed as:</p>
<div class="highlight"><pre><span></span>    <span class="n">expected_tokens</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"[fcode-block(1,1):`:3::::::]"</span><span class="p">,</span>
        <span class="s2">"[text(2,1):</span><span class="se">\n\x03</span><span class="s2"> </span><span class="se">\n</span><span class="s2">  abc</span><span class="se">\n\x03</span><span class="s2"> </span><span class="se">\n\x03</span><span class="s2">:]"</span><span class="p">,</span>
        <span class="s2">"[end-fcode-block::3:False]"</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
<h3 id="the-cleanup_1">The Cleanup<a class="headerlink" href="#the-cleanup_1" title="Permanent link">¶</a></h3>
<p>The cleanup for this change was not too bad.  The HTML transformer was simplified by
removing two lbocks of code, one from the <code>__handle_text_token</code> function and the other
from the <code>__handle_blank_line_token</code> function.  As Blank Line tokens no longer appeared
within Fenced Code Blocks, there was now no need for that processing. In addition,
the <code>__handle_end_fenced_code_block_token</code> function required a similar change to remove
unused code, as well as a small change to add a newline character under certain specific
circumstances.  The Markdown transformer change was even simpler, requiring the
string modification at the end of the <code>transform</code> function to be further restricted
in cases where the end Fenced Code Block token was forced.</p>
<p>Other than those changes, the remaining changes were in the scenario tests that included
Fenced Code Blocks that began with a Blank Line.  Including new tests that were added
to round our scenarios, only 34 scenario tests needed to be adjusted.  I was lucky
with that change, only requiring changes for scenarios that specifically dealt with
Fenced Code Block elements beginning with a blank line.  It could have been a lot worse!</p>
<h2 id="hard-line-breaks">Hard Line Breaks<a class="headerlink" href="#hard-line-breaks" title="Permanent link">¶</a></h2>
<p>This change is something that I have looked at on and off for around seven months.  For
whatever reason, when I added support for the Hard Line Break token, I added it
without capturing the newline that accompanies the hard line break inside of the token.
Instead, that newline was placed in the Text token that followed the Hard Line Break token.
Having recently made sure that Hard Line Break elements were being handled properly, I
was now even more convinced that the newline character should be with the Hard Line Break
token itself, not with the following token.</p>
<p>The reason I had just looked at this before and taken no action to fix it was because of
the scope of this change.  There was no way that fixing this was not going to be a
breaking change.  I was moving a newline character from a following token back to the
current token, where it should have been from the start.  According to my estimates, it
was going to impact at least 20 tests outside of the tests for the Hard Line Break token
itself.  But, to avoid a breaking change later, it was better to incur the effort of
changing the code now.</p>
<h3 id="the-examples_1">The Examples<a class="headerlink" href="#the-examples_1" title="Permanent link">¶</a></h3>
<p>To illustrate this behavior, consider the Markdown string from the test function
<code>test_hard_line_breaks_655x</code>:</p>
<div class="highlight"><pre><span></span>    <span class="n">source_markdown</span> <span class="o">=</span> <span class="s2">"""foo</span><span class="se">\\</span><span class="s2"></span>
<span class="s2">baz"""</span>
</pre></div>
<p>This is a simple example that illustrates how a single backslash at the end of the line
(shown in its Python form as a backslash escaped by a backslash) causes a Hard Line Break
token to be generated.  This in turn produces the tokens:</p>
<div class="highlight"><pre><span></span>    <span class="n">expected_tokens</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"[para(1,1):</span><span class="se">\n</span><span class="s2">]"</span><span class="p">,</span>
        <span class="s2">"[text(1,1):foo:]"</span><span class="p">,</span>
        <span class="s2">"[hard-break(1,4):</span><span class="se">\\</span><span class="s2">]"</span><span class="p">,</span>
        <span class="s2">"[text(2,1):</span><span class="se">\n</span><span class="s2">baz::</span><span class="se">\n</span><span class="s2">]"</span><span class="p">,</span>
        <span class="s2">"[end-para:::True]"</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
<p>If this does not look a bit weird, it should.  Usually, the newline character is contained
within the token that contains that newline character.  In this case, the newline character
for the Hard Line Break token is contained at the start of the following Text token.
I mean, it works, but it is not ideal.  Dealing with that weirdness caused me to have to
add extra bits of code to compensate for that behavior, as well as causing issues during
debugging.  It just did not work well for me.</p>
<p>Ideally, what I wanted to see was:</p>
<div class="highlight"><pre><span></span>    <span class="n">expected_tokens</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"[para(1,1):</span><span class="se">\n</span><span class="s2">]"</span><span class="p">,</span>
        <span class="s2">"[text(1,1):foo:]"</span><span class="p">,</span>
        <span class="s2">"[hard-break(1,4):</span><span class="se">\\</span><span class="s2">:</span><span class="se">\n</span><span class="s2">]"</span><span class="p">,</span>
        <span class="s2">"[text(2,1):baz:]"</span><span class="p">,</span>
        <span class="s2">"[end-para:::True]"</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
<p>It was just a matter of making the necessary changes to get there and undoing a lot of
the little changes made to compensate for it along the way.</p>
<h3 id="the-effort_2">The Effort<a class="headerlink" href="#the-effort_2" title="Permanent link">¶</a></h3>
<p>From a change point of view, the first two parts were the easy ones: changing the token
itself and changing the <code>__handle_hard_break_token</code> function in the HTML transformer to
produce the correct output.  Starting from there, I expected a change would be required
in the <code>handle_line_end</code> function, and I was correct.  For both forms of the token,
the <code>whitespace_to_add</code> variable needed to be set to <code>None</code> and the
<code>append_to_current_string</code> variable needed to be set to <code>""</code>.  This ensured that the
correct actions were taken at the end of that line.</p>
<p>After some more debugging, a couple of lines were removed from the <code>__complete_inline_loop</code>
function and the <code>__complete_inline_block_processing</code> function as they were no longer
needed.  The Markdown transformer itself was mostly correct, requiring recombination with
any existing paragraph text to be taken care of in the <code>__rehydrate_hard_break</code> function.
While not as simple, the <code>verify_line_and_column_numbers.py</code> module required a series of
changes that were foreseeable, based on the changes that had already been made.</p>
<p>One of the trickier things to debug in this area were the changes required for links and
images.  To get things working properly before this change, the
<code>__collect_text_from_blocks</code> function and others like it had “funny” logic to deal with
the newline being in a separate token.  For the <code>__collect_text_from_blocks</code> function,
I was lucky: I literally just needed to append a newline character to both the <code>text_parts</code>
variable and the <code>text_raw_parts</code> variable.   But in other cases, I had to remove code
that had worked before and replace it with code, often code that was aware of whether or
not it was captured inside of a link label.  That took a while to work through.</p>
<h3 id="setext-headings">SetExt Headings<a class="headerlink" href="#setext-headings" title="Permanent link">¶</a></h3>
<p>The SetExt Heading token presented its own set of issues.  As that token is essentially
a Paragraph token followed by a special sequence, the inline processing had to be coded
differently than the paragraph handling.  With this change, all the fixes that corrected
for the Text token following a Hard Line Break token within a SetExt Heading token needed
to be removed.</p>
<p>While there weren’t any big blocks of codes that had to be written, there was a lot of
moving code around and adding code to specifically handle the whitespace to be stored
near Hard Line Break tokens.  This occurred in three places within the
<code>__process_inline_text_block</code> function and the only effective way to debug it was to
uncomment every <code>PLOGGER</code> call within that function.  Small thing: I forgot to comment
them out again when I was done.</p>
<h3 id="the-cleanup_2">The Cleanup<a class="headerlink" href="#the-cleanup_2" title="Permanent link">¶</a></h3>
<p>Both the transformers were not that bad, as they are contained, but the consitency checks
were full of cases for handling the newline character in the following Text token that
had to be undone.  In all, 59 scenario tests were changed, and it took a lot of debugging
to remove the “fixes” that were previously added.   As a lot of those “fixes” only
impacted two or three scenario tests, I just had to work through each of those issues
and the ones that followed.</p>
<p>But, as I have said with the previous two changes, those changes just looked right.
It just made sense to have the newline character for the Hard Line Break token with
the token itself.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>While I previously could not see my way to get here, I was now at the point where I had
zero Priority 1 items in the issues list.  I had to make some hard choices of what I needed
to have in the project for an initial release versus what I wanted to have for that
release.  But I made those choices and followed through to get to this point.  No
more Priority 1 items!</p>
<p>And then that passed… but in a good way.  There were a couple of new items that
I knew I needed to add into that section, and I added them. Nothing major, but the
section had items again.  But knowing that I emptied that section was a big confidence
booster.  And knowing that I only added three small issues also helped:
a task to write documentation, to check that the existing rules were still valid,
and setting configuration properties from the command line.  These were tasks that I
knew would be achievable in a short amount of time.</p>
<p>The big thing for me was to start getting the project out there with a solid initial
set of features, fixing up things in a following release as I worked on resolving issues.
From there I could start to get feedback, which would help me figure out how to
prioritize things going forward.</p>
<p>It was just a good feeling knowing that I was getting close to a solid initial release
with an increased sense of confidence in the project.</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>While I was sure that I was going to find a couple more things to add to the Priority
1 section of the issues list, it was currently empty.  As such, I wanted to devote the
next week to getting a first pass at the Python library setup code underway.</p>
<p>Almost there!</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:whenNot">
<p>The line number and column number are only present if the <code>EndMarkdownToken</code> instance consumes one of more characters to create the <code>EndMarkdownToken</code>.  For example, an Emphasis element requires matching opening and closing characters to delineate the emphasized text, so that instance of the <code>EndMarkdownToken</code> shows the line number and column number.  Conversely, Indented Code Blocks are terminated when a new line of information does not begin with the required indentation, so that instance of the <code>EndMarkdownToken</code> does not show either the line number nor the column number. <a class="footnote-backref" href="#fnref:whenNot" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Road%20To%20Initial%20Release%20-%20Cleaning%20Up&url=https%3A//jackdewinter.github.io/2021/04/05/markdown-linter-road-to-initial-release-cleaning-up/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/04/05/markdown-linter-road-to-initial-release-cleaning-up/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Road%20To%20Initial%20Release%20-%20Cleaning%20Up&amp;body=https%3A//jackdewinter.github.io/2021/04/05/markdown-linter-road-to-initial-release-cleaning-up/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/04/05/markdown-linter-road-to-initial-release-cleaning-up/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-road-to-release-i"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/03/29/markdown-linter-road-to-initial-release-command-lines/" title="Previous: Markdown Linter - Road To Initial Release - Command Lines">Markdown Linter - Road To Initial Release - Command Lines</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/04/12/markdown-linter-road-to-initial-release-creating-a-package/" title="Next: Markdown Linter - Road To Initial Release - Creating A Package">Markdown Linter - Road To Initial Release - Creating A Package</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~19 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-04-05T00:00:00-07:00">Apr 5, 2021</time>
        <h4>Markdown Linter Road To Initial Release</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2021/02/08/markdown-linter-road-to-initial-release-learned-and-useful-things/" title="Markdown Linter - Road To Initial Release - Learned and Useful Things">Part 1: Markdown Linter - Road To Initial Release - Learned and Useful Things</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/15/markdown-linter-road-to-initial-release-refactoring/" title="Markdown Linter - Road To Initial Release - Refactoring">Part 2: Markdown Linter - Road To Initial Release - Refactoring</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/22/markdown-linter-road-to-initial-release-starting-performance/" title="Markdown Linter - Road To Initial Release - Starting Performance">Part 3: Markdown Linter - Road To Initial Release - Starting Performance</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/01/markdown-linter-road-to-initial-release-measured-performance-increases/" title="Markdown Linter - Road To Initial Release - Measured Performance Increases">Part 4: Markdown Linter - Road To Initial Release - Measured Performance Increases</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/08/markdown-linter-road-to-initial-release-cleaning-up-the-list-and-readability/" title="Markdown Linter - Road To Initial Release - Cleaning Up The List and Readability">Part 5: Markdown Linter - Road To Initial Release - Cleaning Up The List and Readability</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/15/markdown-linter-road-to-initial-release-front-matter/" title="Markdown Linter - Road To Initial Release - Front-Matter">Part 6: Markdown Linter - Road To Initial Release - Front-Matter</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/22/markdown-linter-road-to-initial-release-configuration/" title="Markdown Linter - Road To Initial Release - Configuration">Part 7: Markdown Linter - Road To Initial Release - Configuration</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/29/markdown-linter-road-to-initial-release-command-lines/" title="Markdown Linter - Road To Initial Release - Command Lines">Part 8: Markdown Linter - Road To Initial Release - Command Lines</a>
            </li>
            <li  class="active-part">
            Part 9: Markdown Linter - Road To Initial Release - Cleaning Up
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/04/12/markdown-linter-road-to-initial-release-creating-a-package/" title="Markdown Linter - Road To Initial Release - Creating A Package">Part 10: Markdown Linter - Road To Initial Release - Creating A Package</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/04/19/markdown-linter-road-to-initial-release-gearing-up-for-plugins/" title="Markdown Linter - Road To Initial Release - Gearing Up For Plugins">Part 11: Markdown Linter - Road To Initial Release - Gearing Up For Plugins</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/03/markdown-linter-road-to-initial-release-finalizing-plugins/" title="Markdown Linter - Road To Initial Release - Finalizing Plugins">Part 12: Markdown Linter - Road To Initial Release - Finalizing Plugins</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/10/markdown-linter-road-to-initial-release-fine-tuning-plugins/" title="Markdown Linter - Road To Initial Release - Fine Tuning Plugins">Part 13: Markdown Linter - Road To Initial Release - Fine Tuning Plugins</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/17/markdown-linter-road-to-initial-release-dotting-the-is/" title="Markdown Linter - Road To Initial Release - Dotting The Is">Part 14: Markdown Linter - Road To Initial Release - Dotting The Is</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/24/markdown-linter-road-to-initial-release-crossing-the-ts/" title="Markdown Linter - Road To Initial Release - Crossing The Ts">Part 15: Markdown Linter - Road To Initial Release - Crossing The Ts</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/31/markdown-linter-road-to-initial-release-triple-check-everything/" title="Markdown Linter - Road To Initial Release - Triple Check Everything">Part 16: Markdown Linter - Road To Initial Release - Triple Check Everything</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>110</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>128</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>