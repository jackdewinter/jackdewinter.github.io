<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I talked about the work I put into getting that weeks’ three rules completed. In this article, I talk about the next three rules I worked on. Introduction¶ I know I am getting close to being finished with this phase of implementing rules when I …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Another Three Done! "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/" />
<meta property="og:description" content="Summary¶ In my last article, I talked about the work I put into getting that weeks’ three rules completed. In this article, I talk about the next three rules I worked on. Introduction¶ I know I am getting close to being finished with this phase of implementing rules when I …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-08-30T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Another Three Done! ">
<meta name="twitter:description" content="Summary¶ In my last article, I talked about the work I put into getting that weeks’ three rules completed. In this article, I talk about the next three rules I worked on. Introduction¶ I know I am getting close to being finished with this phase of implementing rules when I …">

        <title>Markdown Linter - Another Three Done!  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/">
                Markdown Linter - Another Three Done!
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#multiple-top-level-headings">Multiple Top-Level Headings</a><ul>
<li><a href="#design">Design</a></li>
</ul>
</li>
<li><a href="#testing-and-implementation">Testing and Implementation</a></li>
<li><a href="#all-files-must-have-top-level-headings">All Files Must Have Top-Level Headings</a><ul>
<li><a href="#design_1">Design</a></li>
<li><a href="#testing-and-implementation_1">Testing and Implementation</a></li>
</ul>
</li>
<li><a href="#required-heading-structure">Required Heading Structure</a><ul>
<li><a href="#glob">Glob</a></li>
<li><a href="#design_2">Design</a><ul>
<li><a href="#glob_1">Glob</a></li>
</ul>
</li>
<li><a href="#testing-and-implementation_2">Testing and Implementation</a><ul>
<li><a href="#compiling-the-requirements">Compiling The Requirements</a></li>
<li><a href="#collecting-the-headings-and-associated-text">Collecting the Headings and Associated Text</a></li>
<li><a href="#a-globbing-we-will-go">A Globbing We Will Go</a></li>
</ul>
</li>
<li><a href="#life-often-shows-up-when-you-least-expect-it">Life Often Shows Up When You Least Expect It</a></li>
</ul>
</li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2021/08/23/markdown-linter-three-more-rules/">last article</a>, I talked
about the work I put into getting that weeks’ three rules completed. In this article, I
talk about the next three rules I worked on.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>I know I am getting close to being finished with this phase of implementing rules when
I can represent the number of rules left with two hands!  It was exciting.  I could add
a lot more, but what I really want to do is talk about the things I did this week, so
here I go!</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please consult the commits that occurred between
<a href="https://github.com/jackdewinter/pymarkdown/commit/7ecdd796b0ee610b0398a788e2286d96ba924473">25 Aug 2021</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/a417b4635a9df5d76fbf99bb5503839517d8e7e6">29 Aug 2021</a>.</p>
<h2 id="multiple-top-level-headings">Multiple Top-Level Headings<a class="headerlink" href="#multiple-top-level-headings" title="Permanent link">¶</a></h2>
<p>The implementation of Rule Md025 was a long time coming, but I was finally getting around
to it.  The basis of the rule is very simple:  top-level headings are often used by parsers as
a document title.  Because of that, having multiple titles in the same document just doesn’t
make sense.  Well, it did not make sense to me at least.</p>
<h3 id="design">Design<a class="headerlink" href="#design" title="Permanent link">¶</a></h3>
<p>While I felt that this rule was simple enough to start implementing without any
design, I wanted to stick to my goals and design this out… even if it only took
five minutes.  That five minute estimate was derived at because the design parts were
easy for me to grasp together in my head with room to spare.  From experience,
if you can think about a design as a complete puzzle in your head, the design is generally
going to be simple.</p>
<p>The first part of the design was easy.  I needed a variable to keep track of whether the
first top-level heading was observed.  Once set, any other top-level heading was a
multiple and needed to trigger the rule.  Since both the Atx Heading tokens and the SetExt
Heading tokens share the <code>hash_count</code> property, it would mean a simple check to see if
that property was set to 1.</p>
<p>That was it.  Nothing complex.
Even with the configuration parts added in, those new parts were still manageable
and simple.  If the <code>level</code> configuration value is set, that <code>1</code> would be replaced with the
variable containing the <code>level</code> configuration value.  The <code>front_matter_title</code> configuration
required a check for the front-matter token, and then a check to see if property map for
the Front Matter token contained the specified configuration value.  If so, set the
indicator that the first top-level heading was observed.</p>
<p>For me, it was easy going through that design, with no issues involved.  I did not even
see any warning signs.  But still, was it worth it?  It did feel good going through the
process and having that confidence verified, thinking some more about it and confirming
that there were no apparent issues.</p>
<h2 id="testing-and-implementation">Testing and Implementation<a class="headerlink" href="#testing-and-implementation" title="Permanent link">¶</a></h2>
<p>After coming up with nine scenario tests, I felt I had given the rule enough good test
coverage to move on to the implementation phase.  Like the simplicity of the design phase,
these scenarios were not particularly difficult.  Three good scenarios to make sure
the rule does not trigger for safe scenarios, and six scenarios testing the failure
combinations.</p>
<p>Just like some of the rules from last week, the implementation was a reflection
of the design that I specified above.  The rule started with:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">starting_new_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__have_top_level</span> <span class="o">=</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">next_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_atx_heading</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_setext_heading</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">hash_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__have_top_level</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__have_top_level</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<p>Then, when the <code>self.__level</code> configuration value was introduced, the hash count
comparison was changed to:</p>
<div class="highlight"><pre><span></span>        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">hash_count</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__level</span><span class="p">:</span>
</pre></div>
<p>Finally, when the <code>self.__front_matter_title</code> configuration value was added,
a new comparison was added at the end of the main <code>if</code> statement:</p>
<div class="highlight"><pre><span></span>    <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_front_matter</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__front_matter_title</span> <span class="ow">in</span> <span class="n">token</span><span class="o">.</span><span class="n">matter_map</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__have_top_level</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<p>Just like the design indicated, it was a simple implementation.   But I am
not always so lucky that things match up.  With extra confidence, but
still a firm believe that I am taking the right path, I went on to the next
rule.</p>
<h2 id="all-files-must-have-top-level-headings">All Files Must Have Top-Level Headings<a class="headerlink" href="#all-files-must-have-top-level-headings" title="Permanent link">¶</a></h2>
<p>This rule, Rule Md041, was another rule that I had been delaying for
a long time.  Part of the reason for that delay is the scope of this rule.
I had confidence that when I completed this rule that it was probably
going to be triggered on around 60% of the test scenarios for rules.  That
was an easy estimate to come up with.  A good group of those test scenarios
were not focused on Atx Heading elements or SetExt Heading element; therefore
they were probably going to trigger this rule.</p>
<p>So, taking a slight detour from the usual design first approach, I decided
that I needed to upgrade the <code>invoke_main</code> function to handle this issue.
The <code>invoke_main</code> function is part of the test framework and is used by
approximately 75% of the scenario tests.  The function’s one and only job is to allow
the scenario tests to execute the linter with as much parity as possible
with the command line.</p>
<p>It was here that I needed to address the issue of Rule Md041 triggering
during the scenario tests.  Changing each test was out of the question…
that would be a mess.  Instead, I added a <code>suppress_first_line_heading_rule</code>
parameter, defaulted it to <code>True</code>, and implemented the following:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">invoke_main</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">suppress_first_line_heading_rule</span><span class="o">=</span><span class="bp">True</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="n">suppress_first_line_heading_rule</span><span class="p">:</span>
        <span class="n">new_arguments</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">arguments</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">"--disable-rules"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_arguments</span><span class="p">:</span>
            <span class="n">new_arguments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"--disable-rules"</span><span class="p">)</span>
            <span class="n">new_arguments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"md041"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">disable_index</span> <span class="o">=</span> <span class="n">new_arguments</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">"--disable-rules"</span><span class="p">)</span>
            <span class="n">disable_value</span> <span class="o">=</span> <span class="n">new_arguments</span><span class="p">[</span><span class="n">disable_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">disable_value</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">","</span><span class="p">):</span>
                <span class="n">disable_value</span> <span class="o">+=</span> <span class="s2">","</span>
            <span class="n">disable_value</span> <span class="o">+=</span> <span class="s2">"md041"</span>
            <span class="n">new_arguments</span><span class="p">[</span><span class="n">disable_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">disable_value</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="n">new_arguments</span>
</pre></div>
<p>The changes were simple, yet efficient.  If there is no parameter named
<code>--disable-rules</code>, then the parameter and the value <code>md041</code> are inserted
at the front of the parameter list.  Otherwise, the value for that
parameter has the value <code>md041</code> appended to the end of the existing
value.</p>
<p>If was not rocket science, but it was efficient.  Instead of spending
hours making changes and validating them, I had this change up and
running within two hours, testing included.  It was a bargain.</p>
<h3 id="design_1">Design<a class="headerlink" href="#design_1" title="Permanent link">¶</a></h3>
<p>I felt that this design was a bit more complex than the previous rule,
but not by that much.  The basis for this rule is all about the
first “real” token in the document.  I knew there was going to be
a bit of a twist regarding the Front Matter token, so I left that to the
end.  Every other token was fair game though.</p>
<p>Since this rule is specifically about the first token in the document,
I knew that I was going to need a variable just to provide that context
to the rule.  Once inside an <code>if</code> condition on that variable, unless there
was a good reason not to, that variable would be set each time.
Quick, easy, done.</p>
<p>From there it was just working through the allowable start cases one
by one.  If a Atx Heading element or a SetExt Heading element without the
right level was found, it needed to trigger the rule.  For a HTML Block,
I would have to do a bit more work as the allowable <code>&lt;h1</code> sequence was
inside a separate Text element.  That meant I would have to set a separate
capture variable, and not set the “done” variable until the rule analyzed
the following Text element.  But other than that, the general idea of how
the block was handled was the same as with the Heading elements.
I also figured out that Blank Lines would probably not count, so I made
a note to test what effect those Blank Lines had.</p>
<p>For the Front Matter element, I thought there would have been more
work needed, but in the end, I figured that it was a simple check.  If
the title is in the Front Matter element’s property map, then a title
is present, and the requirements for having a title were met.  I checked
this a couple of times to make sense, and it passed each time.  I think
the original name of the rule could have been better worded, but it
was working properly.</p>
<h3 id="testing-and-implementation_1">Testing and Implementation<a class="headerlink" href="#testing-and-implementation_1" title="Permanent link">¶</a></h3>
<p>The thirteen scenario tests that I came up with for this rule were simple
to construct.  Four of those scenario tests were the good cases where each
of the four allowable elements start the document with good data.  Basically,
tests for things like a Level 1 (top-level) Atx Heading element.  I was
concerned about Blank Lines causing issues, so I throw an extra good scenario
test in there just to be sure.  The negative tests?  Just one scenario test
for every leaf element, and it was taken care of.</p>
<p>The implementation was also uneventful, following the design of the rule
without any issues.  Starting with this code to handle the Heading elements:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">starting_new_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__have_seen_first_token</span> <span class="o">=</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">next_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__have_seen_first_token</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_atx_heading</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_setext_heading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__have_seen_first_token</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">hash_count</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__start_level</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_blank_line</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__have_seen_first_token</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<p>the function was grown to handle Front Matter elements and HTML Block elements
as described in the design.  Except for a couple of typing mistakes here
and there, everything went very smoothly.</p>
<p>It was as I was wrapping up the work for this rule and looking forward
to Rule Md043 that I realized that I was going to have my hands full with
that rule.</p>
<h2 id="required-heading-structure">Required Heading Structure<a class="headerlink" href="#required-heading-structure" title="Permanent link">¶</a></h2>
<p>The first time I looked at Rule Md043, I did not think it would be
too difficult to implement.  It is a very simple text comparison between
a list of Heading elements and a list of required heading levels and
heading text.</p>
<p>But then I looked further in the description and saw that it supports
the <code>*</code> character.  My heart dropped.  That meant I was going to have
to implement a glob-based comparison.  I was not happy.</p>
<h3 id="glob">Glob<a class="headerlink" href="#glob" title="Permanent link">¶</a></h3>
<p>While the <a href="https://www.merriam-webster.com/dictionary/glob">dictionary definition</a>
is “a small drop” or “a usually large and rounded mass”, if you mention
Globs to most computer people, they immediately think of <code>*</code> and <code>?</code>.
From a
<a href="https://docs.python.org/3/library/glob.html">Linux point of view</a>, a glob
is a string of text that can contain the characters <code>*</code> and <code>?</code> which serve
as placeholders for one or more other characters.  The phrase is so
commonly used that GitHub has a project <a href="https://github.com/begin/globbing">just for glob</a>.</p>
<p>How does it work?  The <code>?</code> character is a placeholder for any single character.
Therefore the glob <code>me?on</code> will match the strings <code>melon</code> and <code>menon</code>.
The string <code>mennon</code> will not match the glob as it only has one <code>?</code>
character, not two.</p>
<p>The <code>*</code> character is similar but is a placeholder for any number of any
characters. Keep things simple, the glob <code>me*on</code> will match <code>meon</code>,
both positve matches above, and the string <code>mennon</code>.  As a matter
of fact, it will also match a string starting with <code>me</code>, ending with
<code>on</code>, and having an insanely large number of characters between them.</p>
<p>So why was I worried about glob-based comparisons?  They look easy, do not
they?  Well, how do you deal with a glob like <code>me*e*on</code>?  The algorithm
to handle one <code>*</code> character is relatively simple.  Adding in support for
multiple <code>*</code> characters gets messy really quickly.  I’ll get into that
a bit more later, but it was that support that I was dreading.</p>
<h3 id="design_2">Design<a class="headerlink" href="#design_2" title="Permanent link">¶</a></h3>
<p>Making sure that I was thinking about the rest of the design clearly, I
sat back and just let
my mind wander and think about this rule.  One thing that was immediately
obvious was that any “fancy” headings that were not 100% text were
going to be a problem.  If an author adds the text <code># Heading *Me* One</code>,
the parser will translate it into three Text elements with two Emphasis
element in the middle.  Should I then match the plaintext or the resolved
text?  That was ambiguous enough that I decided to not support any Heading
elements that were not 100% plain-text.  One issue down.</p>
<p>The next issue was on how to process the entire set of Heading elements.
I could try and process as I went, but I felt that it would be too complex
to accomplish with little gain.  As such, I decided that at the end of
the document, the rule needed to example a list of all Heading elements
and their associated text.  With that complete picture in hand, it would
be a relatively simple matter of writing the Glob algorithm.  Two issues
down.</p>
<h4 id="glob_1">Glob<a class="headerlink" href="#glob_1" title="Permanent link">¶</a></h4>
<p>Ah, yes… a relatively simple matter… Glob algorithm.  There were
options there as well. I just had to decide which approach worked the
best in this situation.  One option that I had was to try and represent
each line as a given character, then using Python’s built in
<a href="https://docs.python.org/3/library/glob.html">Glob Library</a> to resolve it.
But after checking with the library, it only works on files and directories,
so I would have to write it myself anyways.  So little benefit of doing
a transform to an easier format and then another transforms back if there
was an error.</p>
<p>So given that I was going to need to write this myself, I decided to use
the compile option for the
<a href="https://docs.python.org/3/howto/regex.html">Python RegEx library</a>
as inspiration.  For this rule, I would take each part of the provided
configuration and determine if it was either a valid, plain-text Atx
Heading element or the <code>*</code> character.  In this way, I could handle any
configuration errors during the configuration phase, and not later. This
was going to be a simple loop with some extra checks for Atx Heading element
parts, but nothing too bad.</p>
<p>Given a compiled Glob to work with, the first thing I needed the algorithm
to do is to avoid any Glob code unless there is a wildcard character
present.  For a non-wildcard scenario, a simple check through the
entire compiled list against the actual Heading elements would be easy.
For the wildcard scenarios, I would need to handle any constant headers
and footers to get to the point where the algorithm could deal with
the wildcards themselves.  I was not sure where to go at that point,
but I decided I would do more design when I got there.</p>
<h3 id="testing-and-implementation_2">Testing and Implementation<a class="headerlink" href="#testing-and-implementation_2" title="Permanent link">¶</a></h3>
<p>In all, I created just four scenario test documents to test this rule.
I did not need any more.  As one of the variables in these scenarios
was the configuration, those four documents provided a solid enough
base for me to create all the scenario test functions.</p>
<h4 id="compiling-the-requirements">Compiling The Requirements<a class="headerlink" href="#compiling-the-requirements" title="Permanent link">¶</a></h4>
<p>Because of the nature of the design, I decided to allocate a block of time
specifically to the compiling and storing of the requirements.  The way
I look at it, if I did not get the internal form of the requirements correct,
I would be lucky if the actual comparisons worked.  It was better to be
sure the foundation was correct, so I invested the time there.</p>
<p>The actual compilation function was spot on what the requirements asked for,
allowing for a simple element structure:</p>
<div class="highlight"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">__compile</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">found_value</span><span class="p">):</span>
    <span class="n">found_parts</span> <span class="o">=</span> <span class="n">found_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">)</span>
    <span class="n">compiled_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">next_part</span> <span class="ow">in</span> <span class="n">found_parts</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">next_part</span> <span class="o">==</span> <span class="s2">"*"</span><span class="p">:</span>
            <span class="n">compiled_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_part</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">count</span><span class="p">,</span> <span class="n">new_index</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">collect_while_character</span><span class="p">(</span>
                <span class="n">next_part</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"#"</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="s2">"Element must start with hash characters (#)."</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span>
                    <span class="s2">"Element must start with between 1 and 6 hash characters (#)."</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">new_index</span><span class="p">,</span> <span class="n">extracted_whitespace</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">extract_any_whitespace</span><span class="p">(</span>
                <span class="n">next_part</span><span class="p">,</span> <span class="n">new_index</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">extracted_whitespace</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span>
                    <span class="s2">"Element must have at least one space character after any hash characters (#)."</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_part</span><span class="p">)</span> <span class="o">==</span> <span class="n">new_index</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span>
                    <span class="s2">"Element must have at least one non-space character after any space characters."</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">compiled_lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">count</span><span class="p">,</span> <span class="n">next_part</span><span class="p">[</span><span class="n">new_index</span><span class="p">:]))</span>
    <span class="k">return</span> <span class="n">compiled_lines</span><span class="p">,</span> <span class="bp">None</span>
</pre></div>
<p>Basically, go through the elements, looking for either a line with the
<code>*</code> character, or look for a valid plain-text Atx Heading element.  As one
of my frequent complaints about software are error messages that do not
help the user, I tried to add useful error messages detailing what the
error is.</p>
<p>This kept the list to compare against simple.  The entry was either a single
<code>*</code> character or a tuple with the hash count and the heading text.</p>
<h4 id="collecting-the-headings-and-associated-text">Collecting the Headings and Associated Text<a class="headerlink" href="#collecting-the-headings-and-associated-text" title="Permanent link">¶</a></h4>
<p>With the requirements compiling, it was then on to the collecting of
the Heading tokens and their Text data.  This proved to be relatively
easy:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">completed_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compiled_headings</span><span class="p">:</span>
        <span class="k">return</span>

<span class="k">def</span> <span class="nf">next_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">context</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__collected_tokens</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_atx_heading_end</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_setext_heading_end</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__all_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__collected_tokens</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__collected_tokens</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__collected_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compiled_headings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_atx_heading</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_setext_heading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__collected_tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="p">]</span>
</pre></div>
<p>This form actually took me a tiny bit of effort to get to as I struggled
with how to determine whether a Heading token was plain-text only.  In
the end, I just decided to collect all the tokens for the Heading, store
them in the list, and then decide later how to deal with them.  While it
may not be the most elegant way to deal with this problem, it was the
easiest.</p>
<h4 id="a-globbing-we-will-go">A Globbing We Will Go<a class="headerlink" href="#a-globbing-we-will-go" title="Permanent link">¶</a></h4>
<p>Rather than walking through the Glob code line by line, I thought it
would be more beneficial to walk through the design I did.  Globbing
a string is something that has weird cases in it.  To that extent, I
hope I did a good enough job in laying down the foundation for glob
comparisons in the above <a href="#glob">Glob section</a>.</p>
<p>Starting from that point, while whatever is being globbed is up to the
implementation, the most common way to think about it is with characters.
I believe this is due to the use of Glob for files and directories in Linux,
and that it easier to keep one character in your head than an entire
string.</p>
<p>As I detailed above, the algorithm for dealing with zero <code>*</code> characters
in a glob pattern is easy.  With no special characters, the comparison
becomes a simple comparison with no changes.  If the glob pattern is
<code>abc</code>, then those characters must appear in that order.  To make
sure that I had a good starting point, I implemented that code first.
I made sure to get all the simple scenario tests passing, and everything
was good.</p>
<p>I then went on to work out how to deal with one <code>*</code> character.  As dealing
with any number of any character is a harder issue to deal with, I focused
on finding out if there are any characters at the start of the glob or
the end of the glob that are not wildcards.  If that is that case, then
I can use my comparison function for zero <code>*</code> characters and deal with
both of those sections.  If the glob pattern only has one wildcard,
the start of the glob and the end of the glob will meet at the glob.</p>
<p>This was a bit more interesting to work through.  I had the scenario tests
mostly passing, but I had to focus on the algorithm.  It deals
a lot with a start index and an end index of each section.  It was really
easy to get the different values mixed up.  But I persevered and got
all the scenario tests passing.  And then on to the hardest part: multiple
wildcard characters!</p>
<p>Or so I thought.</p>
<h3 id="life-often-shows-up-when-you-least-expect-it">Life Often Shows Up When You Least Expect It<a class="headerlink" href="#life-often-shows-up-when-you-least-expect-it" title="Permanent link">¶</a></h3>
<p>I was hoping to get more done this week. However, due to
unrelated issues with both cars in our family, it became obvious
that life had other plans for me this week.  As I have mentioned
before, working on this project is a hobby for me, and I must
ensure that I keep the other parts of my life in balance.</p>
<p>Well, these car-related issues worked together this week to remove the
better part of a day from my personal schedule.  And I believe I made
the right choice by focusing on those issues.  However, by removing
those hours from my schedule, I was not able to finish
the work on Rule Md043.  Specifically, I was not able to handle
instances of multiple wildcard characters in the required
configuration value list.</p>
<p>Going over how to handle this in my head, I determined that I had
made significant progress on the rule itself to warrant it being
checked in. I added a custom warning and a new item to my Issues
List, just to make sure I had everything covered.  Hopefully I
will be able to get to it soon, but I feel that this was the
right decision to make.  Time will tell though.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>From a pure numerical standpoint, the number of completed rules
is now 26 and the number of rules remaining is now 5.  As my
expected benchmark was 3 completed rules per week, I was
successful in meeting that goal.  While I wanted to get more
rules done this week, I did not feel it was worthwhile shortchanging
Rule Md043 to achieve that.</p>
<p>And with five rules left to go, I have a real good shot at getting
the rules completed in the next week or two.  That was something
worth celebrating!  I felt good that I have made all this progress
and will know that I have something solid that people can use.</p>
<p>It is all coming together, and I like it!  I wish it would move
faster, but I know I will get there and soon.</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>I am almost so close to finishing off the rules that it is hard
for me to bear.  Will I reach it next week? Stay tuned!</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Another%20Three%20Done%21&url=https%3A//jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Another%20Three%20Done%21&amp;body=https%3A//jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-beta-release-i"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/08/23/markdown-linter-three-more-rules/" title="Previous: Markdown Linter - Three More Rules">Markdown Linter - Three More Rules</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/09/13/markdown-linter-back-to-work/" title="Next: Markdown Linter - Back To Work!">Markdown Linter - Back To Work!</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~15 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-08-30T00:00:00-07:00">Aug 30, 2021</time>
        <h4>Markdown Linter Beta Release</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2021/06/14/markdown-linter-getting-stuff-done/" title="Markdown Linter - Getting Stuff Done">Part 1: Markdown Linter - Getting Stuff Done</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/21/markdown-linter-elevating-extensions/" title="Markdown Linter - Elevating Extensions">Part 2: Markdown Linter - Elevating Extensions</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/28/markdown-linter-sometimes-you-have-to-go-backwards/" title="Markdown Linter - Sometimes You Have To Go Backwards...">Part 3: Markdown Linter - Sometimes You Have To Go Backwards...</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/" title="Markdown Linter - Full Of Sound And Fury">Part 4: Markdown Linter - Full Of Sound And Fury</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/02/markdown-linter-making-progress-on-new-rules/" title="Markdown Linter - Making Progress On New Rules">Part 5: Markdown Linter - Making Progress On New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/07/26/markdown-linter-getting-back-to-new-rules/" title="Markdown Linter - Getting Back To New Rules">Part 6: Markdown Linter - Getting Back To New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/09/markdown-linter-continuing-progress-on-implementing-new-rules/" title="Markdown Linter - Continuing Progress On Implementing New Rules">Part 7: Markdown Linter - Continuing Progress On Implementing New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/" title="Markdown Linter - Dealing With Rule Md027">Part 8: Markdown Linter - Dealing With Rule Md027</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/23/markdown-linter-three-more-rules/" title="Markdown Linter - Three More Rules">Part 9: Markdown Linter - Three More Rules</a>
            </li>
            <li  class="active-part">
            Part 10: Markdown Linter - Another Three Done!
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/09/13/markdown-linter-back-to-work/" title="Markdown Linter - Back To Work!">Part 11: Markdown Linter - Back To Work!</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/" title="Markdown Linter - Race To The Finish">Part 12: Markdown Linter - Race To The Finish</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>86</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>104</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>