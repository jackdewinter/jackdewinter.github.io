<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I talked about how my effort to work efficiently continues to pay dividends for the project. In this article, I talk about the work I put into getting Rule Md027 implemented. Introduction¶ Everyone has something that they are particular about. Depending on the person, there …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Dealing With Rule Md027 "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/" />
<meta property="og:description" content="Summary¶ In my last article, I talked about how my effort to work efficiently continues to pay dividends for the project. In this article, I talk about the work I put into getting Rule Md027 implemented. Introduction¶ Everyone has something that they are particular about. Depending on the person, there …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-08-16T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Dealing With Rule Md027 ">
<meta name="twitter:description" content="Summary¶ In my last article, I talked about how my effort to work efficiently continues to pay dividends for the project. In this article, I talk about the work I put into getting Rule Md027 implemented. Introduction¶ Everyone has something that they are particular about. Depending on the person, there …">

        <title>Markdown Linter - Dealing With Rule Md027  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/">
                Markdown Linter - Dealing With Rule Md027
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#i-do-not-give-up-easily">I Do Not Give Up Easily</a><ul>
<li><a href="#deciding-to-use-token-rules">Deciding To Use Token Rules</a></li>
<li><a href="#the-cost">The Cost</a></li>
<li><a href="#designing-for-the-container-tokens">Designing For The Container Tokens</a></li>
<li><a href="#designing-for-the-leaf-tokens">Designing For The Leaf Tokens</a></li>
<li><a href="#designing-for-the-inline-tokens">Designing For The Inline Tokens</a></li>
</ul>
</li>
<li><a href="#starting-to-implement">Starting To Implement</a><ul>
<li><a href="#implementing-for-the-container-tokens">Implementing For The Container Tokens</a></li>
<li><a href="#implementing-for-the-leaf-tokens">Implementing For The Leaf Tokens</a><ul>
<li><a href="#starting-with-paragraphs">Starting With Paragraphs</a></li>
<li><a href="#on-to-single-line-elements">On To Single Line Elements</a></li>
<li><a href="#complex-elements">Complex Elements</a></li>
<li><a href="#encompassing-elements">Encompassing Elements</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#simple-refactoring">Simple Refactoring</a></li>
<li><a href="#double-checking">Double Checking</a><ul>
<li><a href="#dropping-the-ball-on-inline-elements">Dropping The Ball On Inline Elements</a></li>
</ul>
</li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2021/08/09/markdown-linter-continuing-progress-on-implementing-new-rules/">last article</a>, I talked
about how my effort to work efficiently continues to pay dividends for the project.
In this article, I talk about the work I put into getting Rule Md027 implemented.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Everyone has something that they are particular about.  Depending on the person,
there might be a collection of things they are particular about.  While a few
of my things deal with “just making sense”, the one that I hit the
other week was with not getting something done.</p>
<p>Don’t get me wrong.  If you ask me to move a mountain, I will not be upset if
I don’t get that done.  Now, if you ask me to organize a conference because no
one else can do it, and if I have the support, I will give it my best shot.
I will probably kick myself along the way for the things that I didn’t anticipate
ahead of time, but I won’t kick myself too hard.  After all, I have never organized
a conference before.</p>
<p>But designing a rule for the
<a href="https://github.com/jackdewinter/pymarkdown">PyMarkdown project</a>?
I thought I could do that while sipping on a cold beverage and nibbling on some
carrot cake with the tunes up loud.  But a couple of weeks ago, I hit Rule
Md027 and that changed.  Given a 30-minute design window, I couldn’t even get
a basic design off the ground.  Even with a 10-minute extension, I was still
at ground zero.  It wasn’t that I didn’t get it done, it was that I should
have been able to get it done and didn’t.  It weighed on me.</p>
<p>I didn’t want to let that negativity get in the way of the other rules, so
I decided to give myself a week to design and implement the rule properly.
I wanted to get it done in less than a week, but if it took that long, it
took that long.  I just wanted to get it done.</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please consult the commits that occurred on
<a href="https://github.com/jackdewinter/pymarkdown/commit/d34c7ed2248c4728ce4c14b812bad6a6a2c87289">15 Aug 2021</a>.</p>
<h2 id="i-do-not-give-up-easily">I Do Not Give Up Easily<a class="headerlink" href="#i-do-not-give-up-easily" title="Permanent link">¶</a></h2>
<p>Roughly two weeks ago, at the start of my efficiency push, I started to
work on
<a href="https://jackdewinter.github.io/2021/08/02/markdown-linter-making-progress-on-new-rules/#rule-md027-false-start">Rule Md027</a>,
but failed to make it out of the design phase.  This week, I decided that
I was going to go back to that rule to properly design and implement it.</p>
<p>Why? Because I do not give up easily.  I have pride in my work, and the fact
that I had to bail on this rule, even temporarily, just did not sit right with
me.  This time, I knew I needed to give myself as much design time as I
needed to get the design right.  In the end, it took about five hours and
two small redesigns to make it happen.  The important thing is that I got there.</p>
<h3 id="deciding-to-use-token-rules">Deciding To Use Token Rules<a class="headerlink" href="#deciding-to-use-token-rules" title="Permanent link">¶</a></h3>
<p>The big problem that my design faced was that I needed to work off the
token information, not the line information.  However, I tried to not
acknowledge that and work with the line information instead.  Call me stubborn,
but I thought it would be easier to design it that way.  I knew that working
with line information on this rule would still be difficult, I just figured
that working with lines wouldn’t be as difficult as working with tokens.</p>
<p>From my original research on the original rule, it was clear that certain
lines, such as a line in a HTML Block element, did not trigger the original
rule.  Thinking things out, this made sense to me.  When specifying a HTML
Block element, such as:</p>
<div class="highlight"><pre><span></span><span class="o">&lt;!</span><span class="c1">-- this is an example --&gt;</span>
</pre></div>
<p>the author is very specific that anything within that HTML Block be represented
as-is in the document.  Therefore, it the author specifies:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">I</span> <span class="n">have</span> <span class="n">HTML</span> <span class="n">that</span> <span class="n">look</span> <span class="k">like</span><span class="p">:</span>
<span class="o">&gt;</span> <span class="o">&lt;!</span><span class="c1">--</span>
<span class="o">&gt;</span>  <span class="n">this</span> <span class="k">is</span> <span class="n">an</span> <span class="n">example</span>
<span class="o">&gt;</span> <span class="c1">--&gt;</span>
</pre></div>
<p>this new rule should assume that the author specifically decided to include that
extra space within the HTML Block.  The same argument follows for Fenced
Code Block elements and Indented Code Block elements.</p>
<p>I tried to find a way to work around cases like that one, and others,
but they all ended up being too expensive from a design point of view.  The
token already had this
information translated for me, so working with line information would
mean repeating some of that work to get this rule triggering correctly.
Thinking about it long and hard, I decided in the end that working
with the token information made more sense.  But I was also aware that
working with tokens would still require a fair amount of work.</p>
<h3 id="the-cost">The Cost<a class="headerlink" href="#the-cost" title="Permanent link">¶</a></h3>
<p>When I write rules that are line based, the calculations for where a given
rule triggers are easy: calculate the number of characters since
the start of the line and pass it to the <code>report_next_line_error</code> function
which reports that the rule was triggered.  Quick, easy, done.  With tokens,
it becomes a bit more complicated than that.</p>
<p>The difficult part about reporting on the triggering of a given token-based rule
is that the engine is restricted to information available in
the token.  For any single token, the only constants are the starting position
of the token and the information contained within the token.  Anything
that needs to be provided to report on the triggered rule needs to be
calculated from that.</p>
<p>It is not a high cost, but it costs the project the time required to
properly figure out the equation used to translate between the position
of the token and the position where the rule is triggered.  And based
on my research, that calculation was going to be different for each token.</p>
<h3 id="designing-for-the-container-tokens">Designing For The Container Tokens<a class="headerlink" href="#designing-for-the-container-tokens" title="Permanent link">¶</a></h3>
<p>Given all that information and a whole bunch of scribbles that I
used to work out issues, I was ready to focus on the design.  I knew
that the design was going to entail multiple levels of effort, but I
was prepared for that.</p>
<p>At the top level of the design are the container tokens, the two List tokens
and the Block Quote tokens.  As the rule is invoked for each token in
turn, the top level needs to track what container token is the one
that is currently active.  I consider a container token currently active if it is the
container token that is deepest in a stack of all container tokens
that have been opened but not closed.  The reason that this is
important is because Block Quote elements and List elements are
container elements, and therefore they can contain any container element
or leaf element.  Therefore, when processing the top level of the
tokens, the algorithm needs to track this information and only act
on any non-container tokens if those tokens occur while a Block
Quote token is active.</p>
<p>Basically, if this rule is called with a Markdown document that looks
like this:</p>
<div class="highlight"><pre><span></span><span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">test</span>
</pre></div>
<p>or:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">test</span>
</pre></div>
<p>or:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">test</span>
</pre></div>
<p>then the rule should never take any action for the text <code>this is a test</code>
outside of the top level of the design, because it never hits a state
where that text is encountered, and a Block Quote is currently active.</p>
<p>It is only those cases where a Block Quote token is currently active
that processing needs to proceed to the next level of the design. It
is with scenarios like the following where that extra processing is
needed:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">test</span>
</pre></div>
<p>or:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">test</span>
</pre></div>
<p>or:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="o">&gt;</span> <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">test</span>
</pre></div>
<p>Therefore, as part of the design, I knew I would have to keep track of the
current line of the active Block Quote token.  The information about
which characters started any line within a Block Quote token is stored
with the active Block Quote token.  While that information would not
affect whether the rule would trigger, I knew that it will be needed to
provide for an accurate column number of where the rule triggered.  If
the current Block Quote line is not correct, then the column number would not
be correct.  Not as bad as not triggering the rule, but still important.</p>
<p>With the container tokens dealt with, I needed to deal with the handling
of leaf tokens within the scope of an active Block Quote token.  That
was next!</p>
<h3 id="designing-for-the-leaf-tokens">Designing For The Leaf Tokens<a class="headerlink" href="#designing-for-the-leaf-tokens" title="Permanent link">¶</a></h3>
<p>Having dealt with the container tokens, in the next level of the design
I needed to deal with leaf tokens.  Trying to break things down into
manageable blocks of work, I organized the leaf tokens into four classes
that I needed to design for: single line tokens, complex single tokens,
text encompassing tokens, and everything else.</p>
<p>For the single line tokens, the action to take is relatively easy.
Single line elements such as the Thematic Break element only have one
line, so a simple check is required to determine if the rule is triggered.
Once that check has been performed, only the current Block Quote line needs
to be updated.</p>
<p>The next tokens to consider are the complex single tokens.  Currently the
only token that falls into this category is the Link Reference Definition,
but I am sure future work will add more tokens like this.  This group is
specific to tokens like the Link Reference Definition token where a single
token is defined with complex parts.  That makes this group unique
because while the rules for a newline within a part may be vary from
part to part, the triggering of this rule on any eligible whitespace
between parts is constant.  That is why the following Markdown document
will only trigger on this rule three times:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span>  <span class="p">[</span><span class="n">lab</span>
<span class="o">&gt;</span>  <span class="n">el</span><span class="p">]:</span>
<span class="o">&gt;</span>  <span class="o">/</span><span class="n">url</span>
<span class="o">&gt;</span>  <span class="ss">"tit</span>
<span class="ss">&gt;  le"</span>
</pre></div>
<p>The three trigger points are the whitespace on the first line before the
Link Label, the whitespace on the third line before the URL, and the
whitespace on the fourth line before the title.  Each of them deals with
whitespaces.  The other lines are special.</p>
<p>The next group of tokens, and the largest of the four groups, are the
text encompassing tokens.  What makes this group interesting is that
the handling of any Text tokens within the scope of these tokens is
dependent on the type of token that contains them.  The handling
for text in either of the two Code Block elements or HTML Block element
is different from the text in a SetExt Heading element, which is also
different from the text in the Atx Heading element or the Paragraph element.
From a design point of view, that meant that I would have to track
whichever of those encompassing tokens was active to enable me to
properly deal with any encompassed text.</p>
<p>With all those tokens out of the way, any remaining tokens fall into
a simple group called “everything else”.  This includes tokens like the
Emphasis token used to denote Emphasis within a block of text. The
distinction for these tokens is that there is no way that any of these
tokens can trigger the rule to occur, so they can be dismissed.  With
each token in this group, the nature of the token just precludes it
from being interesting to this rule.</p>
<h3 id="designing-for-the-inline-tokens">Designing For The Inline Tokens<a class="headerlink" href="#designing-for-the-inline-tokens" title="Permanent link">¶</a></h3>
<p>After designing for the other two classes of tokens, the only class that
was left to design for was the Inline tokens class.  Looking over the
use cases for teach token, I determined that I only needed to design for
three tokens: Links, Raw HTML, and Code Spans.  With every other inline
token, the token is interpreted inline or defined as to not exceed a
single line.  Therefore, if there are any extra space characters before that
token is encountered, those characters will be placed into a Text token.
That meant I only had to deal with the three outliers.</p>
<p>The Raw HTML token and the Code Span tokens were the easy ones to design
for.  Everything within the token is eligible, so one simple check is
sufficient.  But with the Link tokens, there are multiple parts, such as the
Link Labels, which are not eligible, and parts like the whitespace, which
are eligible.  Not too much of a difference, but one to keep track of.</p>
<p>Once one of those tokens triggered the rule to fire, I knew I would
have some non-trivial calculations to figure out the proper line
number and column number.  Because these tokens occur within leaf
tokens, I knew that I would have to do some interesting work to merge
the results of any of these tokens with their <em>parent</em> tokens.  But
I was okay with designing that part of the algorithms when I got to
it.</p>
<h2 id="starting-to-implement">Starting To Implement<a class="headerlink" href="#starting-to-implement" title="Permanent link">¶</a></h2>
<p>As with any good Test-Driven Development practitioner, I looked at
my scribbled notes and started writing scenario tests for each
of the scenarios I was interested in.  For each scenario test, I
created a new Markdown document in the <code>tests/md027</code> directory
and an accompanying disabled test in the <code>test_md027</code> Python module.</p>
<p>Going through all the relevant examples on my testing worksheet,
I ended up with 81 disabled scenario tests when I was done.  From
start to finish, it took me just over three and a half hours (including
short breaks) to add all those scenarios and their tests into the project.
To be clear, that was not getting the tests working, just entering them
in a disabled state.</p>
<p>From that effort, I knew that implementing this rule was not going to be
something that would be done in a day.  I was hoping I could keep it
to a week.</p>
<h3 id="implementing-for-the-container-tokens">Implementing For The Container Tokens<a class="headerlink" href="#implementing-for-the-container-tokens" title="Permanent link">¶</a></h3>
<p>As designed, the first thing that I needed to code was high-level
handling of the container tokens.  This proved to be very simple:</p>
<div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">next_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_block_quote_start</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_block_quote_end</span><span class="p">:</span>
            <span class="n">num_container_tokens</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">)</span>
            <span class="n">newlines_in_container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">leading_spaces</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_list_start</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_list_end</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span> <span class="ow">and</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_block_quote_start</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__handle_within_block_quotes</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
</pre></div>
<p>Without missing a beat, this followed the design that I had specified.
The <code>self.__container_tokens</code> list maintains what the active container
token is, being modified by both List tokens and Block Quote tokens. If
a Block Quote token is encountered, a bit more work is done to add an
entry in the <code>self.__bq_line_index</code> dictionary to track the index within
the Block Quote.  Finally, if the <code>token</code> variable is set to a non-container
token and the active container token is a Block Quote token, then the
<code>__handle_within_block_quotes</code> function is called to handle the processing.</p>
<p>With the container tokens design dealt with, it was on to the leaf tokens.</p>
<h3 id="implementing-for-the-leaf-tokens">Implementing For The Leaf Tokens<a class="headerlink" href="#implementing-for-the-leaf-tokens" title="Permanent link">¶</a></h3>
<p>For any readers who follow these articles, it should come as no surprise
that I started implementing the <code>__handle_within_block_quotes</code> function
as one humongous function.  As I have mentioned in other articles,
I prefer to code first, refactoring later when I have a more complete
picture of the code in question.</p>
<h4 id="starting-with-paragraphs">Starting With Paragraphs<a class="headerlink" href="#starting-with-paragraphs" title="Permanent link">¶</a></h4>
<p>For no other reason than Paragraph elements showing up more than any
other elements, I decided to start my work on the <code>__handle_within_block_quotes</code>
function with them:</p>
<div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">__handle_within_block_quotes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
        <span class="n">num_container_tokens</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_paragraph</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__last_leaf_token</span> <span class="o">=</span> <span class="n">token</span>
            <span class="k">for</span> <span class="n">line_number_delta</span><span class="p">,</span> <span class="n">next_line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                <span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">next_line</span><span class="p">:</span>
                    <span class="n">split_leading_spaces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">leading_spaces</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
                        <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
                    <span class="n">line_index</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span> <span class="o">+</span> <span class="n">line_number_delta</span><span class="p">)</span>
                    <span class="n">calculated_column_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_leading_spaces</span><span class="p">[</span><span class="n">line_index</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span>
                        <span class="n">context</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">line_number_delta</span><span class="o">=</span><span class="n">line_number_delta</span><span class="p">,</span>
                        <span class="n">column_number_delta</span><span class="o">=-</span><span class="n">calculated_column_number</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span> <span class="o">+=</span>
                <span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p>The Paragraph token is a special scenario in the PyMarkdown project.
But because Paragraph elements are the most common elements in Markdown, I
wanted to get it out of the way.  Due to the constraints of the
Paragraph element, any leading spaces on a line within a Paragraph element
are skipped.<sup id="fnref:example192"><a class="footnote-ref" href="#fn:example192">1</a></sup>  But because the PyMarkdown project deals in tokens
and not HTML, any skipped or translated characters must be accounted for in
the token.  Therefore, the Paragraph token contains a <code>leading_spaces</code> property
to contain those skipped spaces, separated by newline characters for readability.</p>
<p>Given that background, the code within the bounds of the <code>if token.is_paragraph</code>
part of the function use that <code>leading_spaces</code> property to figure out if any of
the individual lines begin with whitespace.  Once split into separate lines, a simple
iteration over the lines and a check for <code>if next_line</code> determines if leading
whitespace was removed for that line.  If so, the real fun begins.</p>
<p>As Paragraph elements can contains multiple lines of text, calculations
are performed to determine where in the paragraph the triggering
occurred.  The change from the token’s line number is easy to figure out.
Enumerating through the various lines in the <code>leading_spaces</code> property,
the change is simply the iteration through the <code>for</code> loop.  To keep things
simple, I named this variable <code>line_number_delta</code>.</p>
<p>For the column number, there is no way around using the line prefix information
stored in the Block Quote token.  Since the number of lines into the Block
Quote is kept track of in the <code>self.__bq_line_index</code> dictionary, the function
needs to calculate the proper index into that prefix list.  By taking the current
Block Quote token’s entry in that table and adding the iteration through the loop
(<code>line_number_delta</code>), the proper index is obtained.  With that calculation, the
length of the Block Quote prefix for that line is looked up, its length computed,
and the rule is triggered with a call to <code>report_next_token_error</code>.</p>
<p>Finally, to make sure the index within the Block Quote token remains
correct, the entry in the <code>self.__bq_line_index</code> dictionary is updated
to include the number of newline characters in the paragraph.</p>
<p>Phew! To be honest, I had some confidence that this would be one of the more difficult
elements to get right, and I was correct.  But it was also good that I
dealt with it early.  By working on this code and the ten or so tests
that deal directly with paragraph elements, I gave myself a good
example that I could use as a reference point.</p>
<p>And the testing was pivotal.  I was able to comment out the <code>skip</code>
test attribute, run the tests, and make any adjustments as necessary.
Slowly, the scenario test for Rule Md027 were starting to pass!</p>
<h4 id="on-to-single-line-elements">On To Single Line Elements<a class="headerlink" href="#on-to-single-line-elements" title="Permanent link">¶</a></h4>
<p>While it may be an oversimplification, the remaining handlers that I wrote
for handling their tokens are just variations on the Paragraph handler
from the last section.  Starting with the handler for Thematic
Break tokens, it was easier to implement than the Paragraph token’s
handler:</p>
<div class="highlight"><pre><span></span>        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_thematic_break</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="p">:</span>
                <span class="n">column_number_delta</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">column_number</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span>
                    <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">column_number_delta</span><span class="o">=</span><span class="n">column_number_delta</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
<p>As the exact information is already stored within the token, and because
that information cannot span lines, that handler simply checks to see
if the token was prefaced with any whitespace.  When that scenario
occurs, the reported position is adjusted by providing a new
calculation for the column number to report.  This is required because
negative deltas are used to present absolute positions on the line, and
not negative changes to the token’s column number.  As such, the
<code>column_number</code> is used as a base, subtracting the length of the found
whitespace, and reporting that as the absolute start.</p>
<p>After that calculation, adding <code>1</code> to the proper <code>__bq_line_index</code> entry
was trivial.  It needed to account for the single line containing the
Thematic Break, so adding <code>1</code> made sense.  And the <code>if</code> statement for
<code>token.is_blank_line</code> was even simpler, because the token’s line number
and column number are always the position where the rule triggers.
Hence, no <code>column_number_delta</code> variable was required.</p>
<h4 id="complex-elements">Complex Elements<a class="headerlink" href="#complex-elements" title="Permanent link">¶</a></h4>
<p>Link Reference Definitions tokens are essentially the same as
the previous two elements, just with more parts to take care of.  The
first part of handling this element is practically a copy of what
was written to handle the Thematic Break token:</p>
<div class="highlight"><pre><span></span>    <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_link_reference_definition</span><span class="p">:</span>
        <span class="n">scoped_block_quote_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="p">:</span>
            <span class="n">column_number_delta</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">column_number</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">column_number_delta</span><span class="o">=</span><span class="n">column_number_delta</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span>
            <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">link_name_debug</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">link_destination_whitespace</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">link_title_whitespace</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">link_title_raw</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
<p>The main difference so far is that the calculation for the number of
lines in the Paragraph token is a bit more complex.  Once that was
taken care of, I was able to work on the other two parts of that
handler: the whitespaces.</p>
<div class="highlight"><pre><span></span>        <span class="n">found_index</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">link_destination_whitespace</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">found_index</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">is_character_at_index_whitespace</span><span class="p">(</span>
            <span class="n">token</span><span class="o">.</span><span class="n">link_destination_whitespace</span><span class="p">,</span> <span class="n">found_index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="p">):</span>
            <span class="n">line_number_delta</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">link_name_debug</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="n">split_array_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span> <span class="o">+</span> <span class="n">line_number_delta</span><span class="p">)</span>
            <span class="n">split_leading_spaces</span> <span class="o">=</span> <span class="n">scoped_block_quote_token</span><span class="o">.</span><span class="n">leading_spaces</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">specific_block_quote_prefix</span> <span class="o">=</span> <span class="n">split_leading_spaces</span><span class="p">[</span><span class="n">split_array_index</span><span class="p">]</span>

            <span class="n">column_number_delta</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">specific_block_quote_prefix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span>
                <span class="n">line_number_delta</span><span class="o">=</span><span class="n">line_number_delta</span><span class="p">,</span> <span class="n">column_number_delta</span><span class="o">=</span><span class="n">column_number_delta</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>
<p>The first handler looks like parts of the handler for the Paragraph token.
Once that whitespace is found, a bit more work is required to calculate the
<code>column_number_delta</code> variable, but it just a variation of previous work.
Instead of using the <code>line_number_delta</code> returned by the <code>enumerate</code> function,
it is computed based on the parts of the element that come before that
whitespace, the information in the <code>token.link_name_debug</code> variable.
The Block Quote token’s <code>leading_spaces</code> variable is then split and the
index into that list of split values is calculated.  Then, just as with
the Paragraph token’s handler, the <code>column_number_delta</code> variable is set
to the length of that line’s prefix.</p>
<div class="highlight"><pre><span></span>        <span class="n">found_index</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">link_title_whitespace</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">found_index</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">is_character_at_index_whitespace</span><span class="p">(</span>
            <span class="n">token</span><span class="o">.</span><span class="n">link_title_whitespace</span><span class="p">,</span> <span class="n">found_index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="p">):</span>
            <span class="n">line_number_delta</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">token</span><span class="o">.</span><span class="n">link_name_debug</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="n">link_title_whitespace</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>

            <span class="n">split_array_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span> <span class="o">+</span> <span class="n">line_number_delta</span><span class="p">)</span>
            <span class="n">split_leading_spaces</span> <span class="o">=</span> <span class="n">scoped_block_quote_token</span><span class="o">.</span><span class="n">leading_spaces</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">specific_block_quote_prefix</span> <span class="o">=</span> <span class="n">split_leading_spaces</span><span class="p">[</span><span class="n">split_array_index</span><span class="p">]</span>

            <span class="n">column_number_delta</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">specific_block_quote_prefix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span>
                <span class="n">line_number_delta</span><span class="o">=</span><span class="n">line_number_delta</span><span class="p">,</span> <span class="n">column_number_delta</span><span class="o">=</span><span class="n">column_number_delta</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>
<p>This is again copied, almost verbatim, to handle the next whitespace part
of the Link Reference Definition token.  They are close enough to each
other that I will probably refactor them together in a future refactoring
effort.</p>
<p>Once again, the handling of this token was just repeating the work done
previously, with some small alterations.</p>
<h4 id="encompassing-elements">Encompassing Elements<a class="headerlink" href="#encompassing-elements" title="Permanent link">¶</a></h4>
<p>With most of the other work done, it was time to focus on the
encompassing elements.  To start, I picked the Atx Heading token,
which contains the Heading text between the Atx Heading token
and the end Atx Heading token.  To ensure that the function knows
it is dealing with another token between those two tokens, I added
some very simple handling of those Atx Heading tokens:</p>
<div class="highlight"><pre><span></span>    <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_atx_heading</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="p">:</span>
            <span class="n">column_number_delta</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">column_number</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">extracted_whitespace</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_next_token_error</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">column_number_delta</span><span class="o">=</span><span class="n">column_number_delta</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__last_leaf_token</span> <span class="o">=</span> <span class="n">token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__bq_line_index</span><span class="p">[</span><span class="n">num_container_tokens</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_atx_heading_end</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__last_leaf_token</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
<p>While there are variations on this code, like Fenced Code Block elements or
SetExt Heading elements which have a close line, almost all the encompassing
block handler functions are like this.  The only outlier is the end Fenced Code
Block toke handler, which has information about the closing fence characters.
But even that handler is simple, reusing elements from the Link Reference
Definition handler.</p>
<p>Now that the rule knows a token was found within one of these encompassing
elements, it was time to implement the handler for the Text token.  The
text within a SetExt Heading element is specially encoded to handle the
start and end of the line differently than a Paragraph token, so that
took a lot of the work.  The Code Block tokens and the HTML Block tokens
were easy to handle.  For those tokens, the text is as written, so no
analysis is needed.  Because of that, incrementing <code>__bq_line_index</code>
was all that was required.</p>
<p>And with that, I checked my handy list of things that I needed to
implement, and everything was checked off.  Along the way I had found
three different parser bugs and added them to the
<a href="https://github.com/jackdewinter/pymarkdown/blob/main/issues.md">Issues List</a>
to deal with later.</p>
<p>Things looked good with the rule, but I wanted to make sure I
had addressed every issue that I could find.  Therefore, it was
time to start looking over the scenario tests and double checking
everything.</p>
<h2 id="simple-refactoring">Simple Refactoring<a class="headerlink" href="#simple-refactoring" title="Permanent link">¶</a></h2>
<p>Having completed the large handler function for tokens, before
I went on, I knew that I needed to refactor it into separate
functions.  So, taking my time, I carefully created a new function
for each token, moving the handler code into that new function.</p>
<p>With the solid suite of scenario tests to back me up, I was
confident that any issue I introduced would be found.  But
that got me thinking.  Did I miss something?</p>
<h2 id="double-checking">Double Checking<a class="headerlink" href="#double-checking" title="Permanent link">¶</a></h2>
<p>Wanting to have confidence that I completed everything, I started
going through the scenario test data and validated that I had
taken care of all the scenarios that I could think of.  Along
the way, I added four more tests to the rule, bringing the
total of scenario tests to 85.</p>
<p>And I even found another bug.  Well, not really a bug, but
an inconsistency.  Given the Markdown document:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="k">simple</span> <span class="nb">text</span>
<span class="o">#</span> <span class="n">a</span>
</pre></div>
<p>the test failed with an unmatched Block Quote index.  Basically, the
number of newlines in the Block Quote token was not equal to the
number of newlines collected within the Block Quote.</p>
<p>After a quick look, I was interested to find that in the above case,
the Block Quote token’s <code>leading_spaces</code> field did not end with a
newline character.  Verifying that this seemed to be the only case
where it happened, I added this code to the <code>next_token</code> function to
deal with it for now:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">leading_spaces</span> <span class="ow">and</span> \
        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_tokens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">leading_spaces</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">):</span>
        <span class="n">newlines_in_container</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
<p>Everything was good… until it wasn’t.</p>
<h3 id="dropping-the-ball-on-inline-elements">Dropping The Ball On Inline Elements<a class="headerlink" href="#dropping-the-ball-on-inline-elements" title="Permanent link">¶</a></h3>
<p>I blame myself for doing something careless, I am just not sure
when I did it.  At some point along the weeklong implementation
of this rule, I had entries for Code Span, Raw HTML, and Links
on my To-Do list.  And somewhere along the line, I checked them
off.</p>
<p>What is even more embarrassing is that I double check my tests
and implementations to try and make sure that I don’t miss
things like this.  But when I did my double checks, I double
checked to ensure that I had all the correct scenario test
data.  And I did include scenario test data for those three
elements… I just never added the tests for them. I did not
think I had added one without the other, but obviously I did
for those elements.</p>
<p>As I found this out at 6pm on Sunday night, it was too late
to add in any fixes at that point.  So, I put it on a short
list of things to fix, and I want to get to it when I have some
spare time in between writing the other rules.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>Looking at the picture of a scoreboard that I have scribbled
on a piece of paper on my desk, the number of completed rules is
now 20 and the number of rules remaining is now 11.  I hope
that I don’t find many more rules like Rule Md027, but I
am confident I can still get the rules done quickly.</p>
<p>As to how I feel about Rule Md027, I must admit that it is
a bit of mixed bag.  On one hand, it was a monster rule, and
it took good design followed by good implementation to get it
to this point.  But the shadow of having missed the three
inline elements is also present.  To throw things in the
positive again, I did find a few parser bugs, which means
I can fix them before users find them.  As I said, a mixed
bag.</p>
<p>But in the end, I am still positive about how things are going.
Once I get the rules done, or at least a good first pass at
the rules, I am thinking about releasing a minor version
to include the new rules.  I think this is still a probable
thing, and I am kind of looking forward to it.</p>
<p>So yeah, I took some bumps, and I got some bruises.  But
I also got a monster of a rule mostly done.  That feels good!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>After a week of focusing only on one rule, I wanted to get back to making
more progress.  I hope I get more done this week!  Stay tuned!</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:example192">
<p>See <a href="https://github.github.com/gfm/#example-192">example 192</a> in the GFM specification. <a class="footnote-backref" href="#fnref:example192" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Dealing%20With%20Rule%20Md027&url=https%3A//jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Dealing%20With%20Rule%20Md027&amp;body=https%3A//jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-beta-release-g"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/08/09/markdown-linter-continuing-progress-on-implementing-new-rules/" title="Previous: Markdown Linter - Continuing Progress On Implementing New Rules">Markdown Linter - Continuing Progress On Implementing New Rules</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/08/23/markdown-linter-three-more-rules/" title="Next: Markdown Linter - Three More Rules">Markdown Linter - Three More Rules</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~19 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-08-16T00:00:00-07:00">Aug 16, 2021</time>
        <h4>Markdown Linter Beta Release</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2021/06/14/markdown-linter-getting-stuff-done/" title="Markdown Linter - Getting Stuff Done">Part 1: Markdown Linter - Getting Stuff Done</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/21/markdown-linter-elevating-extensions/" title="Markdown Linter - Elevating Extensions">Part 2: Markdown Linter - Elevating Extensions</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/28/markdown-linter-sometimes-you-have-to-go-backwards/" title="Markdown Linter - Sometimes You Have To Go Backwards...">Part 3: Markdown Linter - Sometimes You Have To Go Backwards...</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/" title="Markdown Linter - Full Of Sound And Fury">Part 4: Markdown Linter - Full Of Sound And Fury</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/02/markdown-linter-making-progress-on-new-rules/" title="Markdown Linter - Making Progress On New Rules">Part 5: Markdown Linter - Making Progress On New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/07/26/markdown-linter-getting-back-to-new-rules/" title="Markdown Linter - Getting Back To New Rules">Part 6: Markdown Linter - Getting Back To New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/09/markdown-linter-continuing-progress-on-implementing-new-rules/" title="Markdown Linter - Continuing Progress On Implementing New Rules">Part 7: Markdown Linter - Continuing Progress On Implementing New Rules</a>
            </li>
            <li  class="active-part">
            Part 8: Markdown Linter - Dealing With Rule Md027
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/23/markdown-linter-three-more-rules/" title="Markdown Linter - Three More Rules">Part 9: Markdown Linter - Three More Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/" title="Markdown Linter - Another Three Done!">Part 10: Markdown Linter - Another Three Done!</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/09/13/markdown-linter-back-to-work/" title="Markdown Linter - Back To Work!">Part 11: Markdown Linter - Back To Work!</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/" title="Markdown Linter - Race To The Finish">Part 12: Markdown Linter - Race To The Finish</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>71</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>89</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>