<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I talked about starting to work on getting rid of some long-standing issues: nested Container Block elements. In this article, I talk about continuing that work and dealing with the remaining nested block scenario tests. Introduction¶ I wish I could say that this was a …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Full Of Sound And Fury "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/" />
<meta property="og:description" content="Summary¶ In my last article, I talked about starting to work on getting rid of some long-standing issues: nested Container Block elements. In this article, I talk about continuing that work and dealing with the remaining nested block scenario tests. Introduction¶ I wish I could say that this was a …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-07-12T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Full Of Sound And Fury ">
<meta name="twitter:description" content="Summary¶ In my last article, I talked about starting to work on getting rid of some long-standing issues: nested Container Block elements. In this article, I talk about continuing that work and dealing with the remaining nested block scenario tests. Introduction¶ I wish I could say that this was a …">

        <title>Markdown Linter - Full Of Sound And Fury  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/">
                Markdown Linter - Full Of Sound And Fury
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#why-do-i-use-detailed-log-files">Why Do I Use Detailed Log Files?</a><ul>
<li><a href="#more-detail-does-mean-more-work">More Detail Does Mean More Work</a></li>
</ul>
</li>
<li><a href="#scenario-test-237">Scenario Test 237</a><ul>
<li><a href="#how-to-approach-that-change">How To Approach That Change</a></li>
<li><a href="#subtle-changes">Subtle Changes</a></li>
</ul>
</li>
<li><a href="#scenario-test-238">Scenario Test 238</a></li>
<li><a href="#cleaning-up-with-small-variations">Cleaning Up With Small Variations</a></li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2021/06/28/markdown-linter-sometimes-you-have-to-go-backwards/">last article</a>, I talked
about starting to work on getting rid of some long-standing issues: nested Container Block elements.
In this article, I talk about continuing that work and dealing with the remaining
nested block scenario tests.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>I wish I could say that this was a good week, but it was not.  It was not even this week
that I am about to talk about here; that was last week.  Despite my best intentions,
I got sick, and it has taken the better part of a week for me to get better.  To hear
me talk about it, please read my upcoming article, Autism and Patience Do Not Mix,
coming out later this week.</p>
<p>Before Monday afternoon when I got too sick to work, I had 90% of this article finished.
I knew I was getting sick, but I did not feel good about publishing something that was
only “mostly” done.  I hope my decision to delay publishing this article for
a week is okay with any readers.  I would rather postpone publishing an article
for a full week than to release something that I did not think was a quality article.</p>
<p>And on a similar level, I did not want the care that I put into that week’s work
to be glossed over by an article that was not on par with that work.  As I talk about
below, I was stunned to find out that there were only 2 examples out of 673 examples
in the GFM specification
that deal with relative indentation of block elements.  It was something that I knew
about and something that I should have dealt with earlier.  But with no pressure
from the specification’s examples to deal with relative indentation, it was not until
this week that I worked to resolve the issue.</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please consult the commits that occurred between
<a href="https://github.com/jackdewinter/pymarkdown/commit/60abfcb562098a63910dc3bc3dc954186df2a7ee">04 Jul 2021</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/9d3f1bb66b32fe8cec2cf3c4dde0ac141400435b">05 Jul 2021</a>.</p>
<h2 id="why-do-i-use-detailed-log-files">Why Do I Use Detailed Log Files?<a class="headerlink" href="#why-do-i-use-detailed-log-files" title="Permanent link">¶</a></h2>
<p>One thing that I do not think I have ever mentioned is why I use log file output
instead of just debugging the code interactively.  In normal everyday development, I do a bit of both
as the issue requires.  For me, the real understanding comes from looking at
a big picture and comparing it to other pictures.  Whether the right comparison pictures
are from earlier runs of the same scenario or pictures of similar scenarios depends on
what I am looking for.  Basically, I see it as a puzzle with lots of data that
I need to solve, and I love it!</p>
<p>While the success of this technique may vary from person to person, it just
works well for me.  If I am comparing the output of one test to another test, this technique
allows me to copy the relevant section of the log files to another editor, run the
tests again, and examine the both log file sections side-by-side.  If I did not
understand something well enough, I can reset my position in both log files to an
earlier point and restart my examination from those new positions.  Most importantly,
it allows me to see a larger sequence of values than the ones visible from a single
breakpoint within the code.  At it with that data that I can better see the bigger
picture.</p>
<p>For those reasons and others, more detailed log files just work better for
me.  Knowing the parser because of my experience with it, I find it easy to
follow along with how each line is parsed, even though the complicated
sections dealing with Container Block elements.  I have learned that I need
to usually ignore most of the “stuff” in those blocks of the logs unless
I am looking for something specifically to do with Container Blocks.</p>
<p>But even with all that good stuff working in my favor, that does not always
make the job of fixing issues easier.</p>
<h3 id="more-detail-does-mean-more-work">More Detail Does Mean More Work<a class="headerlink" href="#more-detail-does-mean-more-work" title="Permanent link">¶</a></h3>
<p>While there are benefits to using more detailed log files, there are drawbacks
as well.  If you are not used to the volume of data, it can be overwhelming.
Even being used to the volume, there are still times that I need to walk
away because it becomes overwhelming.  There are still times where I look
at all the data without the right mindset, and it all looks like gibberish.
I find closing my eyes and taking three or four deep breaths does wonders
for getting the right mindset, but even that does not always work.  Sometimes
I need to clear my mind by walking around for 10 to 15 minutes until my
head clears.</p>
<p>But in the end, my evaluation on whether the costs are worth the benefits always
produce a resounding “Yes!”.  But even with that yes, I do admit that there are
times, like with Scenario Test 237 and 238, that those costs and benefits
get tested… sometimes to their maximums.</p>
<h2 id="scenario-test-237">Scenario Test 237<a class="headerlink" href="#scenario-test-237" title="Permanent link">¶</a></h2>
<p>Starting with what I believed to be the easiest of the two disabled tests, I
started with Scenario Test <code>test_list_blocks_237</code>, quickly renamed <code>test_list_blocks_237x</code>:</p>
<div class="highlight"><pre><span></span>   <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">.</span>  <span class="n">one</span>
<span class="o">&gt;&gt;</span>
<span class="o">&gt;&gt;</span>     <span class="n">two</span>
</pre></div>
<p>Unlike the previous two tests, these two tests were introducing something
that was a core tenet to the nesting of Container Blocks:  relative spacing.
Not complaining to the writers of the
<a href="https://github.github.com/gfm/">GFM specification</a> too much,
but as this is a core concept of nested blocks, I wonder why the specification
allocated only two examples to this concept and not more.  With all seriousness,
every other example in their specification can be properly converted into
HTML without worrying about relative spacing.  So, what is relative spacing
or more properly <code>relative nested container block spacing</code>?</p>
<p>Basically, the GFM specification talks about how nested block spacing is not
absolute, but relative to the last Container Block element on that line.  To put
this into perspective, consider the above example.  When properly parsed,
the specification says that it will produce the following HTML output:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">blockquote</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">blockquote</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>one<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>two<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ol</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">blockquote</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">blockquote</span><span class="p">&gt;</span>
</pre></div>
<p>But if you look at the Markdown example with an absolute mindset, the text
<code>two</code> is clearly not indented enough to qualify as being within the
Ordered List element.  So what gives?</p>
<p>From a relative positioning point of view, the first line is broken down
into the following sections: <code>{space}{space}{space}&gt;{space}&gt;{space}</code> for
the two nested Block Quotes elements that start the line, <code>1.{space}{space}</code> for
the Ordered List element that is next on that same line, and <code>one</code> for the text
for first List Item of that Ordered List element.  Using that same
relative point of view, this means that there are four characters after
the Block Quote elements before the text of that List Block element begins.</p>
<p>Applying that to the last line of the example, the two nested Block
Quote elements take up <code>&gt;&gt;{space}</code>, with the following nested Ordered List element
coming into effect after the four space characters <code>{space}{space}{space}{space}</code>.
At that point, the text <code>two</code> is present.  This means that, relatively speaking,
the text <code>two</code> is validly indented to remaining part of the Ordered List element.
Looking at the HTML output above, this is indeed how that is parsed.</p>
<h3 id="how-to-approach-that-change">How To Approach That Change<a class="headerlink" href="#how-to-approach-that-change" title="Permanent link">¶</a></h3>
<p>In adding this support to the PyMarkdown parser, I was faced with two
options: make the parser’s handling of nested sections relative-aware
or make adjustments where needed.  While I would like to eventually
adjust the parser to be more relative-aware, I quickly figured out
that it would take quite a bit to make that change.  I spent a good
day going through some preview steps of what it would take, just
to get an idea of the effort.  If I had to guess, it would take
at least a month or two, if not more.  Seeing as I want to get the
PyMarkdown linter out there, that was out.  So, the only good option
left was to make adjustments where needed.</p>
<h3 id="subtle-changes">Subtle Changes<a class="headerlink" href="#subtle-changes" title="Permanent link">¶</a></h3>
<p>To be fully honest, getting to this set of changes took a long
time to figure out, including at least three times where I had to walk
away to clear my head.</p>
<p>The first part of solving that puzzle was recognizing from the
logs that the <code>__handle_block_quote_section</code> function was not
providing the right adjusted text.  Specifically, in handling
this case under normal situations, the correct number of space
characters are placed in the respective Block Quote token.  But
because they both start on the same line, things got messed up.
To correct this, I added the following code to ensure the
<code>adjusted_removed_text</code> and <code>adj_leading_spaces</code> variables both
had the correct values.</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span>
        <span class="n">container_start_bq_count</span>
        <span class="ow">and</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">[</span><span class="n">stack_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_block_quote</span>
    <span class="p">):</span>
        <span class="n">count_of_actual_starts</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">count_characters_in_text</span><span class="p">(</span>
            <span class="n">adjusted_removed_text</span><span class="p">,</span> <span class="s2">"&gt;"</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">count_of_actual_starts</span> <span class="o">!=</span> <span class="n">this_bq_count</span>
        <span class="n">adj_leading_spaces</span> <span class="o">=</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">[</span>
            <span class="n">stack_index</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="p">]</span><span class="o">.</span><span class="n">matching_markdown_token</span><span class="o">.</span><span class="n">leading_spaces</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_removed_by_container</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
            <span class="n">adj_leading_spaces</span> <span class="o">+</span> <span class="n">adjusted_removed_text</span>
        <span class="p">):</span>
            <span class="n">adj_leading_spaces</span> <span class="o">+=</span> <span class="s2">" "</span>
        <span class="n">adjusted_removed_text</span> <span class="o">=</span> <span class="n">adj_leading_spaces</span> <span class="o">+</span> <span class="n">adjusted_removed_text</span>
</pre></div>
<p>With that text now adjusted properly, it was on to modifications to
the <code>__handle_nested_container_blocks</code> function.  For this function,
the <code>indent_level</code> member variable of the start List Block token was
being set to a number that indicated absolute position, not relative
position.  To remedy that, I added code to calculate the indentation
difference between the original Block Quote element and the original
List Block element.  The <code>adjusted_indent_level</code> variable was then
adjusted to properly reflect the indentation relative to the Block
Quote element and how it was set on the current line.</p>
<div class="highlight"><pre><span></span>    <span class="n">indent_level</span> <span class="o">=</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">nested_list_start</span><span class="o">.</span><span class="n">indent_level</span>
    <span class="n">list_start_token_index</span> <span class="o">=</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_document</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
        <span class="n">parser_state</span><span class="o">.</span><span class="n">nested_list_start</span><span class="o">.</span><span class="n">matching_markdown_token</span>
    <span class="p">)</span>
    <span class="n">token_after_list_start</span> <span class="o">=</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_document</span><span class="p">[</span>
        <span class="n">list_start_token_index</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">]</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">parser_state</span><span class="o">.</span><span class="n">nested_list_start</span><span class="o">.</span><span class="n">matching_markdown_token</span><span class="o">.</span><span class="n">line_number</span>
        <span class="o">==</span> <span class="n">token_after_list_start</span><span class="o">.</span><span class="n">line_number</span>
    <span class="p">)</span>
    <span class="n">column_number_delta</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">token_after_list_start</span><span class="o">.</span><span class="n">column_number</span>
        <span class="o">-</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">nested_list_start</span><span class="o">.</span><span class="n">matching_markdown_token</span><span class="o">.</span><span class="n">column_number</span>
    <span class="p">)</span>
    <span class="n">adjusted_indent_level</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">column_number_delta</span> <span class="o">+</span> <span class="n">end_container_indices</span><span class="o">.</span><span class="n">block_index</span>
    <span class="p">)</span>
</pre></div>
<p>With those values calculated, it then allowed me to do the final changes
to the function.  Before the big change was added, I needed the function
to recompute the <code>indent_level</code> variable to allow for an adjustment to
the relative positioning.   However, before I reset <code>indent_level</code>, I
needed the algorithm to be aware of whether there was any difference
between the <code>indent_level</code> variable and the <code>adjusted_indent_level</code> variable,
so adjustments could be made later.</p>
<p>After all those changes, it came down to the two lines at the end of
the following example:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="n">indent_level</span> <span class="o">&gt;</span> <span class="n">adjusted_indent_level</span><span class="p">:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">indent_level</span> <span class="o">-</span> <span class="n">adjusted_indent_level</span>
    <span class="n">indent_level</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">column_number_delta</span> <span class="o">+</span> <span class="n">end</span>
<span class="o">...</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">parser_state</span><span class="o">.</span><span class="n">token_document</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_blank_line</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">end_container_indices</span><span class="o">.</span><span class="n">block_index</span> <span class="o">+</span> <span class="n">start_index</span><span class="p">)</span>
        <span class="o">&lt;</span> <span class="n">indent_level</span>
    <span class="p">):</span>
    <span class="o">...</span>                    
    <span class="k">elif</span> <span class="n">delta</span><span class="p">:</span>
        <span class="n">adj_line_to_parse</span> <span class="o">=</span> <span class="n">adj_line_to_parse</span><span class="p">[</span><span class="n">delta</span><span class="p">:]</span>
</pre></div>
<p>After all that work, the only thing that still needed to be
adjusted was the <code>adj_line_to_parse</code> variable containing the
current line.  Because both Container Block elements are processed
independently of any other elements, the <code>adj_line_to_parse</code> variable
is reset to remove any whitespace that is part of the whitespace for
one of the Container Block elements.  In this scenario, the right
amount of whitespace was not removed, leading the Leaf Block
element processing to be wrong.</p>
<p>By removing that extra whitespace, everything fell into place, and
it worked!  It was a long way to get there, but it was worth it.</p>
<h2 id="scenario-test-238">Scenario Test 238<a class="headerlink" href="#scenario-test-238" title="Permanent link">¶</a></h2>
<p>Taking a quick look at this issue, on the surface it seemed to be the
same issue as with scenario test 237, just the order in which the
different indents were applied were on the last line, not the first:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;-</span> <span class="n">one</span>
<span class="o">&gt;&gt;</span>
  <span class="o">&gt;</span>  <span class="o">&gt;</span> <span class="n">two</span>
</pre></div>
<p>Looking at the output tokens, everything looked fine, and the HTML was
being generated properly.  But on closer examination, there was one little
difference that changed the output of the Markdown generator: an extra
line of leading whitespace.</p>
<p>To make sure that the Block Quote element is being represented properly,
when each line inside of the Block Quote element is tokenized, the leading
spaces including the <code>&gt;</code> character are stored within the owning Block
Quote token.  This allows for it to be reconstructed without any issues as
all leading Block Quote information is present, even if it varies.  But in
this case, the leading spaces for the first Block Quote were added to the
token, followed by a newline character and a fully indented representation
of the second Block Quote element, both from that line.  While each one
was accurate by itself, when they were combined by the Markdown generator,
they added a lot of extra whitespace.  That was the issue.</p>
<p>It took a bit of head scratching before I figured it out, but I did
figure it out.  In a nutshell, because of two spaces between the first
Block Quote character and the second Block Quote character, they were not
interpreted as a “group” of Block Quote elements.  Rather, they were
interpreted as a Block Quote element, a space, and another Block Quote
element.</p>
<div class="highlight"><pre><span></span><span class="n">special_case</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">special_case_adjusted_text</span> <span class="o">=</span> <span class="bp">None</span>
<span class="k">if</span> <span class="p">(</span>
    <span class="n">container_start_bq_count</span>
    <span class="ow">and</span> <span class="n">stack_bq_count</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="ow">and</span> <span class="n">container_start_bq_count</span> <span class="o">!=</span> <span class="n">stack_bq_count</span>
<span class="p">):</span>

    <span class="n">stack_index</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">block_quote_token_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">[</span><span class="n">stack_index</span><span class="p">]</span><span class="o">.</span><span class="n">is_block_quote</span><span class="p">:</span>
            <span class="n">block_quote_token_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">block_quote_token_count</span> <span class="o">==</span> <span class="n">stack_bq_count</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">stack_index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">assert</span> <span class="n">stack_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">stack_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">)</span>
    <span class="n">matching_block_quote_token</span> <span class="o">=</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">[</span>
        <span class="n">stack_index</span>
    <span class="p">]</span><span class="o">.</span><span class="n">matching_markdown_token</span>
    <span class="k">if</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="ow">in</span> <span class="n">matching_block_quote_token</span><span class="o">.</span><span class="n">leading_spaces</span><span class="p">:</span>
        <span class="n">last_newline_index</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">matching_block_quote_token</span><span class="o">.</span><span class="n">leading_spaces</span><span class="o">.</span><span class="n">rindex</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">special_case_adjusted_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">matching_block_quote_token</span><span class="o">.</span><span class="n">leading_spaces</span><span class="p">[</span>
                <span class="n">last_newline_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">special_case</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<h2 id="cleaning-up-with-small-variations">Cleaning Up With Small Variations<a class="headerlink" href="#cleaning-up-with-small-variations" title="Permanent link">¶</a></h2>
<p>Having a Monday off and with this week’s article started, I wanted to see if
I could make some progress on two variations: one for scenario test 237 and
one for scenario test 238.  </p>
<p>As detailed above, the Markdown for scenario test 237 is:</p>
<div class="highlight"><pre><span></span>   <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">.</span>  <span class="n">one</span>
<span class="o">&gt;&gt;</span>
<span class="o">&gt;&gt;</span>     <span class="n">two</span>
</pre></div>
<p>where the indentation on the final line allows that line to be included
in the Ordered List element started on line 1.  The small variation there
was to create test function <code>test_list_blocks_237e</code> with one less space
character on that final line:</p>
<div class="highlight"><pre><span></span>   <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">.</span>  <span class="n">one</span>
<span class="o">&gt;&gt;</span>
<span class="o">&gt;&gt;</span>    <span class="n">two</span>
</pre></div>
<p>This reduction in indentation on that final line makes that final line
ineligible for the Ordered List element. I was pleasantly surprised that
it worked right away, without any changes required.</p>
<p>Scenario test <code>test_list_blocks_238a</code> includes a similar change, this
time adding an extra space on the final line to make it eligible for
the Unordered List element:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;-</span> <span class="n">one</span>
<span class="o">&gt;&gt;</span>
  <span class="o">&gt;</span>  <span class="o">&gt;</span>  <span class="n">two</span>
</pre></div>
<p>While this new test was not as successful as test function
<code>test_list_blocks_237e</code> was, it only required minimal changes
to make it work properly.  The HTML output was already consistent
with what was expected, but the Markdown generator had additional
whitespace in its output for the final line.  Specifically, when
that final line was parsed, the Paragraph token started with the
extraction of two space characters.  This meant that the regenerated
output had four space character between the final <code>&gt;</code> character and
the <code>two</code> text.</p>
<p>Addressing that issue did not require that much work.  In the
<code>__handle_nested_container_blocks</code> function, I added the following
code to reduce the number of spaces by the appropriate amount:</p>
<div class="highlight"><pre><span></span>    <span class="k">elif</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="n">nested_container_starts</span><span class="o">.</span><span class="n">block_index</span>
        <span class="ow">and</span> <span class="n">adj_line_to_parse</span>
        <span class="ow">and</span> <span class="n">adj_line_to_parse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">" "</span>
        <span class="ow">and</span> <span class="n">indent_was_adjusted</span>
        <span class="ow">and</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">nested_list_start</span>
    <span class="p">):</span>
        <span class="k">assert</span> <span class="n">adj_line_to_parse</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
            <span class="n">parser_state</span><span class="o">.</span><span class="n">nested_list_start</span><span class="o">.</span><span class="n">matching_markdown_token</span><span class="o">.</span><span class="n">extracted_whitespace</span>
        <span class="p">)</span>
        <span class="n">adj_line_to_parse</span> <span class="o">=</span> <span class="n">adj_line_to_parse</span><span class="p">[</span>
            <span class="nb">len</span><span class="p">(</span>
                <span class="n">parser_state</span><span class="o">.</span><span class="n">nested_list_start</span><span class="o">.</span><span class="n">matching_markdown_token</span><span class="o">.</span><span class="n">extracted_whitespace</span>
            <span class="p">)</span> <span class="p">:</span>
        <span class="p">]</span>
        <span class="n">already_adjusted</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<p>This code was added specifically to address the extra space characters
and to remove them from the adjusted line variable <code>adj_line_to_parse</code>.
If the indent was adjusted and the current line includes a nested list start
token, this code reduces that adjusted line variable by the list’s indent.
The code itself was made simpler by the handling of an increase in the spacing
already being handled previously in that same function.</p>
<p>After taking a bit to figure out that solution, once it was implemented,
everything worked fine.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>The full quote from Shakespeare’s Macbeth is:</p>
<blockquote>
<p>It is a tale told by an idiot, full of sound and fury, signifying nothing.</p>
</blockquote>
<p>Trying to mentally return to when I learned this line in high school, I
remember talking specifically about that line.  I seem to remember that we
were talking about how Macbeth’s wife had just died, and he did not see that
life contained any meaning for him after that point.
Over the years since high school, my thoughts on that line have changed a
bit.  I now think of that same line
in situations where someone goes on and on about something, only to have
it appear in real life as something with little sound or fury.</p>
<p>The work that I documented in this article really did feel like that.  When
I started the work, I was not sure how difficult the work was going to be,
only that it would require some changes.  Now, it may be because of the
research that I did to get prepared for these changes, but those changes
ended up
feeling… well… trivial.  I was worried that I was going to have to make
some grand changes to the project to accommodate this “little” issue that
needed to be fixed, and the actual work was “little”.</p>
<p>Do not get me wrong, I am grateful that those issues required less than
100 lines of code to change.  But at the same time, I realized that I had
built this issue up as “THE NASTY CHANGES REQUIRED TO…”<sup id="fnref:caps"><a class="footnote-ref" href="#fn:caps">1</a></sup> instead of
“yup, just some normal tweaking” changes.  For context, I spent a full evening working
on the research and trying simple changes out until I was convinced it would
take a more concerted effort to solve.  And even then, I did some more testing
to make sure that my research was correct. For me, usually that amount of
research leads to a lot of changes.</p>
<p>And maybe that is why I feel that it went from “sound and fury” to almost “nothing”:
I did proper research.  Sure, it took some time to figure out the correct decisions
to make based on that research, but it was that research that was pivotal.
For me, that is a just a good feeling to have.  While I was not able to show
any actual code as a result of that research, it helped me prune many decision
trees early on, resulting in allowing me to follow a quick path to
the actual work I needed to do.  Essentially, it pointed out the 90% of the
work that I should avoid and had me focus on the 10% of the work that would
be most beneficial.  And that helped a lot!</p>
<p>In the end, the way I see it, while the “sound and fury” of debugging is
usually where I expect the hard work to be, there are cases where the
“signifying (almost) nothing” portion of the debugging work is where it is at!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>After the week I have had being sick, I really am not sure what is going on yet.
Stay tuned!</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:caps">
<p>For any readers not fluent in text-speak or DM/IM-speak, the extended use of capital letters usually implies that the author of the text is yelling.  In this case, it would be more of a “booming load” voice, implying sound and fury. <a class="footnote-backref" href="#fnref:caps" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Full%20Of%20Sound%20And%20Fury&url=https%3A//jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Full%20Of%20Sound%20And%20Fury&amp;body=https%3A//jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-beta-release-d"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/06/28/markdown-linter-sometimes-you-have-to-go-backwards/" title="Previous: Markdown Linter - Sometimes You Have To Go Backwards...">Markdown Linter - Sometimes You Have To Go Backwards...</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/07/17/my-autism-and-my-patience-do-not-mix/" title="Next: My Autism and My Patience Do Not Mix">My Autism and My Patience Do Not Mix</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~13 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-07-12T00:00:00-07:00">Jul 12, 2021</time>
        <h4>Markdown Linter Beta Release</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2021/06/14/markdown-linter-getting-stuff-done/" title="Markdown Linter - Getting Stuff Done">Part 1: Markdown Linter - Getting Stuff Done</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/21/markdown-linter-elevating-extensions/" title="Markdown Linter - Elevating Extensions">Part 2: Markdown Linter - Elevating Extensions</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/28/markdown-linter-sometimes-you-have-to-go-backwards/" title="Markdown Linter - Sometimes You Have To Go Backwards...">Part 3: Markdown Linter - Sometimes You Have To Go Backwards...</a>
            </li>
            <li  class="active-part">
            Part 4: Markdown Linter - Full Of Sound And Fury
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/02/markdown-linter-making-progress-on-new-rules/" title="Markdown Linter - Making Progress On New Rules">Part 5: Markdown Linter - Making Progress On New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/07/26/markdown-linter-getting-back-to-new-rules/" title="Markdown Linter - Getting Back To New Rules">Part 6: Markdown Linter - Getting Back To New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/09/markdown-linter-continuing-progress-on-implementing-new-rules/" title="Markdown Linter - Continuing Progress On Implementing New Rules">Part 7: Markdown Linter - Continuing Progress On Implementing New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/" title="Markdown Linter - Dealing With Rule Md027">Part 8: Markdown Linter - Dealing With Rule Md027</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/23/markdown-linter-three-more-rules/" title="Markdown Linter - Three More Rules">Part 9: Markdown Linter - Three More Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/" title="Markdown Linter - Another Three Done!">Part 10: Markdown Linter - Another Three Done!</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/09/13/markdown-linter-back-to-work/" title="Markdown Linter - Back To Work!">Part 11: Markdown Linter - Back To Work!</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/" title="Markdown Linter - Race To The Finish">Part 12: Markdown Linter - Race To The Finish</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/07/12/are-scenario-tests-worth-it/" title="Are Scenario Tests Worth It?">Part 13: Are Scenario Tests Worth It?</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/07/25/plugging-away-at-the-issues/" title="Plugging Away At The Issues">Part 14: Plugging Away At The Issues</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2022/08/15/dealing-with-long-standing-issues/" title="Dealing With Long Standing Issues">Part 15: Dealing With Long Standing Issues</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>106</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>124</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>