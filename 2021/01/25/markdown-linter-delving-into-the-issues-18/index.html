<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I documented how I was working hard to get to the end of the unprioritized items in my issues list and on to the prioritized parts of the list. This article details the work that I am doing to make that push happen. Introduction¶ Now …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Delving Into the Issues - 18 "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" />
<meta property="og:description" content="Summary¶ In my last article, I documented how I was working hard to get to the end of the unprioritized items in my issues list and on to the prioritized parts of the list. This article details the work that I am doing to make that push happen. Introduction¶ Now …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-01-25T00:00:00-08:00" />
<meta name="twitter:title" content="Markdown Linter - Delving Into the Issues - 18 ">
<meta name="twitter:description" content="Summary¶ In my last article, I documented how I was working hard to get to the end of the unprioritized items in my issues list and on to the prioritized parts of the list. This article details the work that I am doing to make that push happen. Introduction¶ Now …">

        <title>Markdown Linter - Delving Into the Issues - 18  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/">
                Markdown Linter - Delving Into the Issues - 18
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#doing-some-simple-cleanup">Doing Some Simple Cleanup</a></li>
<li><a href="#upgrading-to-python-38">Upgrading To Python 3.8</a></li>
<li><a href="#more-fun-with-link-reference-definitions">More Fun With Link Reference Definitions</a><ul>
<li><a href="#github-flavored-markdown-vs-commonmark">Github Flavored Markdown vs CommonMark</a></li>
<li><a href="#which-to-choose">Which To Choose?</a></li>
<li><a href="#getting-back-to-it">Getting Back To It</a></li>
</ul>
</li>
<li><a href="#and-more-link-reference-definitions">And More Link Reference Definitions</a></li>
<li><a href="#fixing-disabled-tests">Fixing Disabled Tests</a></li>
<li><a href="#a-quick-fix-i-hope">A Quick Fix… I Hope!</a></li>
<li><a href="#that-weeks-big-thing">That Week’s Big Thing</a><ul>
<li><a href="#beware-of-special-cases">Beware Of Special Cases</a></li>
</ul>
</li>
<li><a href="#whoops">Whoops</a></li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/">last article</a>, I documented how
I was working hard to get to the end of the unprioritized items in my issues list
and on to the prioritized parts of the list.  This article details the work that
I am doing to make that push happen.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Now a week or so removed from the New Year’s Holiday break, it was refreshing to know
that I was still able to resolve a healthy collection of items from the issues list.
Sure, it was not the same volume as during the holiday, but it was still a healthy
volume of issues to resolve.</p>
<p>And I definitely felt that I was getting closer to the end of the initial phase of the
PyMarkdown project.  I was pretty sure that I would not be able to resolve every item
from the unprioritized section of the issues list this week, but I was confident that
it was going to happen in the week after.  I just had to maintain a good velicity of
resolving issues, and I would get there soon!</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/dcffbeb19cce01f2a4acdf51c572712b0e303af8">11 Jan 2021</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/8b0e5abc8ba7996ed35387c44914e3696b068885">17 Jan 2021</a>.</p>
<h2 id="doing-some-simple-cleanup">Doing Some Simple Cleanup<a class="headerlink" href="#doing-some-simple-cleanup" title="Permanent link">¶</a></h2>
<p>As always, I try and ease into the project work for the week with something simple.  This
week was no different.  And while this change might seem to be of no consequence to others,
to me it was a question of readability and searchability.  The task?  To replace newline
characters in the source code with <code>ParserHelper.newline_character</code> and to replace the
colon character (<code>:</code>) separating the extra data field for the Markdown tokens with
<code>MarkdownToken.extra_data_separator</code>.</p>
<p>While it might not be obvious to people that are not dealing with the source code, the
presence of those two characters in an unescaped and unreferenced form had caused me a lot
of frustration.  I guess if I had to pin down a cause why that happened, it was because
a newline character and a single colon character are easy to miss when scanning through
source code.  I wanted something that I could easily find, and not something that I would
easily miss, as had happened numerous times during debugging sessions.  For me, the
cost of this change was easily outweighed by the benefit for readability.</p>
<p>It was not a change that fixed an issue or enabled a scenario tests, but I was able
to notice the difference almost instantly.  It just helped me see the code better,
and that was its goal!</p>
<h2 id="upgrading-to-python-38">Upgrading To Python 3.8<a class="headerlink" href="#upgrading-to-python-38" title="Permanent link">¶</a></h2>
<p>Having started a year ago, Python 3.7 was the stable release of Python at the time the
project started.  At that time, Python 3.8 had just been released on 14 October 2019
<sup id="fnref:courtesy"><a class="footnote-ref" href="#fn:courtesy">1</a></sup>, a couple of weeks before I started working on the code.  With the
<a href="https://github.com/jackdewinter/pymarkdown/commit/d2c3b2c2cbbc6e9f5524c38571dedcec305915b0">first commit</a>
of the source code on 22 Nov 2019, it just seemed like a safer bet to stay with version
3.7 until the bugs were worked out of the then brand new Python release.</p>
<p>Just over a year later, with Python 3.9 released on 15 Oct 2020<sup id="fnref2:courtesy"><a class="footnote-ref" href="#fn:courtesy">1</a></sup>, it felt like a
good time to upgrade one minor version with the same reasoning in mind.  However, there was
also another reason: performance.  Having started to explore the performance of the project
on sample Markdown pages, I found that the project’s parser was taking a long time to
parse a simple Markdown file.  Using
<a href="https://docs.python.org/3/library/profile.html#module-cProfile">cProfile</a> and
<a href="https://jiffyclub.github.io/snakeviz/">SnakeViz</a>,
I knew that the number one problem that I had with performance was the way I used log
statements.  Without going too far into my research<sup id="fnref:moreLater"><a class="footnote-ref" href="#fn:moreLater">2</a></sup>, in order solve the
performance issue while keeping the extra functionality that helped me debug more
efficiently, I would soon need to write my own logging wrapper.  To do this properly, my
<a href="https://docs.python.org/3/library/logging.html#logging.Logger.debug">research on logging</a>
indicated that I would need to use the <code>stacklevel</code> argument to allow the wrapper to
function while logging the location where the wrapper’s log statement was called from.
The catch?  It was introduced in Python 3.8.</p>
<p>With a good reason to update and a good, stable version of Python 3.8 to update to, I
proceeded with the upgrade with relatively few issues.  The main issue that I hit was that
I needed to ensure that I uninstalled Python 3.7 in the project, install Python 3.8 on my
system (including all environment variables), and then install Python 3.8 in the project.
Once that was done, the only other issue that I had was with the
<a href="https://pypi.org/project/black/">Black</a>
Python formatter.  In that case, I needed to examine the graph for that package and make
sure that I installed the correct version of the dependent library in the project.</p>
<p>After that small headache, which took minutes to solve, everything was working fine and continues to work fine.</p>
<h2 id="more-fun-with-link-reference-definitions">More Fun With Link Reference Definitions<a class="headerlink" href="#more-fun-with-link-reference-definitions" title="Permanent link">¶</a></h2>
<p>The first thing to mention about the next task is that while the commit was performed
earlier than the 3.8 Upgrade commit, chronologically this task came after the upgrade
task.  The reason that this is relevant is that the project uses the default settings
for Black, and either those defaults or the algorithm implementing the line folding
changed after the upgrade was completed.  Why is this relevant?  While the commit itself
looks like it has a lot of changes, many of those changes occurred in folding the lines
according to upgraded settings.  And as I was focused on the Link Reference Definitions,
I did not notice those formatting changes until after I had made a number of changes.
It was just easier to commit them together at that point than to pull them apart.</p>
<p>Other than that noise, there were three new scenario tests introduced, testing
Link Reference Definition elements broken up across container block boundaries.  The
first test added, test function <code>test_link_reference_definitions_extra_01</code>, was created
with a single Unordered List element character, followed by a valid Link Reference
Definition spread over two lines, with the second line not being indented:</p>
<div class="highlight"><pre><span></span><span class="o">-</span><span class="w"> </span><span class="o">[</span><span class="n">foo</span><span class="o">]</span><span class="err">:</span><span class="w"></span>
<span class="o">/</span><span class="n">url</span><span class="w"></span>
</pre></div>
<p>The second test, function <code>test_link_reference_definitions_extra_02</code>, used the same
format, but used a Block Quote element prefix instead of an Unordered List prefix.
Finally, to provide a touchstone, I added function
<code>test_link_reference_definitions_extra_02</code> that has both lines of the Link Reference
Definition preceded by the Block Quote element prefix.  While it was a duplicate
test, I felt it was a good reminder of how a test with both lines worked, and thus
it was a good reference test.</p>
<p>Now, according to the specification, the List element continues if the next line starts
with enough whitespace
to maintain the indent or if it is a continuation of a Paragraph within the list.  As the
Link Reference Definition is not a Paragraph when parsed the first time, the second line
terminates the list, and causes the Link Reference Definition to be requeued and parsed as
a normal Paragraph on the second parse through.  Or so I thought.</p>
<h3 id="github-flavored-markdown-vs-commonmark">Github Flavored Markdown vs CommonMark<a class="headerlink" href="#github-flavored-markdown-vs-commonmark" title="Permanent link">¶</a></h3>
<p>While both specification are usually in sync with each other, sometimes the
<a href="https://github.github.com/gfm/">GFM Specification</a>
and the reference CommonMark implementation
<a href="https://github.com/commonmark/commonmark.js">CommonMark.Js</a>
called from
<a href="https://johnmacfarlane.net/babelmark2/">Babelmark 2</a>
differ in small implementation details.  I had experimented with the Block Quote
scenario test for three or so hours before I submitted a question to the
<a href="https://talk.commonmark.org/t/block-quotes-laziness-and-link-reference-definitions/3751">CommonMark forums</a>
asking if I had misunderstood something in the specification.</p>
<p>The answer that came back was a supportive answer, but at the same time, an honest answer.
The approach that CommonMark’s reference parser had taken was to parse the lines as the
start of an Unordered List followed by a Paragraph block.  Only after that Paragraph block
had been parsed, with the paragraph continuation kicking in, does the parser look for a
Link Reference Definition at the start of that Paragraph.</p>
<p>Is this 100% according to the GFM specification?  No.  But does it make sense for the
CommonMark team to do this?  I would argue yes.  Getting Link Reference Definitions correct
in the PyMarkdown parser has continued to be a pain to this day.  Based on my limited
experience, while
Link Reference Definitions can be spread over multiple lines, there are very few cases
where that is done in “real life”.  From a correctness viewpoint, if I had to guess on the
percentages,
I believe I would estimate that their approach correctly parses 99.5% of the Link Reference
Definition elements, with only some “weird” multiline Link Reference Definition scenarios
not being parsed.</p>
<p>But that left me with a decision.  What was the correct thing to do for the PyMarkdown
parser?</p>
<h3 id="which-to-choose">Which To Choose?<a class="headerlink" href="#which-to-choose" title="Permanent link">¶</a></h3>
<p>After thinking about this overnight, I decided that the best approach for the project was
to align with the CommonMark reference implementation, while also discussing the
differences from
the GFM Specification with the CommonMark team in the forums.  By making that choice,
I had confidence that I would have something to compare against for correctness that was
both concrete and
measurable.  It either would parse properly against <code>commonmark.js 0.29.2</code> and be
considered correct or it would
not and be considered a parsing failure. As for any differences, I could clearly note
them in documentation somewhere, and talk about them on the forums with the owners of
CommonMark and the GFM specification, trying to improve both.  It was not a perfect answer,
things rarely are perfect.</p>
<p>With that decision in hand, I marked all three new tests as skipped before starting to
work on the Block Quote functions.  Based on what I was seeing in the test failures,
everything looked fine in the HTML output, except that the output was missing an entry
in the Block Quote for the parsed line.  Taking a wild guess, I determined that I needed
to introduce something in the <code>handle_block_quote_block</code> function to ensure that the number
of lines in the Block Quote element were correct.</p>
<p>Surprisingly, that was the fix that was needed.  No changes in the Markdown transformer
were needed, and no changes in the consistency check was needed.  Not sure what I had
going on that evening, I decided to mark the List Block version of the scenario test,
the function <code>test_link_reference_definitions_extra_01</code>, as disabled.  Cleaning up
the code and committing it to the repository.  It was a good place to stop while I
figured out what was going on in the evening.</p>
<h3 id="getting-back-to-it">Getting Back To It<a class="headerlink" href="#getting-back-to-it" title="Permanent link">¶</a></h3>
<p>With the plans for that evening falling through, I found that I had a couple of hours
free that evening. Not wanting to let them go to waste, I decided to see if I could tackle
the
<code>test_link_reference_definitions_extra_01</code> function that I elected not to get working
in the previous section.  To ensure I was moving in the correct direction, I added
extra variations of the test that included one and two spaces before the second half
of the Link Reference Definition element, as well as one with each half of the Link
Reference Definition in its own List Item.</p>
<p>As I have had numerous problems with List Blocks in the past, I expected to expend a
lot of effort to clean these cases up, but only a little bit of effort was required.
Specifically, the only change that was needed with in the <code>ListBlockProcessor</code> class
and its <code>__check_for_list_closures</code> function.  Like the previous section and the
Link Reference Definition element that spanned Block Quote element levels, the CommonMark
reference implementation was treating the Link Reference Definition text as a Paragraph
before detecting the Link Reference Definition element itself.  To replicate this
behavior, I needed to modify the <code>__check_for_list_closures</code> function to keep the
‘paragraph’ open if it was parsing a Link Reference Definition.</p>
<p>Making those modification, I was able to get the main function,
<code>test_link_reference_definitions_extra_01</code>, working, as well as the sibling functions
<code>test_link_reference_definitions_extra_01a</code> and
<code>test_link_reference_definitions_extra_01b</code>.  This meant that a Link Reference
Definition split over a List Block and the end of that block with various amounts of
indentation was working properly.  However, function
<code>test_link_reference_definitions_extra_01c</code>, where I split the Link Reference Definition
over two List Items was not working at all.  With my time used up in the evening, I
marked it as skipped, cleaned it up, committed it, and went to sleep for the night.</p>
<h2 id="and-more-link-reference-definitions">And More Link Reference Definitions<a class="headerlink" href="#and-more-link-reference-definitions" title="Permanent link">¶</a></h2>
<p>As I was looking at the content of the existing scenario tests, I noticed that I
did not have a couple of tests that had simple multi-line Raw HTML elements and
multi-line Code Span elements in links.  Basically, I wanted to take
<a href="https://github.github.com/gfm/#example-644">example 644</a> for Raw HTML elements:</p>
<div class="highlight"><pre><span></span><span class="n">foo</span> <span class="o">&lt;!</span><span class="c1">-- this is a</span>
<span class="k">comment</span> <span class="o">-</span> <span class="k">with</span> <span class="n">hyphen</span> <span class="c1">--&gt;</span>
</pre></div>
<p>and <a href="https://github.github.com/gfm/#example-345">example 345</a> for Code Spans:</p>
<div class="highlight"><pre><span></span><span class="o">``</span>
<span class="n">foo</span>
<span class="n">bar</span>  
<span class="n">baz</span>
<span class="o">``</span>
</pre></div>
<p>and place them within both Inline Links and Reference Links.  I was hoping that this
was a simple test, but I was not sure.</p>
<p>Adding all four tests, (two for Inline Links and two for Reference Links), I was pleasantly
surprised that all four tests passed without any changes.  While I am aware that I am
getting closer and closer to the initial release of the project, I still find that I
expect things to fail as a default setting.  As I am usually an optimistic person, my
only explanation for that failure viewpoint is one of writing too many automation tests
in my career.  When I note something down in the issues list, I believe that I feel that
most of those items are going to be things that I forgot to cover, not things that I wish
to ensure are covered.</p>
<p>Regardless, I need to figure that out and work on it a bit.  I do have a lot of confidence
in the PyMarkdown project and its accuracy, and I need to project that more.</p>
<h2 id="fixing-disabled-tests">Fixing Disabled Tests<a class="headerlink" href="#fixing-disabled-tests" title="Permanent link">¶</a></h2>
<p>After a good night’s sleep and a good day’s worth of work under my belt, I settled down
in the evening to work on the next issue: enabling test functions
<code>test_block_quotes_extra_02ax</code> to <code>test_block_quotes_extra_02ad</code>.  The good news was
that the HTML transformer and the Markdown transformer were both working properly.
The bad news was that the consistency checks were failing for all these tests.</p>
<p>It took me a bit to get going that evening, but when I did, it was obvious to me that the
problem was that the consistency checks were not recognizing the active Block Quote
element.  Following along in the <code>verify_line_and_column_numbers</code> method, it became
obvious that the code:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="n">container_block_stack</span> <span class="ow">and</span> <span class="n">container_block_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_block_quote_start</span><span class="p">:</span>
</pre></div>
<p>was not evaluating to <code>true</code> for the four test functions that I was evaluating.  But
how to fix them?</p>
<p>It took me a while to realize that the reason that the condition was not evaluating to
<code>True</code> was that the Block Quote token was not always the last token on that list.
When I read the variable named <code>container_block_stack</code>, in my head I was parsing it as
“the stack for container Block Quotes”, not “the stack for container blocks”.  Once
I figured that out, the answer became obvious.  I created a new function
<code>find_last_block_quote_on_stack</code> that went back in the stack until it found to last
Block Quote token and returned it.  From there, I replaced any occurrence of
<code>container_block_stack[-1]</code> with <code>last_block_quote_token</code>.  Therefore, the code
from above became:</p>
<div class="highlight"><pre><span></span>    <span class="n">last_block_quote_token</span> <span class="o">=</span> <span class="n">find_last_block_quote_on_stack</span><span class="p">(</span>
        <span class="n">container_block_stack</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">last_block_quote_token</span><span class="p">:</span>
</pre></div>
<p>I ran the tests, and after clearing up a couple of typing mistakes, the tests all
worked properly, and they were now passing!</p>
<!--- pyml disable-next-line no-trailing-punctuation -->
<h2 id="a-quick-fix-i-hope">A Quick Fix… I Hope!<a class="headerlink" href="#a-quick-fix-i-hope" title="Permanent link">¶</a></h2>
<p>Looking at the end of the uncategorized section of the issues list, there was one item
that I felt confident that I could quickly deal with:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="mi">634</span><span class="p">,</span> <span class="n">but</span> <span class="n">forcing</span> <span class="n">an</span> <span class="n">html</span> <span class="n">block</span>
</pre></div>
<p>To start working on this item, I made six copies of test function <code>test_html_blocks_123</code>.
The first copy was in a List Block element, the next three copies were in various forms
of a Block Quote element, the fifth copy was within a SetExt Heading element, and the
last copy was within an Atx Heading element.  The hard part of each of these tests was
that I needed to make sure I was generating an HTML Block token and not a Raw HTML
token.  That took extra care but did not slow me down that much.</p>
<p>Like a handful of other issues like this that I have fixed, the answer to this
one leapt out at me as soon as I looked through the log files.  When the next line
was examined to figure out if the Block Quote element should be continued, the
<code>check_for_lazy_handling</code> was allowing it to continue.  The only issue here was that
it was an HTML block, a leaf block type that does not have any continuation logic in
the specification.  Having noticed that, it was easy to change the following code:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span>
        <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_code_block</span>
        <span class="ow">or</span> <span class="p">(</span><span class="n">is_leaf_block_start</span><span class="p">)</span>
    <span class="p">):</span>
</pre></div>
<p>to:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span>
        <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_code_block</span>
        <span class="ow">or</span> <span class="n">parser_state</span><span class="o">.</span><span class="n">token_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_html_block</span>
        <span class="ow">or</span> <span class="p">(</span><span class="n">is_leaf_block_start</span><span class="p">)</span>
    <span class="p">):</span>
</pre></div>
<p>thereby fixing the issue.  Running the scenario tests again, the tests were indeed fixed
without needed any other changes.</p>
<h2 id="that-weeks-big-thing">That Week’s Big Thing<a class="headerlink" href="#that-weeks-big-thing" title="Permanent link">¶</a></h2>
<p>Wrapping up the work for that week, I wanted to make another dent in the issues list,
so I decided to at least get the tests set up for the following item:</p>
<div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">links</span> <span class="k">with</span> <span class="o">&amp;</span> <span class="k">and</span> <span class="err">\</span> <span class="k">with</span> <span class="k">inner</span> <span class="n">link</span> <span class="k">to</span> <span class="n">mine</span>
    <span class="o">-</span> <span class="n">see</span> <span class="n">__collect_text_from_blocks</span>
</pre></div>
<p>The base concept of this item was simple: create a group of tests to verify how inline
elements were represented when placed within a Link element.  To make sure that I was
doing a good scenario test, I made the choice to use a Reference Link element.  By
doing this, I would be testing the link label normalization code and the representation
code at the same time.</p>
<p>Starting with <code>test_reference_links_extra_03x</code>, I created a Link element with a link
label that contained a backslash in the link label:</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]:</span> <span class="o">/</span><span class="n">uri</span>

<span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]</span>
</pre></div>
<p>From there, I then created a copy of that test that encapsulated that link label within
another link label:</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="n">xx</span><span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]</span><span class="n">yy</span><span class="p">](</span><span class="o">/</span><span class="n">uri</span><span class="p">)</span>

<span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]:</span> <span class="o">/</span><span class="n">uri1</span>
</pre></div>
<p>and finally, I created a copy of that test, changing the Link element to an Image element:</p>
<div class="highlight"><pre><span></span><span class="o">!</span><span class="p">[</span><span class="n">xx</span><span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]</span><span class="n">yy</span><span class="p">](</span><span class="o">/</span><span class="n">uri</span><span class="p">)</span>

<span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]:</span> <span class="o">/</span><span class="n">uri1</span>
</pre></div>
<p>Then, after a bit of thinking, I decided there was only one combination I was missing,
so I added that:</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="n">xx</span><span class="o">!</span><span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]</span><span class="n">yy</span><span class="p">](</span><span class="o">/</span><span class="n">uri</span><span class="p">)</span>

<span class="p">[</span><span class="n">bar</span><span class="err">\\</span><span class="n">foo</span><span class="p">]:</span> <span class="o">/</span><span class="n">uri1</span>
</pre></div>
<p>That being done, I then repeated that process with <code>&amp;amp;</code> and <code>&amp;copy;</code> for character
entity references, code spans, emphasis, autolinks, raw HTML, and hard line breaks.
By the time I was done, I had added 40 scenario tests to cover all these cases.</p>
<p>Starting to execute the scenario tests, all the tests that just dealt with Link elements
were passing without any changes.  The Image elements, they were a different story.
The failures seemed to stare back at me, standing in the way of me writing the
article for that week.  It was just time to start debugging and figuring things out.</p>
<p>After a bit of debugging, I seemed to notice that the test failures seemed to be in three
separate groups of issues.  The first group of issues was that the
<code>__collect_text_from_blocks</code> function used to grab the existing tokens and render them
as text was not complete.  But that was not the entire issue, but I felt that there
was too much “noise” in the way for me to see the issue clearly.  Resolving to reduce
the noise in the issue, I started working on the main part of the issue.  In the cases
where the inline element was on its own inside the parent
Link element, the Code Span element, the Raw HTML element, and the Autolink element
were not representing their elements properly.  A bit of exploration and debugging took
care of that.  With that noise out of the way, I was able to see the other part of that
issue better, and added the condition:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_inside_of_link</span><span class="p">:</span>
</pre></div>
<p>at the start of each of those handlers.  The noise that I had experience was simply that
in cases where a possible Link element was within another Link element’s link label,
each of the changed elements just needed to emit nothing to the collection.  Running
the tests again, it verified that observations, but I also saw something else.</p>
<p>Only after getting rid of those issues was I able to see that the
<code>__consume_text_for_image_alt_text</code>
function was not handling Emphasis start and end elements properly, failing an assert
near the end of that function.  That fix was easy, adding four lines to the <code>elif</code>
statement:</p>
<div class="highlight"><pre><span></span>    <span class="k">elif</span> <span class="n">inline_blocks</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_inline_emphasis</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">inline_blocks</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_inline_emphasis_end</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>
<p>With both of those issues dealt with, the couple of failures that remained were easy ones.
Looking at the HTML output, there were a number of <code>/a</code> character sequences in the HTML
output.  Being the signature for replacement references, I quickly change of the code for
the Text element from:</p>
<div class="highlight"><pre><span></span>    <span class="n">image_alt_text</span> <span class="o">+=</span> <span class="n">inline_blocks</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">token_text</span>
</pre></div>
<p>to</p>
<div class="highlight"><pre><span></span>    <span class="n">image_alt_text</span> <span class="o">+=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">resolve_references_from_text</span><span class="p">(</span>
        <span class="n">inline_blocks</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">token_text</span>
    <span class="p">)</span>
</pre></div>
<h3 id="beware-of-special-cases">Beware Of Special Cases<a class="headerlink" href="#beware-of-special-cases" title="Permanent link">¶</a></h3>
<p>Running the tests again, all the tests were passing except for those that dealt with the
<code>&amp;amp;</code> sequence.  All the tests dealing with the <code>&amp;copy;</code> sequence were working fine,
so I had to think quickly to figure out what the problem might be.  Because I am used to
looking at processed HTML code, I initially did not see any problem with a <code>&amp;amp;</code> sequence
in the HTML output.  It looked right.</p>
<p>Then it hit me.  The problem was not with the HTML output, it was with the processing of
the Markdown input.  In the cases that I had problems with, the desired HTML output had
<code>&amp;amp;amp;</code> which did not look right until I thought about it.  Whereas the <code>&amp;copy;</code>
character sequence is interpreted as a named charactery entity and replaced with the
© symbol, the sequence <code>&amp;amp;</code> was not being interpreted in the same way.  The
desired HTML output was correct!  The initial <code>&amp;</code> from the sequence was being replaced
with the sequence <code>&amp;amp;</code> to ensure it was displayed properly, removing any chance of
it being interpreted as a named character entity.</p>
<p>Making a quick decision, I looked at the <code>InlineHelper</code> class and noticed the
<code>append_text</code> function used to ensure that such strings were properly interpreted.
Taking a quick look at the imports for <code>InlineHelper</code> and <code>LinkHelper</code>, I thought there
was a chance of a circular reference occurring.  Given that observation, I decided to
make a copy of the <code>append_text</code> function in the <code>LinkHelper</code> class to get around the
possibility of the circular reference.</p>
<p>Finally, after a couple of hours of work, all 40 tests were passing.  It was a bit of
a trek to get there, but it was worth it!</p>
<h2 id="whoops">Whoops<a class="headerlink" href="#whoops" title="Permanent link">¶</a></h2>
<p>As I was starting to write the article, I also started to look into what it would take
to remove the duplicate of the <code>append_text</code> function in the <code>LinkHelper</code> class.  I had
introduced the clone into the <code>LinkHelper</code> class to avoid any issues with referencing
the <code>InlineHelper</code> class from the <code>LinkHelper</code> class.  It was as I was starting my
research into this task that I discovered something that I had previously missed.  The
<code>LinkHelper</code> class was already referencing the <code>InlineHelper</code> class.</p>
<p>After a bit of “how did I miss that?”, I replaced the call to <code>LinkHelper.append_text</code> with
<code>InlineHelper.append_text</code> and everything worked fine.  Removing the instance of the
<code>append_text</code> function from the <code>LinkHelper</code> class, I ran the complete suite of scenario
tests again, and everything worked fine.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>Looking back at the work I did during the week, it was hard not to get jazzed
about the progress.  I started off by doing a simple fix that made the source code
more readable, enhancing my ability to read the source code.  Then I upgraded the
base Python version to 3.8, knowing that it would allow me to write the wrapper I wanted
around Python’s logging functions.  Add to that the coverage and testing I was able to
add and verify for Link elements, Image elements, and Link Reference Definitions, and
it was really good work!  </p>
<p>At some point I noticed the number of scenario tests that I execute with each change.
At approximately 2000 tests, I am confident that I am hitting a very large degree of
all scenarios for Markdown transformation, not just the “Golden” scenarios, and that
was also a boost to my confidence.  While I can expect things that I note as an issue
to not work, I also need to make sure I appreciate what is working.  Having a solid
set of tests like that is what allows me to refactor with confidence that I am not
negatively impact the code.</p>
<p>Refactor?  Sigh.  One of the things I know I am looking forward to is looking at
the refactor tasks in the prioritized sections and getting a couple of them underway.
The fact that they are present in those sections is a good reminder to me that I
can always learn how to do things better, and how to make the project more maintainable.
And that is always something I can look forward to!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>With a solid amount of work done this week, I am hoping to be able to clear out the
uncategorized section of the issues list in the next week.  Will I make it?  Stay tuned!</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:courtesy">
<p>Information courtesy of the <a href="https://www.python.org/downloads/">Python download page</a>. <a class="footnote-backref" href="#fnref:courtesy" title="Jump back to footnote 1 in the text">↩</a><a class="footnote-backref" href="#fnref2:courtesy" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:moreLater">
<p>I will be covering this in a separate series of articles in the near future. <a class="footnote-backref" href="#fnref:moreLater" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%2018&url=https%3A//jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Delving%20Into%20the%20Issues%20-%2018&amp;body=https%3A//jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/01/25/markdown-linter-delving-into-the-issues-18/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-delving-into-the-issues-18"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/" title="Previous: Markdown Linter - Delving Into the Issues - 17">Markdown Linter - Delving Into the Issues - 17</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/02/01/markdown-linter-delving-into-the-issues-19/" title="Next: Markdown Linter - Delving Into the Issues - 19">Markdown Linter - Delving Into the Issues - 19</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~17 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-01-25T00:00:00-08:00">Jan 25, 2021</time>
        <h4>Markdown Linter Issues</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2020/09/28/markdown-linter-delving-into-the-issues-1/" title="Markdown Linter - Delving Into the Issues - 1">Part 1: Markdown Linter - Delving Into the Issues - 1</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/05/markdown-linter-delving-into-the-issues-2/" title="Markdown Linter - Delving Into the Issues - 2">Part 2: Markdown Linter - Delving Into the Issues - 2</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/12/markdown-linter-delving-into-the-issues-3/" title="Markdown Linter - Delving Into the Issues - 3">Part 3: Markdown Linter - Delving Into the Issues - 3</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/19/markdown-linter-delving-into-the-issues-4/" title="Markdown Linter - Delving Into the Issues - 4">Part 4: Markdown Linter - Delving Into the Issues - 4</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/10/26/markdown-linter-delving-into-the-issues-5/" title="Markdown Linter - Delving Into the Issues - 5">Part 5: Markdown Linter - Delving Into the Issues - 5</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/02/markdown-linter-delving-into-the-issues-6/" title="Markdown Linter - Delving Into the Issues - 6">Part 6: Markdown Linter - Delving Into the Issues - 6</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/09/markdown-linter-delving-into-the-issues-7/" title="Markdown Linter - Delving Into the Issues - 7">Part 7: Markdown Linter - Delving Into the Issues - 7</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/16/markdown-linter-delving-into-the-issues-8/" title="Markdown Linter - Delving Into the Issues - 8">Part 8: Markdown Linter - Delving Into the Issues - 8</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/23/markdown-linter-delving-into-the-issues-9/" title="Markdown Linter - Delving Into the Issues - 9">Part 9: Markdown Linter - Delving Into the Issues - 9</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/11/30/markdown-linter-delving-into-the-issues-10/" title="Markdown Linter - Delving Into the Issues - 10">Part 10: Markdown Linter - Delving Into the Issues - 10</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/07/markdown-linter-delving-into-the-issues-11/" title="Markdown Linter - Delving Into the Issues - 11">Part 11: Markdown Linter - Delving Into the Issues - 11</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/14/markdown-linter-delving-into-the-issues-12/" title="Markdown Linter - Delving Into the Issues - 12">Part 12: Markdown Linter - Delving Into the Issues - 12</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/21/markdown-linter-delving-into-the-issues-13/" title="Markdown Linter - Delving Into the Issues - 13">Part 13: Markdown Linter - Delving Into the Issues - 13</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2020/12/28/markdown-linter-delving-into-the-issues-14/" title="Markdown Linter - Delving Into the Issues - 14">Part 14: Markdown Linter - Delving Into the Issues - 14</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/04/markdown-linter-delving-into-the-issues-15/" title="Markdown Linter - Delving Into the Issues - 15">Part 15: Markdown Linter - Delving Into the Issues - 15</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/11/markdown-linter-delving-into-the-issues-16/" title="Markdown Linter - Delving Into the Issues - 16">Part 16: Markdown Linter - Delving Into the Issues - 16</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/01/18/markdown-linter-delving-into-the-issues-17/" title="Markdown Linter - Delving Into the Issues - 17">Part 17: Markdown Linter - Delving Into the Issues - 17</a>
            </li>
            <li  class="active-part">
            Part 18: Markdown Linter - Delving Into the Issues - 18
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/01/markdown-linter-delving-into-the-issues-19/" title="Markdown Linter - Delving Into the Issues - 19">Part 19: Markdown Linter - Delving Into the Issues - 19</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>72</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>90</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>