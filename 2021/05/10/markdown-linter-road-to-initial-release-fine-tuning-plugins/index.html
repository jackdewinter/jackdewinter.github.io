<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I talked about the work I did to get the already implemented plugins ready for the release. In this article, I talk about the remaining work that I needed to do to fine tune the plugins and document them for the release. Introduction¶ Having just …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Road To Initial Release - Fine Tuning Plugins "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/05/10/markdown-linter-road-to-initial-release-fine-tuning-plugins/" />
<meta property="og:description" content="Summary¶ In my last article, I talked about the work I did to get the already implemented plugins ready for the release. In this article, I talk about the remaining work that I needed to do to fine tune the plugins and document them for the release. Introduction¶ Having just …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-05-10T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Road To Initial Release - Fine Tuning Plugins ">
<meta name="twitter:description" content="Summary¶ In my last article, I talked about the work I did to get the already implemented plugins ready for the release. In this article, I talk about the remaining work that I needed to do to fine tune the plugins and document them for the release. Introduction¶ Having just …">

        <title>Markdown Linter - Road To Initial Release - Fine Tuning Plugins  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/05/10/markdown-linter-road-to-initial-release-fine-tuning-plugins/">
                Markdown Linter - Road To Initial Release - Fine Tuning Plugins
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#open-source-software-projects-and-your-life">Open-Source Software Projects And Your Life</a></li>
<li><a href="#the-big-scan-verifying-existing-rules">The Big Scan: Verifying Existing Rules</a><ul>
<li><a href="#and-of-course-scenario-tests">And Of Course… Scenario Tests</a></li>
<li><a href="#fixing-up-the-rules">Fixing Up The Rules</a></li>
</ul>
</li>
<li><a href="#adding-proper-documentation-for-plugin-rules">Adding Proper Documentation For Plugin Rules</a></li>
<li><a href="#providing-for-strict-rule-configuration">Providing For Strict Rule Configuration</a><ul>
<li><a href="#altering-the-rule">Altering The Rule</a></li>
</ul>
</li>
<li><a href="#atx-heading-and-spaces-tabs-vs-spaces">Atx Heading and Spaces &amp; Tabs Vs. Spaces</a><ul>
<li><a href="#thinking-it-through">Thinking It Through</a></li>
<li><a href="#resolving-the-issue">Resolving The Issue</a></li>
</ul>
</li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2021/05/03/markdown-linter-road-to-initial-release-finalizing-plugins/">last article</a>, I talked about
the work I did to get the already implemented plugins ready for the release.  In this
article, I talk about the remaining work that I needed to do to fine tune the plugins
and document them for the release.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>Having just updated the rules and verified that they worked the way I envisioned
them working, there was still two big tasks and a small handful of small tasks
left to do before release.  The large task was to ensure that each plugin
rule was triggering properly and reporting the correct error point.  After that,
I needed to ensure that each plugin rule has a good start at usable documentation.
To wrap things up, I needed to keep on whittling down the little items in the issues
list that I have continued to find during other tasks.</p>
<p>Knowing that an initial release is inevitable in the next couple of weeks,
I moved forward on the project.</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please go to this project’s GitHub repository and consult the
commits between
<a href="https://github.com/jackdewinter/pymarkdown/commit/445c7a15bd926112146167eb1ac0d3f90c4f5de5">28 Apr 2021</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/5487aeaed56088c37c81f7ff2a4fd26ffb04811d">26 Apr 2021</a>.</p>
<h2 id="open-source-software-projects-and-your-life">Open-Source Software Projects And Your Life<a class="headerlink" href="#open-source-software-projects-and-your-life" title="Permanent link">¶</a></h2>
<p>Looking at the time between
<a href="https://github.com/jackdewinter/pymarkdown/commit/445c7a15bd926112146167eb1ac0d3f90c4f5de5">this commit</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/c742f628348b47662f3142ee316d3a44e2405af0">this commit</a>,
there is a noticeable gap of 9 days.  While some of time in that gap was spent trying to figure out the
right wording for the documentation on the rules, a lot of it was not.  That is what I want to talk about in
this section: open-source software projects and your life.</p>
<p>I love my PyMarkdown project, I really do, but it is not my life.  In the
grand scheme of things, it is important, but not more than my health, my
family, my job, and my sanity.  Even though I
was feeling better after the previous weekend, I was not at 100%.  To be
honest, for that week, if I was at 60% on any day, it was a great day.  And
while some people might disagree with my reasons, my priorities that week were on anything
except the PyMarkdown project.</p>
<p>And it was not a difficult decision to make either.  After working at my
day job and doing what I could around the house, I had little energy left
to do anything else.  When I could, I did work on the project, but when
my energy ran out, I locked my computer and went somewhere to depressurize
and rest.
I did not think twice about this either.  The reason I can spend evenings and
weekends working on this project is my job.  The reason that I have the
mental energy to work on this project is due to my health.  The reason that
I have the emotional energy to work on this project is due to my family
and my sanity.  Unless I want to develop negative feelings about this
project, I need to ensure that I work on the PyMarkdown project for the
right reasons and with the right mindset.</p>
<p>That decision did set me back a week or so, but it was the right thing
for me to do.  For any other open-source contributors out there, please
figure out what is important to you and manage your projects based on
that list of priorities.  Most importantly, do not feel bad if that project
does not always make it to the top of the list.  It is healthier if it
does not.</p>
<h2 id="the-big-scan-verifying-existing-rules">The Big Scan: Verifying Existing Rules<a class="headerlink" href="#the-big-scan-verifying-existing-rules" title="Permanent link">¶</a></h2>
<p>There was no way around this task.  I needed to go through each of the
rules and their test data, verifying that the scenario tests were
reporting the right number of rule violations at the right positions.
If it would help others think that I was not going insane, I could
create a myth that I played a fun game to get it done, but it would
just be a myth.</p>
<p>The truth is, I was looking forward to this.  Yeah, I had no delusions
that it was going to be hard work, of that I was certain.  But this
was the culmination of over a years’ worth of work, and I wanted it to look
and feel right.  With that mindset, the only true way to do it was
to check every scenario test and test configuration against every
test Markdown file and verify the results manually.</p>
<p>Along the way, I also decided to create the first iteration of
the documentation for each rule, placing notes in there that would
help me create the documentation.  As all thirteen of the existing
rules were originated from the MarkdownLint rules, I opened
each Markdown file in my editor and compared my manual results against
the results product by MarkdownLint.</p>
<p>From my viewpoint, I sincerely believe that this is going to be
useful to the users.  As an avid user of MarkdownLint inside of
VSCode, it is useful to get any warnings about Markdown as I
am creating the documents.  Because the PyMarkdown project has
a more narrowly scoped focus of the GFM Specification instead
of MarkdownLint’s any-parser approach, as a user, knowing what
the differences are would help me understand it better.  And
if I know that I would want information on the differences
documented, I am going to assume that there are others out
there that would share that need.</p>
<p>I also want to mention that, to keep my sanity (or at least
try to), I focused on one rule at a time to the exclusion of
everything else.  I reviewed the code for the rule, made sure
that I had a solid understanding of how I believed that rule
should work, and then started iterating between scenario tests
and the rules they were testing.</p>
<h3 id="and-of-course-scenario-tests">And Of Course… Scenario Tests<a class="headerlink" href="#and-of-course-scenario-tests" title="Permanent link">¶</a></h3>
<p>I will admit that when I was going through the scenario tests,
I did curse a little.  Because I am being honest, I should probably
admit that I cursed a lot.  It was a big job, and it took a long
time.  But keeping my focus to a single rule helped me retain
my calm, even though some of the scenario tests files are huge.</p>
<p>But there were also benefits to my approach.  When I originally
developed some of these rules, I did not have all of the command
line options that the project now has.  As a result, some of
the scenario test output includes non-relevant rules being
triggered.  I was able to clean up a lot of tests by simply
adding the <code>--disable-rules md0xx</code> with the specific rule to
the command line for that test.  That cleared some things up
very quickly.</p>
<p>Other than some small things, it was usually very easy to
figure out when a triggered rule was reporting the wrong
position or misfiring.  While the “inside of list” and
“inside of block quote” cases were more difficult to spot,
the rest of the errors were almost always to do with a
wrong line being reported, or the position <code>(0,0)</code>
being reported.  That made it easy to spot.</p>
<p>But once I spotted issues, I needed to go back to the code
for the rule that I was working on and determine if the
test result was bad or if the rule was bad.  And in cases
where the rule was bad, I needed to fix that rule.</p>
<h3 id="fixing-up-the-rules">Fixing Up The Rules<a class="headerlink" href="#fixing-up-the-rules" title="Permanent link">¶</a></h3>
<p>As I went through the rules, most of the rules just required a
bit of cleaning up, and the occasional adjustment here and there.
A good example of those adjustments was the change made in the
<code>RuleMd024.py</code> module to pass the correct arguments into the
<code>report_next_token_error</code> function.  When this rule called
the <code>report_next_token_error</code> function, it did so in a way
that the reported position was always <code>(0,0)</code> for SetExt
Heading tokens.  A small adjustment to the token and the
addition of the <code>use_original_position</code> argument quickly took
care of that issue with a minimal amount of changed code.</p>
<p>A similar issue occurred with the <code>RuleMd026.py</code> module and
how it calculated the position of the error.  While slightly
more complicated, it took me a bit to make the changes to
deal with both Atx Heading tokens and SetExt Heading tokens
properly.  And it was when I looked at Rule md023 that I
realized it should be disabled by default.  While some other
parsers have problems with Atx Heading elements and SetExt
Heading elements that do not start at the beginning of the line,
the GFM Specification does not.  As such, it makes sense to
me to include it as a rule, but to disable it by default.</p>
<p>Even the work that I did on Rule md018 in
<a href="https://jackdewinter.github.io/2021/05/03/markdown-linter-road-to-initial-release-finalizing-plugins/#the-long-march">the last article</a>
need to be checked, and I found a couple of small issues there.
However, for this rule, the big change was that I need to break
up the functions with lots of statements into a collection of
smaller functions, each more accurately named.  As I refactored
into the small functions, I fixed those issues as I went.</p>
<h2 id="adding-proper-documentation-for-plugin-rules">Adding Proper Documentation For Plugin Rules<a class="headerlink" href="#adding-proper-documentation-for-plugin-rules" title="Permanent link">¶</a></h2>
<p>Taking my time with this task, per
the above section on
<a href="#open-source-software-projects-and-your-life">Open Source Software Projects And Your Life</a>,
I worked through this task at a leisurely pace.  While I did a couple of
format changes and section title changes, the relative content of the
sections was already fixed in my mind when I started.  It just took
a bit of experimentation to figure out what the correct transformation
from my mind to the correct layout in a Markdown file was.</p>
<p>This task was all about taking the information that was in
my head about each rule and documenting it in such a manner that a
user running into a violation of the rule would find useful.  Starting
with
<a href="docs/rule_md001.md">Rule md001</a>,
this meant that I needed to have any aliases for the rule at the top,
followed by a one line summary of the rules.  Based on experience, if
you are looking at a rule, you want something quick and easy at the top
of any documentation on that rule to make sure you are looking at
the documentation for the right rule. Next was a paragraph explaining
the reason that the rule was needed, followed by good examples
of what the rule triggered on and what the rule does not trigger on.
Following knowing that you have the right rule, you then want to
understand why this rule is important and start to figure out why
it triggered on your specific example.  Next is the information on any
configuration that applies to the rule.  While most of the time
a user will go “yeah, that sounds reasonable”, short of disabling
the rule altogether, good documentation on configuration allows that
user to know how far they can bend the rule, and in what direction.</p>
<p>The last section was the most interesting for me to add: what was
the origination of the rule.  While all the current rules are
based of rules from David Anson’s MarkdownLint project, some changes
have been made to bring them in line with the GFM Specification.
As such, I thought it was important to give some references that
contributed to the rules, as well as any changes to the rules.
Basically, if I am going to implement a similar rule, I want to
make sure I reference where I got the idea from.</p>
<p>Once I had the first rule done, the remaining twelve rules were relatively
easy.  Most of the content for these documents was already in the source
code for the rule or the source code for the tests for that rule. It
was just a matter of extracting that information and restructuring it
for the documentation.  The remaining information needed for the rules
was primarily in the <code>Reasoning</code> section, and that was easily crafted
after a bit of research.</p>
<h2 id="providing-for-strict-rule-configuration">Providing For Strict Rule Configuration<a class="headerlink" href="#providing-for-strict-rule-configuration" title="Permanent link">¶</a></h2>
<p>This change stemmed from a simple test that I made of the configuration
for rule Md022.  When I set the configuration value to a negative number,
the existing code for the <code>ApplicationProperties</code> class did not complain.
Given the state of that class, that was the correct behavior.  However,
in my mind, I had set that configuration to an invalid value, and I wanted
to know that it was invalid instead of the <code>ApplicationProperties</code> class
assuming the default value.  Basically, I wanted to enable “strict
configuration mode” for the
that instance of the <code>ApplicationProperties</code> class.</p>
<p>Starting with the tests, I added two new tests for Rule md022 with a negative
number specified for the <code>lines_below</code> configuration value for Rule md022.
One of those tests was created with my proposed “strict configuration mode”
enabled and the other test was created without it enabled. The test without
the new mode enabled passed right away, returning errors for the <code>lines_above</code>
value which had a valid value of <code>2</code>, but not returning any errors for
the invalid <code>lines_below</code> value.  With the <code>alternating_heading_types.md</code>
Markdown file and the default value for <code>lines_below</code>, that was the correct
response.  </p>
<p>With the base test working, I needed to add the code to wire up a new
command line switch with the <code>ApplicationProperties</code> class.  Having added
new command line switches before, I knew it was only a small amount of
effort to change the <code>main.py</code> module to add the argument:</p>
<div class="highlight"><pre><span></span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">"--strict-config"</span><span class="p">,</span>
        <span class="n">dest</span><span class="o">=</span><span class="s2">"strict_configuration"</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">"store_true"</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">"throw an error if configuration is bad, instead of assuming default"</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
<p>and then a similarly small amount of effort to pass it into the properties class.</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">strict_configuration</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__properties</span><span class="o">.</span><span class="n">enable_strict_mode</span><span class="p">()</span>
</pre></div>
<p>As the <code>enable_strict_mode</code> function did not exist, I created it as a simple
function that enables the flag as follows:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">enable_strict_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Sets struct mode to True to enable it.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__strict_mode</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
<p>I did think back and forth on whether to provide an “enable” function or
a “setter” function but landed on the “enable” function.  The easier way
to set the <code>self.__strict_mode</code> member variable is to pass it in as one
of the arguments to the constructor function.</p>
<p>Thinking through various
scenarios, I concluded that everything boiled down to two scenarios.
In the first scenario, whether to use strict mode at the
creation of the <code>ApplicationProperties</code> instance is known and is passed
into the constructor when it is created.  In the second scenario, that
decision needs to be delayed to a later point where it is known. In that
case, it makes more sense to start with the strict mode disabled, enabling
strict mode if required.  As the configuration is read in and then
the decision to use strict mode can be made, I went with the second option.</p>
<h3 id="altering-the-rule">Altering The Rule<a class="headerlink" href="#altering-the-rule" title="Permanent link">¶</a></h3>
<p>With the above code in place, I needed to modify the rule to perform a
better check on the configuration value.  Starting with:</p>
<div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">initialize_from_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lines_above</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_configuration</span><span class="o">.</span><span class="n">get_integer_property</span><span class="p">(</span>
            <span class="s2">"lines_above"</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lines_above</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lines_below</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_configuration</span><span class="o">.</span><span class="n">get_integer_property</span><span class="p">(</span>
            <span class="s2">"lines_below"</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lines_below</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>
<p>I quickly changed it to:</p>
<div class="highlight"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__validate_configuration_value</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">found_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">found_value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Value must not be zero or a positive integer."</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialize_from_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lines_above</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_configuration</span><span class="o">.</span><span class="n">get_integer_property</span><span class="p">(</span>
            <span class="s2">"lines_above"</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valid_value_fn</span><span class="o">=</span><span class="n">RuleMd022</span><span class="o">.</span><span class="n">__validate_configuration_value</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lines_below</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_configuration</span><span class="o">.</span><span class="n">get_integer_property</span><span class="p">(</span>
            <span class="s2">"lines_below"</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valid_value_fn</span><span class="o">=</span><span class="n">RuleMd022</span><span class="o">.</span><span class="n">__validate_configuration_value</span>
        <span class="p">)</span>
</pre></div>
<p>The big thing to notice here is that I added the
<code>__validate_configuration_value</code> function to handle the verification,
leveraging the <code>valid_value_fn</code> from the <code>ApplicationProperties</code> class.
This really did simplify the needed logic.</p>
<p>Debugging these changes, I cleaned up a couple of function default parameters
to ensure that I could pass the correct values through, and everything worked
fine.  When the verification function failed, the command line returned an
error, but it was a generic error.  Based in the <code>PluginManager</code> class, there
is code in the <code>BadPluginError</code> function to take an error and translate it
into something readable:</p>
<div class="highlight"><pre><span></span><span class="n">formatted_message</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"Plugin id '{plugin_id.upper()}' had a critical "</span>
    <span class="o">+</span> <span class="s2">"failure during the '{str(plugin_action)}' action."</span>
</pre></div>
<p>It was good that the error was surfacing, but it lacked the ability
to allow the user to act on it.  Therefore, I added a new <code>cause</code>
argument to the <code>BadPluginError</code> constructor function and rewrote
that code slightly:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">cause</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cause</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">formatted_message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cause</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">formatted_message</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"Plugin id '{plugin_id.upper()}' had a critical "</span>
        <span class="o">+</span> <span class="s2">"failure during the '{str(plugin_action)}' action."</span>
</pre></div>
<p>It was a small change, but that change allowed errors with the configuration
values to be surfaces as:</p>
<div class="highlight"><pre><span></span>The value for property 'plugins.md022.lines_below' is not valid:
 Value must not be zero or a positive integer.
</pre></div>
<p>To me, that was definitely actionable!</p>
<h2 id="atx-heading-and-spaces-tabs-vs-spaces">Atx Heading and Spaces &amp; Tabs Vs. Spaces<a class="headerlink" href="#atx-heading-and-spaces-tabs-vs-spaces" title="Permanent link">¶</a></h2>
<p>So, this one was a bit weird, but it had been on my mind for a while.  When
I was going through the
<a href="https://github.github.com/gfm">GFM Specification</a>
to verify one of the past issues dealing with Atx Heading elements, I read the
following two lines from the section on Atx Headings:</p>
<blockquote>
<p>An ATX heading consists of a string of characters, parsed as inline content,
between an opening sequence of 1–6 unescaped # characters and an optional
closing sequence of any number of unescaped # characters. The opening
sequence of # characters must be followed by a
<a href="https://github.github.com/gfm/#space">space</a> or by the end of line.</p>
</blockquote>
<p>Very specifically, it mentions a <code>space</code> character and not any <code>whitespace</code>
characters.  I remember this clearly, because it seems to contradict the
first two lines of the section on Tabs:</p>
<blockquote>
<p>Tabs in lines are not expanded to spaces. However, in contexts
where whitespace helps to define block structure, tabs behave
as if they were replaced by spaces with a tab stop of 4 characters.</p>
</blockquote>
<p>That text is backed up by
<a href="https://github.github.com/gfm/#example-10">example 10</a> which has
a Markdown of</p>
<div class="highlight"><pre><span></span><span class="o">#</span><span class="err">→</span><span class="n">Foo</span>
</pre></div>
<p>and an HTML output of</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Foo<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</pre></div>
<p>This seems contradictory, so what to do?</p>
<h3 id="thinking-it-through">Thinking It Through<a class="headerlink" href="#thinking-it-through" title="Permanent link">¶</a></h3>
<p>I guess the best place to start is with the statement that while
all specifications try and be perfect, most specifications take
a while to get to that state.  The
<a href="https://github.github.com/gfm">GFM Specification</a>
is no different than any other specification in that regard.  To
help address that issue that I found, I posted a question to the
Markdown forums to make sure that it gets talked about.  But I
still had to do something with the parser to move it along.
But what was the right answer?</p>
<p>From my experience, most specifications are layered to provide
general context at a high level and a more specific context at
a lower level.  A good example of this could be a specification
that says, “in the English language, <code>i</code> always comes before <code>e</code>”
while the specification for a particular section says “except
after <code>c</code>”.  In that given section, I then expect to
have an explanation as to why that section is an exception,
with good reasons to back that decision up.  This provides for
a good foundation in the general case, with room to change things
at a lower level if required.</p>
<p>Based on that experience and those two seemingly contradictory
statements, I decided to change the code to not allow tab
characters as part of the starting or ending hash characters
for the Atx Heading elements.  There was one big factor to
assist me in making that change.  That was that it was a simple
enough change, and I could always revert it if necessary with
little effort.  That meant that I could adhere to the specification
as I was reading it, and if I read it wrong, it was reversable.</p>
<p>That was good enough for me!</p>
<h3 id="resolving-the-issue">Resolving The Issue<a class="headerlink" href="#resolving-the-issue" title="Permanent link">¶</a></h3>
<p>Having made the decision to go with the more specific part of the
specification, there were some changes I needed to do.  The first
thing was to add eight new tests: two tests each for rule md018, md019,
md020, and md021.  These tests are variations on existing tests that
also include tabs in the area between the hash character (<code>#</code>) and
the start of the heading text.  With those tests ready to go,
it was time to make the changes.</p>
<p>For detecting the opening part of the Atx Heading, the only change
needed in the <code>is_atx_heading</code> function was to change this:</p>
<div class="highlight"><pre><span></span>    <span class="p">(</span>
        <span class="n">non_whitespace_index</span><span class="p">,</span>
        <span class="n">extracted_whitespace_at_start</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">extract_whitespace</span><span class="p">(</span><span class="n">line_to_parse</span><span class="p">,</span> <span class="n">new_index</span><span class="p">)</span>
</pre></div>
<p>to this:</p>
<div class="highlight"><pre><span></span>    <span class="n">non_whitespace_index</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">collect_while_character</span><span class="p">(</span><span class="n">line_to_parse</span><span class="p">,</span> <span class="n">new_index</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
    <span class="n">extracted_whitespace_at_start</span> <span class="o">=</span> <span class="n">line_to_parse</span><span class="p">[</span><span class="n">new_index</span><span class="p">:</span><span class="n">non_whitespace_index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
<p>This change simply replaces the call to the generic <code>extract_whitespace</code>
function with inline code that is targeted specifically for a space character.
As the <code>collect_while_character</code> function returns slightly different information
than the <code>extract_whitespace</code> function, an extra statement is required to compute
the value for the <code>extracted_whitespace_at_start</code> variable.</p>
<p>With the code for the opening hash characters completed, I needed to shift
focus to the end hash characters.  These changes were both within the
<code>parse_atx_headings</code> function in the portion of the code after then ending
hash characters are detected and removed.  Like the changes required to
direct focus on space characters at the start of the Atx Heading element,
the end has characters required the same type of changes from:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">is_character_at_index_whitespace</span><span class="p">(</span>
        <span class="n">remaining_line</span><span class="p">,</span> <span class="n">end_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">remaining_line</span> <span class="o">=</span> <span class="n">remaining_line</span><span class="p">[:</span><span class="n">end_index</span><span class="p">]</span>
        <span class="p">(</span>
            <span class="n">end_index</span><span class="p">,</span>
            <span class="n">extracted_whitespace_before_end</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">extract_whitespace_from_end</span><span class="p">(</span><span class="n">remaining_line</span><span class="p">)</span>
</pre></div>
<p>to:</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">is_character_at_index</span><span class="p">(</span>
        <span class="n">remaining_line</span><span class="p">,</span> <span class="n">end_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">" "</span><span class="p">):</span>
        <span class="n">remaining_line</span> <span class="o">=</span> <span class="n">remaining_line</span><span class="p">[:</span><span class="n">end_index</span><span class="p">]</span>
        <span class="n">non_whitespace_index</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ParserHelper</span><span class="o">.</span><span class="n">collect_backwards_while_character</span><span class="p">(</span>
                <span class="n">remaining_line</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining_line</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">" "</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">end_index</span> <span class="o">=</span> <span class="n">non_whitespace_index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">extracted_whitespace_before_end</span> <span class="o">=</span> <span class="n">remaining_line</span><span class="p">[</span><span class="n">end_index</span><span class="p">:]</span>
</pre></div>
<p>Once again, the <code>*whitespace*</code> function calls needed to be replaced
with functions focus on the single space character.  And once again,
to keep the rest of the code the same, some extra computation was
required.</p>
<p>I tested this code in two blocks, the starting hash characters and
the ending hash characters.  This worked out well and I was
quickly able to get both changes made and tested.  While it was
not a big change, it was one more thing off the list, so it was
good.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>While I do not like that “my getting sick” caused me to slip another
week before the initial release, I did need the time to get back
into proper form after my second COVID-19 vaccine shot.  From
experience, if I push myself more than a given amount, I am not only
borrowing energy from the short term future but prolonging the
time it takes me to recover.  Basically, I can take two to four
days of “I’ll do stuff when I can” and get back to normal, or I
can push for that duration. If I push for that duration, it usually
means that instead of two to four days, it will take me four to
six days to get back to normal.  It truly is not fair, but it
just is.</p>
<p>In terms of the project itself, I can mentally feel all the
mental list of project checkboxes being checked off one by
one.  While I am finding things that need fixing, those items
can either be postponed or they will only take a couple of
hours to fix.  Either way, I have the confidence that I can
properly allocated them to the right priority, which is the
important decision.  And the number of checkboxes left to check
is diminishing.</p>
<p>From my viewpoint, the entire PyMarkdown project is coming
together nicely.  The parser and the rules engine are both
working properly.  The first thirteen rules are implemented,
tested, and verified.  I have a good first draft of the documentation
for those rules, and I only have the bulk of the documentation
to compose for the base of the project.</p>
<p>While I am not at the finish line yet, I can definitely see
it, and it is closer than the horizon!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>The list of items in the priority 1 section remains low, but I need to get it
to zero before I feel confident about releasing.  With documentation being
the big push now, it was balancing both of those tasks at the same time.
Stay tuned!</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Road%20To%20Initial%20Release%20-%20Fine%20Tuning%20Plugins&url=https%3A//jackdewinter.github.io/2021/05/10/markdown-linter-road-to-initial-release-fine-tuning-plugins/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/05/10/markdown-linter-road-to-initial-release-fine-tuning-plugins/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Road%20To%20Initial%20Release%20-%20Fine%20Tuning%20Plugins&amp;body=https%3A//jackdewinter.github.io/2021/05/10/markdown-linter-road-to-initial-release-fine-tuning-plugins/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/05/10/markdown-linter-road-to-initial-release-fine-tuning-plugins/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-road-to-release-m"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/05/03/markdown-linter-road-to-initial-release-finalizing-plugins/" title="Previous: Markdown Linter - Road To Initial Release - Finalizing Plugins">Markdown Linter - Road To Initial Release - Finalizing Plugins</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/05/17/markdown-linter-road-to-initial-release-dotting-the-is/" title="Next: Markdown Linter - Road To Initial Release - Dotting The Is">Markdown Linter - Road To Initial Release - Dotting The Is</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~16 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-05-10T00:00:00-07:00">May 10, 2021</time>
        <h4>Markdown Linter Road To Initial Release</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2021/02/08/markdown-linter-road-to-initial-release-learned-and-useful-things/" title="Markdown Linter - Road To Initial Release - Learned and Useful Things">Part 1: Markdown Linter - Road To Initial Release - Learned and Useful Things</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/15/markdown-linter-road-to-initial-release-refactoring/" title="Markdown Linter - Road To Initial Release - Refactoring">Part 2: Markdown Linter - Road To Initial Release - Refactoring</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/02/22/markdown-linter-road-to-initial-release-starting-performance/" title="Markdown Linter - Road To Initial Release - Starting Performance">Part 3: Markdown Linter - Road To Initial Release - Starting Performance</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/01/markdown-linter-road-to-initial-release-measured-performance-increases/" title="Markdown Linter - Road To Initial Release - Measured Performance Increases">Part 4: Markdown Linter - Road To Initial Release - Measured Performance Increases</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/08/markdown-linter-road-to-initial-release-cleaning-up-the-list-and-readability/" title="Markdown Linter - Road To Initial Release - Cleaning Up The List and Readability">Part 5: Markdown Linter - Road To Initial Release - Cleaning Up The List and Readability</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/15/markdown-linter-road-to-initial-release-front-matter/" title="Markdown Linter - Road To Initial Release - Front-Matter">Part 6: Markdown Linter - Road To Initial Release - Front-Matter</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/22/markdown-linter-road-to-initial-release-configuration/" title="Markdown Linter - Road To Initial Release - Configuration">Part 7: Markdown Linter - Road To Initial Release - Configuration</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/03/29/markdown-linter-road-to-initial-release-command-lines/" title="Markdown Linter - Road To Initial Release - Command Lines">Part 8: Markdown Linter - Road To Initial Release - Command Lines</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/04/05/markdown-linter-road-to-initial-release-cleaning-up/" title="Markdown Linter - Road To Initial Release - Cleaning Up">Part 9: Markdown Linter - Road To Initial Release - Cleaning Up</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/04/12/markdown-linter-road-to-initial-release-creating-a-package/" title="Markdown Linter - Road To Initial Release - Creating A Package">Part 10: Markdown Linter - Road To Initial Release - Creating A Package</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/04/19/markdown-linter-road-to-initial-release-gearing-up-for-plugins/" title="Markdown Linter - Road To Initial Release - Gearing Up For Plugins">Part 11: Markdown Linter - Road To Initial Release - Gearing Up For Plugins</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/03/markdown-linter-road-to-initial-release-finalizing-plugins/" title="Markdown Linter - Road To Initial Release - Finalizing Plugins">Part 12: Markdown Linter - Road To Initial Release - Finalizing Plugins</a>
            </li>
            <li  class="active-part">
            Part 13: Markdown Linter - Road To Initial Release - Fine Tuning Plugins
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/17/markdown-linter-road-to-initial-release-dotting-the-is/" title="Markdown Linter - Road To Initial Release - Dotting The Is">Part 14: Markdown Linter - Road To Initial Release - Dotting The Is</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/24/markdown-linter-road-to-initial-release-crossing-the-ts/" title="Markdown Linter - Road To Initial Release - Crossing The Ts">Part 15: Markdown Linter - Road To Initial Release - Crossing The Ts</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/05/31/markdown-linter-road-to-initial-release-triple-check-everything/" title="Markdown Linter - Road To Initial Release - Triple Check Everything">Part 16: Markdown Linter - Road To Initial Release - Triple Check Everything</a>
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>91</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>109</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>