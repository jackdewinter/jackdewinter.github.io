<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jack De Winter" />

        <meta name="description" content="Summary¶ In my last article, I talked about the work I put into getting that weeks’ three rules completed. In this article, I talk about getting the remaining rules implemented. Introduction¶ It has been a long way to get here, but I am finally at the point where the beta …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="markdown linter, core linter, Software Quality, " />

<meta property="og:title" content="Markdown Linter - Race To The Finish "/>
<meta property="og:url" content="https://jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/" />
<meta property="og:description" content="Summary¶ In my last article, I talked about the work I put into getting that weeks’ three rules completed. In this article, I talk about getting the remaining rules implemented. Introduction¶ It has been a long way to get here, but I am finally at the point where the beta …" />
<meta property="og:site_name" content="Jack&#39;s Digital Workbench" />
<meta property="og:article:author" content="Jack De Winter" />
<meta property="og:article:published_time" content="2021-09-20T00:00:00-07:00" />
<meta name="twitter:title" content="Markdown Linter - Race To The Finish ">
<meta name="twitter:description" content="Summary¶ In my last article, I talked about the work I put into getting that weeks’ three rules completed. In this article, I talk about getting the remaining rules implemented. Introduction¶ It has been a long way to get here, but I am finally at the point where the beta …">

        <title>Markdown Linter - Race To The Finish  · Jack&#39;s Digital Workbench
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://jackdewinter.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://jackdewinter.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jack&#39;s Digital Workbench - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://jackdewinter.github.io/"><span class=site-name>Jack's Digital Workbench</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://jackdewinter.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://jackdewinter.github.io/categories">Categories</a></li>
                                <li ><a href="https://jackdewinter.github.io/tags">Tags</a></li>
                                <li ><a href="https://jackdewinter.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://jackdewinter.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/">
                Markdown Linter - Race To The Finish
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-is-the-audience-for-this-article">What Is the Audience for This Article?</a></li>
<li><a href="#rule-md013-line-length">Rule Md013 - Line Length</a><ul>
<li><a href="#design">Design</a><ul>
<li><a href="#if-at-first-you-do-not-succeed">If At First You Do Not Succeed</a></li>
<li><a href="#time-to-pivot">Time To Pivot</a></li>
</ul>
</li>
<li><a href="#testing-and-implementation">Testing and Implementation</a><ul>
<li><a href="#second-algorithm-first">Second Algorithm First</a></li>
</ul>
</li>
<li><a href="#back-to-the-first-algorithm">Back To The First Algorithm</a></li>
</ul>
</li>
<li><a href="#rule-md009-no-trailing-spaces">Rule Md009 - No Trailing Spaces</a><ul>
<li><a href="#design_1">Design</a></li>
<li><a href="#tests-and-implementation">Tests and Implementation</a><ul>
<li><a href="#second-algorithm-take-two">Second Algorithm, Take Two</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rule-md011-reverse-inline-links">Rule Md011 - Reverse Inline Links</a><ul>
<li><a href="#design_2">Design</a></li>
<li><a href="#tests-and-implementation_1">Tests and Implementation</a></li>
</ul>
</li>
<li><a href="#ensuring-rule-details-and-rule-documentation-are-consistent">Ensuring Rule Details and Rule Documentation Are Consistent</a></li>
<li><a href="#what-was-my-experience-so-far">What Was My Experience So Far?</a></li>
<li><a href="#what-is-next">What is Next?</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">¶</a></h2>
<p>In my
<a href="https://jackdewinter.github.io/2021/09/13/markdown-linter-back-to-work/">last article</a>, I talked
about the work I put into getting that weeks’ three rules completed. In this article, I
talk about getting the remaining rules implemented.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>It has been a long way to get here, but I am finally at the point where
the beta release is within reach.  All I have to do is to finish the last
three rules, make sure they are cleaned up a bit, and I am ready for the
beta release of <a href="https://github.com/jackdewinter/pymarkdown">PyMarkdown</a>.</p>
<p>And with that…</p>
<h2 id="what-is-the-audience-for-this-article">What Is the Audience for This Article?<a class="headerlink" href="#what-is-the-audience-for-this-article" title="Permanent link">¶</a></h2>
<p>While detailed more eloquently in
<a href="https://jackdewinter.github.io/2020/04/05/what-is-the-audience-for-my-blog/#what-is-the-audience-for-my-blog">this article</a>,
my goal for this technical article is to focus on the reasoning behind my solutions,
rather that the solutions themselves.  For a full record of the solutions presented in
this article, please consult the commits that occurred between
<a href="https://github.com/jackdewinter/pymarkdown/commit/e38fd9553831cea16bb8f4dee8f423ca8be5613b">16 Sep 2021</a>
and
<a href="https://github.com/jackdewinter/pymarkdown/commit/60d6cffeb22e204ba05430ed82ba33b7deda80cb">19 Sep 2021</a>.</p>
<h2 id="rule-md013-line-length">Rule Md013 - Line Length<a class="headerlink" href="#rule-md013-line-length" title="Permanent link">¶</a></h2>
<p>Most linters have a rule like it, and PyMarkdown was not going to be
an exception.  It needed a rule that curtailed overly long lines.  It was
something obvious that was missing.  But as I have frequently found
to be the case with simple and obvious things, there was a little hitch.</p>
<h3 id="design">Design<a class="headerlink" href="#design" title="Permanent link">¶</a></h3>
<p>At first, when I looked at this rule, I thought it was going to be easy.
I mean, come on! This was line lengths.  Just go through the file looking
for long lines and flag when they exceed a given length.  And then I
got to the section on code blocks and headings in the original rules.
Reading the description again, there was a brief discussion on why
having alternate line lengths for those sections was needed.  Furthermore,
those discussions made sense.</p>
<p>But that left me with an interesting problem to solve: how do I do that
efficiently?</p>
<h4 id="if-at-first-you-do-not-succeed">If At First You Do Not Succeed<a class="headerlink" href="#if-at-first-you-do-not-succeed" title="Permanent link">¶</a></h4>
<p>My first pass at solving this was horrible.  Scribbling furiously,
I wanted to take the approach of using the tokens to help me figure
out what the line lengths were.  Each non-end token has a start location,
so piecing things back together would be easy, right?  Wrong!  No
matter how much I tried to design around that issue, it always proved
to be too much work for too little benefit.</p>
<p>It took a couple of hours of playing around with designs and walking
by dog before I produced an observation that I thought had merit.
From a more relaxed viewpoint, I observed that I was trying to deal
with both requirements of the rule with the same algorithm.  It was
not the base algorithm that was complex, but the variations that I was
trying to add to it to understand where in the document it was. That
was the main issue.  But could I attack that problem from a different
angle and avoid that issue?</p>
<h4 id="time-to-pivot">Time To Pivot<a class="headerlink" href="#time-to-pivot" title="Permanent link">¶</a></h4>
<p>Instead of trying to change that base algorithm, I decided that I was
going to try and implement two algorithms separately and have them
work together.  The first algorithm, the base algorithm, was great at
detecting long lines, but did not have any concept of where in the
document it was.  I therefore figured out that I needed a second algorithm that
simply focused on what the currently active Leaf element was.  If
there was effective communication between the two algorithms,
the first algorithm could ask the second algorithm where in the document
it was and make the right decisions for configuration.</p>
<p>Then the issue I needed to solve was that method of communication.
Intrinsically, each algorithm occurred in a different part of the
document scan: first the tokenized scan occurs, and then the
line-by-line scan occurs.  That was the gap that I needed the
algorithms to cover.</p>
<p>Taking a hint from past ventures in trying to create complex solutions,
I decided to keep it simple.  During the token pass, the second
algorithm would add any Blank Line token or Leaf token to an array.
As those tokens contain the line number and multiple Leaf tokens
cannot occur on the same line, a simple tracking index would work
for tracking the current Leaf token within the line scan phase.</p>
<p>I was not concerned about the covering the cases for long words
at the end of lines as I already had that part designed within
minutes of reading the rule.  Starting at the specified line
length, the rule needed to avoid triggering if it could not find
any whitespace before the end of the line.  From experience
with the project, it sounded like it was purposefully made for the
<code>ParserHelper</code> module and its <code>extract_until_whitespace</code> function.</p>
<p>Working through different mental runs of the algorithm, it
seemed solid.  But would it work when coded?  It was time to see.</p>
<h3 id="testing-and-implementation">Testing and Implementation<a class="headerlink" href="#testing-and-implementation" title="Permanent link">¶</a></h3>
<p>Looking across the requirements for this rule, it was easy to see that
the scenario tests were going to have to cover every one of the Leaf
elements.  With special configuration for both code block and for
headings, I did not see any way to avoid it.  In addition, I needed to
deal with words, or more properly <em>possible word like entities</em> that
may extend past the end of the specified line lengths.  The variations
to deal with <code>strict</code> and <code>stern</code> configuration items would require
testing on existing test cases, but no new test data files.  Finished
creating the test cases, I counted them up and I had 18 different
Markdown files entered.</p>
<p>From there, the number of scenario tests based on those tests grew.
With six configuration values and combinations between them and the
test case data, the number of scenario tests quickly soared to
43 scenario tests before it stopped.  There were my usual “what about…”
scenarios that I thought about adding afterwards, but in each case
those scenarios boiled down to slight variations on existing tests
cases and scenario tests.  But knowing that they did reduce to those
existing tests gave me the confidence to go on with the implementation.</p>
<h4 id="second-algorithm-first">Second Algorithm First<a class="headerlink" href="#second-algorithm-first" title="Permanent link">¶</a></h4>
<p>As I was more worried about the interface with the second algorithm,
I decided to work on it first.  To start, I added the following
function:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">next_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_blank_line</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</pre></div>
<p>It was nothing special, but I was amazed by how simple it seemed.
With all my scribbling on paper seeming overwhelming, this function
seemed very underwhelming.  But there was no disputing it, it did
what it needed to very well.  It simply added any Leaf tokens or
a Blank Line tokens to the list.</p>
<p>Then it was time for the other half of the algorithm.  It was
equally simple:</p>
<div class="highlight"><pre><span></span> <span class="k">def</span> <span class="nf">next_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">)</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__line_index</span>
        <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">line_number</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Do Stuff Here</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__line_index</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
<p>Because the first algorithm is line based, the second algorithm just needed
to provide a line level understanding of what Leaf token is current active.
Once again, it was underwhelming to implement the design and find out how
simple it was.  It was so underwhelming that I added debug statements and
walked through multiple test scenarios to make sure it was working properly.
It worked in each case.  It was a win!  It was on to the other algorithm.</p>
<h3 id="back-to-the-first-algorithm">Back To The First Algorithm<a class="headerlink" href="#back-to-the-first-algorithm" title="Permanent link">¶</a></h3>
<p>With the second algorithm code in place, the first algorithm went
forward without any problems.  While there are variations for code blocks
and headings, the initial code added to the <code>next_line</code> function was quite
simple:</p>
<div class="highlight"><pre><span></span>    <span class="n">line_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">compare_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__line_length</span>
    <span class="k">if</span> <span class="n">line_length</span> <span class="o">&gt;</span> <span class="n">compare_length</span><span class="p">:</span>

        <span class="n">trigger_rule</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict_mode</span><span class="p">:</span>
            <span class="n">trigger_rule</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">next_space_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">extract_until_whitespace</span><span class="p">(</span>
                <span class="n">line</span><span class="p">,</span> <span class="n">compare_length</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stern_mode</span><span class="p">:</span>
                <span class="n">trigger_rule</span> <span class="o">=</span> <span class="n">line_length</span> <span class="o">==</span> <span class="n">next_space_index</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">trigger_rule</span> <span class="o">=</span> <span class="n">line_length</span> <span class="o">!=</span> <span class="n">next_space_index</span>

        <span class="k">if</span> <span class="n">trigger_rule</span><span class="p">:</span>
            <span class="n">extra_error_information</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">f</span><span class="s2">"Expected: {compare_length}, Actual: {line_length}"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_next_line_error</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">extra_error_information</span><span class="o">=</span><span class="n">extra_error_information</span><span class="p">)</span>
</pre></div>
<p>Following the design, the actual comparison for line length is simple…
it is what comes after it that took a bit to get right.  Between the
rules for <code>strict</code>, <code>stern</code>, and long end words, it took me some additional
time to get the response to those configuration settings exactly right.
While I did not state it in the design section for this rule, I was 40%
convinced that I would need to design that on the spot to get it right.
The other 60%?  I wanted to see if my 2 algorithm approach worked as
well as I thought it did.</p>
<p>Regardless, the implementation was coded for the base paragraph scenario
tests within an hour, and I started the lengthy process of enabling each
test scenario and addressing any issues.  With 43 scenario tests to
enable, it took a while, but I only encountered slight issues along the
way.  When it came to handling the line lengths of the code blocks and
the headings, I just introduced the extra configuration items to handle
them.  Then, in the above example, I added some… er… ugly if statements
to manage the extra values.</p>
<p>After double checking all 43 scenario tests, those changes were committed,
and it was on to the next rule.</p>
<h2 id="rule-md009-no-trailing-spaces">Rule Md009 - No Trailing Spaces<a class="headerlink" href="#rule-md009-no-trailing-spaces" title="Permanent link">¶</a></h2>
<p>Lately, I have noted that I have a certain amount of luck that is
showing up in my work for this project.  It was therefore interesting to see
that this trend was showing up again.</p>
<h3 id="design_1">Design<a class="headerlink" href="#design_1" title="Permanent link">¶</a></h3>
<p>Reading this rule, it felt like I was reading an echo of
the previously implemented rule.  Through serendipity, I had a
second rule that would benefit from my recent two algorithm scan
approach.  It was not any planning on my part, it was sheer luck.</p>
<p>There were a couple of new twists, but nothing that was a substantial
change to the supporting algorithm.  Based on reading the description
for the rule, there were configurations values that needed to know
of any Hard Link Break tokens (inline tokens) and if the existing
line was within a List token (container token).  Other than that
complication, the rule seemed simpler than the
previous rule.  Instead of a complicated triggering scenario,
this rule had a very straightforward one: if the number of spaces
at the end was not 0 or the configured amount, trigger.</p>
<p>I took my time to work through any issues with the
design, but the adaptation of the previous rule saved me a lot
of time.  While it was luck that I encountered both
rules together, it sure helped my design for this
rule to have the design for the past rule still in my head.</p>
<h3 id="tests-and-implementation">Tests and Implementation<a class="headerlink" href="#tests-and-implementation" title="Permanent link">¶</a></h3>
<p>Getting the tests ready for this rule were easy.
After creating 12 files for test cases and the 21 scenario
tests to cover them, I was confident that I had everything
covered.  As the 21 tests for this rule were less than half
of the tests for the previous rule, I was a bit nervous
about proceeding.</p>
<p>But after double checking the tests, I honestly could not
find anything that I had missed.  Every <em>extra</em> test case
that I produced was reduced into one of the
existing test cases.  After about a half hour of producing
extra cases that matched that pattern, I was in
a more confident place about the tests, and I decided to
continue.</p>
<h4 id="second-algorithm-take-two">Second Algorithm, Take Two<a class="headerlink" href="#second-algorithm-take-two" title="Permanent link">¶</a></h4>
<p>Since this rule was mostly a clone of the previous rule, I knew
that I had a solid base to work with.  So instead of the two lines
required for the previous rule’s <code>next_token</code> function, this one
had a bit more content:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_block_quote_start</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_list_start</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__container_token_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_block_quote_end</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_list_end</span><span class="p">:</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_token_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_blank_line</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_leaf</span> <span class="ow">or</span> <span class="n">token</span><span class="o">.</span><span class="n">is_inline_hard_break</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__container_token_stack</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_owner_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__container_token_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_owner_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
<p>Taking care of the extra requirement for tracking any Hard Break tokens
just required adding <code>or token.is_inline_hard_break</code> to the one conditional.
Adding the proper support for the container tokens did take a bit more
work.  Keeping track of the “current” container token was accomplished with the
first four lines of the new function, but that was not enough.  As there
is specific configuration for a Blank Line within a List Element, the
owner of any added Leaf token needed to be stored in the sibling list
<code>__leaf_owner_tokens</code>.</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">)</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__line_index</span>
        <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">line_number</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_leaf</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__inline_token_index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__inline_token_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__inline_token_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">)</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__line_index</span>
        <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__inline_token_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">line_number</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__inline_token_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span><span class="p">]</span><span class="o">.</span><span class="n">is_code_block</span>
        <span class="ow">and</span> <span class="n">line</span>
        <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">" "</span>
    <span class="p">):</span>
        <span class="o">...</span>
</pre></div>
<p>With all the foundations set, I added debug and made some modifications
to the tracking code in the <code>next_line</code> function.  Tracking the Leaf elements
remained mostly the same, but the inclusion of the Hard Break token added a
slight bit of complexity.</p>
<div class="highlight"><pre><span></span>    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span><span class="p">]</span><span class="o">.</span><span class="n">is_code_block</span>
        <span class="ow">and</span> <span class="n">line</span>
        <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">" "</span>
    <span class="p">):</span>
        <span class="p">(</span>
            <span class="n">first_non_whitespace_index</span><span class="p">,</span>
            <span class="n">extracted_whitespace</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">ParserHelper</span><span class="o">.</span><span class="n">extract_whitespace_from_end</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">extracted_whitespace_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">extracted_whitespace</span><span class="p">)</span>

        <span class="n">is_list_empty_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__list_item_empty_lines_mode</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_owner_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span><span class="p">]</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_owner_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span><span class="p">]</span><span class="o">.</span><span class="n">is_list_start</span>
            <span class="ow">and</span> <span class="n">first_non_whitespace_index</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">extracted_whitespace_length</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__break_spaces</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__strict_mode</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_list_empty_line</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_next_line_error</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span>
                <span class="n">first_non_whitespace_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">extra_error_information</span><span class="o">=</span><span class="n">extra_error_information</span><span class="p">,)</span>
</pre></div>
<p>Finally, with the second algorithm modified, it was time to make
the required changes to the primary algorithm.  Instead of checking
the length of the line, the new conditional simply checked to see if
the last character on the line is a space character.  Once that character is detected,
except for some code to prevent it from triggering on Blank Lines within
a List element, the rest of the code is all about triggering the rule.</p>
<p>As always, I threw extra data and scenario tests against the code,
and it came up mostly clean.  I had missed a case with a completely
empty line, but I quickly fixed that.  After that, all tests were
showing as passing, and code coverage was at 100 percent.  I was good
to go for the next rule.  But would my luck continue?</p>
<h2 id="rule-md011-reverse-inline-links">Rule Md011 - Reverse Inline Links<a class="headerlink" href="#rule-md011-reverse-inline-links" title="Permanent link">¶</a></h2>
<p>The answer was yes!</p>
<h3 id="design_2">Design<a class="headerlink" href="#design_2" title="Permanent link">¶</a></h3>
<p>Looking at this rule, I was floored by my luck.  By some
miracle, all three of the final three rules needed the same
algorithms to provide a solid solution for them.  And… yes.
With this being a simpler version of the both of the last two
rules, I did skip over the design for this rule.</p>
<p>I was not 100% happy with that decision as I wanted to
stick by my design and implementation rules.  But I also like
to be efficient.  And as hard as I tried, I could not find a
good enough reason for spending the time on the design of
this rule that I knew was going to be a simpler clone of the
previous two rules.</p>
<h3 id="tests-and-implementation_1">Tests and Implementation<a class="headerlink" href="#tests-and-implementation_1" title="Permanent link">¶</a></h3>
<p>Because this rule was simpler, the number of test cases and the
number of scenario tests were drastically reduced.  It also helped
that there were no configuration values, reducing the complexity
of the design even further.</p>
<p>With everything else being cloned code from the first rule,
the only interesting part are the changes I made to detect
the reversed link syntax:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__reverse_link_syntax</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">"\(.*\)\[\s*[^\^].*\s*]"</span><span class="p">)</span>
        <span class="o">...</span>
</pre></div>
<p>A <a href="https://www.tutorialspoint.com/python/python_reg_expressions.htm">regular expression</a>
was easily the right way to go to detect the
reversed link syntax.  Once I had that decided, working through
what that expression would look like only took about ten minutes.
The hard part for me was that I wanted to peak at the original rule
and see how they matched the line and borrow some of their code.</p>
<p>But as I wanted to figure it out for myself, that was out of the
question.  So, I just lined up test data and an online
regular expression testing tool, and quickly narrowed down to that
expression.  It is not a fantastically complicated expression,
but it does the job!</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span>
    <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span><span class="p">]</span><span class="o">.</span><span class="n">is_code_block</span>
    <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__leaf_tokens</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__leaf_token_index</span><span class="p">]</span><span class="o">.</span><span class="n">is_html_block</span>
    <span class="ow">and</span> <span class="n">line</span>
    <span class="ow">and</span> <span class="s2">"("</span> <span class="ow">in</span> <span class="n">line</span>
    <span class="ow">and</span> <span class="s2">"["</span> <span class="ow">in</span> <span class="n">line</span>
<span class="p">):</span>
    <span class="n">regex_search</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__reverse_link_syntax</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">regex_search</span><span class="p">:</span>
        <span class="n">regex_span</span> <span class="o">=</span> <span class="n">regex_search</span><span class="o">.</span><span class="n">span</span><span class="p">()</span>
        <span class="n">extra_error_information</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">regex_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">regex_span</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">report_next_line_error</span><span class="p">(</span>
            <span class="n">context</span><span class="p">,</span>
            <span class="n">regex_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">extra_error_information</span><span class="o">=</span><span class="n">extra_error_information</span><span class="p">,)</span>
</pre></div>
<p>With the regular expression decided on, the rest of the code was
trivial to write.  The only interesting part was making sure that
I used the right regular expression function, one that would return
where the match occurred within the line.  But after a quick bit
of searching on my favorite Python websites, I got that answer and
wired everything up.</p>
<h2 id="ensuring-rule-details-and-rule-documentation-are-consistent">Ensuring Rule Details and Rule Documentation Are Consistent<a class="headerlink" href="#ensuring-rule-details-and-rule-documentation-are-consistent" title="Permanent link">¶</a></h2>
<p>With ten rules developed before June and thirty-one rules developed
after June, I was concerned that the details of each rule and the
documentation for each rule was not coordinated with each other. Given
that concern, I wanted to spend at least a good five or six hours going
through the rule modules and the rule documentation, making sure that
everything looked correct.</p>
<p>It was a bit of a slog, but it was worth it.  I took the opportunity to
run the document through a word processor and used that processor to
look for spelling mistakes and grammar mistakes.  I also pulled information
out of the <code>Reasoning</code> section to include a sub-heading that identifies
the primary reason for each rule.  From a readability point of view,
it just helped make that section crisper by clearly
stating what the reasoning for the rule was up front.</p>
<p>Even though I am usually thorough, there are trivial things that even I
mess up on.  For me, the best way to look for those is to go through
a set of objects that I am trying to standardize on and see what stands
out as being different.  Especially when I know that I often copied the
entire document from one rule and used it as a template for another rule,
I wanted to look for those differences that I missed.</p>
<p>What I found while doing this is as follows:</p>
<ul>
<li>There was 1 case where I forgot to change the title to match the new rule.</li>
<li>There were 2 cases where I used <code>{space}</code> in examples without adding some
  text before the example to explain that it was just standing in for space
  characters.</li>
<li>There were 2 cases where a plugin was enabled by default, but the documentation
  for that rule said it was disabled by default.</li>
<li>There were a small handful of cases where I still used “as such:” after I
  decided that it did not sound right.</li>
<li>There were a small handful of cases where I had forgotten to remove quotation
  marks from within string configuration values. (i.e. transforming
  <code>"consistent"</code> to <code>consistent</code>)</li>
<li>There were 20 cases where the rule modules did not have a module documentation
  header or class documentation header that matched the rule.</li>
<li>There were 22 cases where the rule details function did not have the
  <code>plugin_url</code> and <code>plugin_configuration</code> values set properly.</li>
</ul>
<p>Between knowing that the documentation was worded better and that it was also
consistent between the rules was a relief.  I know that some people might
consider this being picky, and I guess they are right.  For me, it is just
making sure that similar concepts in the same project have a solid attempt
at a singular theme running through them.  I do hope I have achieved that.</p>
<h2 id="what-was-my-experience-so-far">What Was My Experience So Far?<a class="headerlink" href="#what-was-my-experience-so-far" title="Permanent link">¶</a></h2>
<p>I have been working on this project for two years now, and it felt
good to have all the rules working.  There were some issues that I needed
to track down, but I was confident that those issues would only impact
documents that were off the beaten track.  Or it may be more proper to say
that I hoped that was the case.</p>
<p>Not including my week off for work and home related issues, I was able to
shave two weeks off of my ten weeks estimate to get the rules completed.
I was able to keep up steady progress, but each rule just took a decent
chunk of time to complete.  It was not that I did not try hard enough,
it was just that there was not enough time in the day.  While each design
portion was resolved within hours, the testing and documentation
took serious time to get right.  It just took what it took.</p>
<p>And now that I am so close to a beta release, I want to double check
and triple check things before I do this big release.  Lots of small
tasks before next week!</p>
<h2 id="what-is-next">What is Next?<a class="headerlink" href="#what-is-next" title="Permanent link">¶</a></h2>
<p>Having completed all the rules, I knew I needed to clean up a small handful
of things before a beta release.  It would not take more than a couple of days
to complete, but it would be time well invested.
Stay tuned!</p>


             
 
                <p id="post-share-links">
    Like this post? Share on:
    <a href="https://twitter.com/intent/tweet?text=Markdown%20Linter%20-%20Race%20To%20The%20Finish&url=https%3A//jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/&hashtags=markdown-linter,core-linter" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Markdown%20Linter%20-%20Race%20To%20The%20Finish&amp;body=https%3A//jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

            
            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message">So what do you think? Did I miss something? Is any part unclear? Leave your comments below. </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   href="https://jackdewinter.github.io/2021/09/20/markdown-linter-race-to-the-finish/#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">

                        <script src="https://utteranc.es/client.js"
        data-repo="jackdewinter/jackdewinter.github.io"
        data-issue-term="markdown-linter-beta-release-k"
        data-label="Comments"
        data-theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://jackdewinter.github.io/2021/09/13/markdown-linter-back-to-work/" title="Previous: Markdown Linter - Back To Work!">Markdown Linter - Back To Work!</a></li>
                <li class="next-article"><a href="https://jackdewinter.github.io/2021/09/27/markdown-linter-clearing-away-some-bugs/" title="Next: Markdown Linter - Clearing Away Some Bugs">Markdown Linter - Clearing Away Some Bugs</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
    <h4>Reading Time</h4>
    <p>~14 min read</p>
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2021-09-20T00:00:00-07:00">Sep 20, 2021</time>
        <h4>Markdown Linter Beta Release</h4>
    <ul class="multi-parts-list">
            <li >
            <a href="https://jackdewinter.github.io/2021/06/14/markdown-linter-getting-stuff-done/" title="Markdown Linter - Getting Stuff Done">Part 1: Markdown Linter - Getting Stuff Done</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/21/markdown-linter-elevating-extensions/" title="Markdown Linter - Elevating Extensions">Part 2: Markdown Linter - Elevating Extensions</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/06/28/markdown-linter-sometimes-you-have-to-go-backwards/" title="Markdown Linter - Sometimes You Have To Go Backwards...">Part 3: Markdown Linter - Sometimes You Have To Go Backwards...</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/07/12/markdown-linter-full-of-sound-and-fury/" title="Markdown Linter - Full Of Sound And Fury">Part 4: Markdown Linter - Full Of Sound And Fury</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/02/markdown-linter-making-progress-on-new-rules/" title="Markdown Linter - Making Progress On New Rules">Part 5: Markdown Linter - Making Progress On New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/07/26/markdown-linter-getting-back-to-new-rules/" title="Markdown Linter - Getting Back To New Rules">Part 6: Markdown Linter - Getting Back To New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/09/markdown-linter-continuing-progress-on-implementing-new-rules/" title="Markdown Linter - Continuing Progress On Implementing New Rules">Part 7: Markdown Linter - Continuing Progress On Implementing New Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/16/markdown-linter-dealing-with-rule-md027/" title="Markdown Linter - Dealing With Rule Md027">Part 8: Markdown Linter - Dealing With Rule Md027</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/23/markdown-linter-three-more-rules/" title="Markdown Linter - Three More Rules">Part 9: Markdown Linter - Three More Rules</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/08/30/markdown-linter-another-three-done/" title="Markdown Linter - Another Three Done!">Part 10: Markdown Linter - Another Three Done!</a>
            </li>
            <li >
            <a href="https://jackdewinter.github.io/2021/09/13/markdown-linter-back-to-work/" title="Markdown Linter - Back To Work!">Part 11: Markdown Linter - Back To Work!</a>
            </li>
            <li  class="active-part">
            Part 12: Markdown Linter - Race To The Finish
            </li>
    </ul>
            <h4>Category</h4>
            <a class="category-link" href="https://jackdewinter.github.io/categories#software-quality-ref">Software Quality</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://jackdewinter.github.io/tags#core-linter-ref">core linter
                    <span>86</span>
</a></li>
                <li><a href="https://jackdewinter.github.io/tags#markdown-linter-ref">markdown linter
                    <span>104</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/jackdewinter" title="github-alt" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/jackdewinter/" title="linkedin" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://jackdewinter.github.io/feeds/all.atom.xml" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        
&copy; Copyright 2021 by Jack De Winter and licensed under a <a rel="license"
  href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
  Creative Commons Attribution 4.0 International License</a>.

    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>